/*
 * Copyright (c) 2019 - 2023  Sambit Paul
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

package com.github.psambit9791.jdsp;

import com.github.psambit9791.jdsp.filter.adaptive.LMS;
import com.github.psambit9791.jdsp.misc.Plotting;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Order;
import org.junit.jupiter.api.Test;

import java.io.File;
import java.io.IOException;
import java.util.Arrays;

public class TestAdaptiveFilterLMS {
    // Random signal, with noise added
    private final double[] signal1 = {7.73615076e-01, -2.38644082e-01, -1.44153846e-02, -7.43728154e-02, 1.28832364e+00, -8.86944508e+00,  4.11744669e+00,  2.78178586e+00, -5.03828060e-01,  3.97897524e+00,  5.56136074e+00,  4.33681482e+00, 5.26247771e-01, -8.12778645e-01,  2.51919943e+00,  1.00856762e+00, 7.06685871e+00, -4.66127298e+00,  2.03547177e-01, -5.25186465e-01, -4.87098863e+00, -1.63898740e+00,  1.87870253e-01, -5.57965145e-01, -1.07066598e-01,  9.19816384e+00, -8.71136174e-01, -3.02327798e+00, -5.82031931e-02, -1.16211219e-01,  1.13151235e-01,  1.26114690e+00, 4.73462459e+00,  1.53611870e+00, -9.98205847e-01, -3.28775428e+00, 9.07053454e+00, -1.54833550e+00, -1.51008254e+00,  6.51624328e+00, -4.55701930e+00,  8.62041101e-01, -1.11631762e+00,  6.12632729e+00, 1.55095287e-01,  6.17289083e-01,  5.53387303e+00,  3.98012854e+00, -2.37425479e+00, -6.35874830e+00, -4.83330811e+00,  8.46856491e-01, -2.93207237e+00,  5.09877419e+00, -9.05449003e+00,  1.48636457e-01, -3.58520346e+00,  4.23115938e+00,  3.97121083e+00,  1.41538968e+00, -9.31974362e-01, -4.85514328e+00, -4.14552444e+00, -2.16680695e+00, 5.04741213e+00, -6.94276453e-02, -5.90503480e+00, -3.59451409e+00, 6.36499159e+00,  1.01308575e+01,  3.41732387e+00,  5.42015787e+00, 3.78165763e+00,  5.61407630e+00,  2.03656936e+00, -2.31467356e+00, 5.95036932e+00,  2.44526710e+00, -7.40024361e-01,  7.98213484e-02, -3.06403105e+00, -5.86909930e-01, -4.89830029e+00,  1.23679666e+01, 9.91312683e-02,  4.23599196e+00,  6.27245291e-01,  3.52968840e+00, 5.00869852e+00, -1.50513410e+00, -2.16011962e+00,  5.49917811e-01, -2.26659683e+00,  1.70725513e+00,  2.39727075e+00,  5.15351990e+00, 3.11771504e+00,  9.32193978e-01, -8.19075713e-02, -3.61008086e+00, -4.19740389e+00, -6.73014522e+00,  5.73541558e+00, -7.23020975e+00, -4.46432861e+00,  1.03575059e+01, -5.39284152e+00,  4.72954562e-02, 5.80744105e+00, -1.51942844e+00, -4.65530480e-01, -5.71813655e-01, 3.05234053e+00,  6.09075515e-01, -1.98037506e+00,  7.14506231e-01, 2.68107081e+00,  3.24380756e+00, -7.08060738e+00, -1.71634391e+00, 5.06864995e+00, -4.31711618e+00,  3.87541230e+00, -8.49148767e+00, 2.66471079e+00, -3.74045465e+00,  4.99362609e+00, -5.12173211e+00, -1.33151021e-01,  8.36393473e-01,  5.74386790e+00, -2.64544210e+00, 4.50639718e+00,  7.28226783e+00,  2.15130604e-01,  2.03331264e+00, -6.40605600e+00,  1.69201321e+00,  5.21920279e+00,  2.84600780e-01, 2.34699360e+00, -2.54902107e+00, -2.66004164e+00, -2.39064700e+00, -6.32328222e-01,  9.82091206e-01, -6.51881138e-02, -3.04311839e+00, -1.76498839e+00,  2.66959255e+00,  8.37398729e-01, -3.25932388e+00, 6.51018440e+00,  2.02981123e+00, -5.41678580e+00,  2.06063144e+00, -7.70799133e-01,  2.57805433e+00,  2.91215704e+00, -4.41207280e+00, -4.67975016e+00, -6.61825886e+00, -3.35400589e+00,  8.74674627e-03, 7.43617310e-01, -3.75279695e+00, -3.27974734e-01, -2.73018881e+00, -4.66419127e+00, -7.27015174e+00, -3.65824249e+00, -1.08689861e+01, -6.81145397e-01, -5.06373799e-01, -1.02286408e+00,  6.91061508e-01, -3.08047210e+00,  5.71097821e+00, -6.78346454e+00, -6.01614922e+00, -1.75321783e+00,  1.06042567e+00,  3.29761152e+00, -1.22316856e+01, 9.22934835e-01, -9.55571638e+00, -1.15720607e+00, -7.53973142e+00, 1.53614251e+00,  3.27826037e-01, -3.75613319e+00,  1.74610563e+00, 5.68450799e+00, -1.25439441e+00,  6.34719872e+00, -8.76148347e-02, -9.36224947e-01,  2.82739862e-01,  1.32286366e+00,  1.32513382e+00, 2.93519406e+00, -8.29501002e-02, -9.35219340e-01,  9.52288323e-01, 2.25459000e+00,  3.03397928e+00, -1.50991261e+00,  1.89007422e+00, 2.81578034e-01, -3.45521704e+00, -2.38102363e+00, -2.49901416e+00, 8.25811154e+00,  3.08093564e+00, -1.17275450e+00,  2.29109765e+00, 9.66588605e-01, -7.29614680e+00, -3.89862770e+00, -1.63177776e+00, 2.21062239e+00, -5.62142151e+00,  3.28703998e+00,  8.52994288e+00, -1.24469719e+01, -4.36683316e+00, -2.72106177e-02,  4.62359183e+00, 7.24635389e+00, -1.62475247e+00, -7.66715584e+00,  1.30017340e+00, -5.62427464e+00,  1.30661338e+00,  1.05783786e+00,  3.16697154e-01, -5.08342315e-01,  4.91503104e+00,  7.68950904e-01, -8.37960473e+00, -1.40923254e+00, -2.63983294e-01,  4.57667095e+00, -7.61954565e+00, -5.15705438e-01,  2.68324181e+00,  1.53501494e-01,  1.06547807e+00, -2.52481266e+00,  4.02400818e+00,  2.94278906e+00, -2.59587851e+00, 4.76356947e+00,  3.18790104e+00, -5.30617141e-01,  3.22259577e+00, 6.98506914e+00,  5.26638339e+00, -2.96500709e+00, -4.51119140e-01, 1.49355598e+00,  8.66748031e-01,  2.41373830e+00, -1.27962877e+01, -1.69749663e+00, -6.38403922e-01, -2.69025479e-02,  4.02110331e+00, -1.47302099e-01,  4.71460676e+00, -3.71553041e+00,  2.86150123e+00, 4.76119809e+00, -1.19943660e+01,  3.95721120e-01, -8.92553787e+00, -1.97728620e+00,  3.46256920e+00, -7.96185817e+00, -5.68217283e+00, 5.32929913e+00, -1.87257201e+00,  3.82966038e+00,  2.07931439e+00, -5.10278129e+00, -9.75036532e+00,  2.11412442e+00,  1.79136112e+00, 2.08851082e-01, -7.22878268e+00, -4.17436136e+00, -4.63950203e+00, -8.54334383e-01, -5.79718349e+00,  3.86479334e+00,  4.83305034e+00, -4.27911860e+00,  3.54769021e+00, -5.44921171e+00,  8.32057892e+00, -8.00431086e+00, -6.32228896e+00,  7.09907312e-01,  2.33025030e+00, 6.08993453e+00, -6.83040530e+00, -1.64226208e+00, -5.39967380e+00, 3.61227919e+00,  3.59240732e+00,  2.67544663e+00, -2.19368188e+00, 2.49938777e+00,  2.88113362e+00, -3.30686145e+00,  2.53345663e+00, 8.49847765e+00,  6.50954944e+00,  1.73708642e+00,  3.76887276e+00, -3.83969940e+00, -3.99288424e+00, -2.08440684e+00, -6.48882011e+00, -1.17096160e+00, -4.28469410e+00, -6.77145223e-01, -1.71511444e+00, 2.89530722e+00, -2.03556739e+00,  8.01652216e-01, -6.86940911e+00, -1.15869813e+00,  2.26229442e+00,  1.73180528e+00, -3.82690821e+00, -1.30215436e+00,  6.71157000e+00, -5.18619591e+00,  6.10730721e+00, 4.17824364e+00, -5.47350768e-01, -1.95091027e+00,  3.37065184e+00, -1.64087067e+00, -7.07230886e-01,  2.19743101e+00, -2.85092372e+00, 9.61000649e-02, -3.21997942e+00,  5.58314893e+00, -4.74336051e+00, 4.62330740e+00,  1.86626490e-01,  1.37941538e+01, -5.78476826e+00, -5.42956074e-01, -6.20485273e+00, -3.11219820e-01,  4.72771884e-01, -3.00272519e+00,  1.35757357e+01,  3.23723082e+00,  3.52392645e-01, 2.84983460e+00,  5.90285504e+00,  2.78295199e-01, -3.71991593e+00, 4.90393786e-01, -3.23339756e+00,  5.94712326e+00, -3.55754521e+00, 8.96638762e+00,  8.20815729e+00,  3.75698735e+00, -1.63676800e+00, -2.03287800e+00,  6.06536972e+00, -6.24905516e+00,  3.01720879e-02, 4.21378914e+00,  1.38184734e+00,  3.46479778e+00, -1.84767676e+00, -1.03990843e+01, -2.59162399e+00, -1.01643907e-01, -1.91403216e+00, 1.26809915e+00,  2.55410086e+00,  8.14394841e+00, -6.79178072e-02, 5.70672935e+00, -1.04381832e+01,  4.10828311e+00, -1.98631240e+00, 8.05464356e-01,  6.35907464e+00, -2.41284350e+00,  3.54715687e+00, 4.45992563e+00, -8.13578331e+00, -3.49508545e+00, -1.26504169e+00, -3.15447360e+00,  2.40131439e+00,  9.79161803e-01, -3.21828895e+00, 2.15796242e+00, -2.22399922e-02,  3.53969040e-01,  7.00018680e+00, -3.53066462e+00, -4.20977579e-01, -3.23784048e+00,  6.33446347e+00, -2.53304544e-01,  4.36525926e+00, -4.43411558e+00, -1.03541057e+01, 1.00582018e+00,  7.53986173e-01,  9.42740127e+00,  4.23075216e+00, -1.11933540e+00, -6.88447986e+00, -2.22444661e+00, -6.25773066e+00, 6.65462151e-01, -9.94164109e-01, -8.53134292e+00, -3.82421963e+00, 5.47933113e+00,  5.49597131e+00, -1.24903615e+00, -6.18754151e+00, 8.61059760e+00,  4.27719935e+00, -1.65472577e+00, -6.24315843e+00, 7.58833751e+00, -3.19055650e+00, -2.81457455e+00,  1.36777231e-01, 5.74597881e+00,  6.71414287e+00,  9.17304318e+00,  1.59196057e+00, 7.69328546e-01,  2.09118998e+00, -3.38710016e+00,  5.67221909e+00, 5.25098029e+00,  4.19042906e+00,  9.96586250e+00, -5.02617965e+00, -2.05694038e+00,  2.94181580e+00,  3.45276366e-01,  1.00680553e+00, 4.88756801e+00, -2.30546149e+00,  4.76144421e-02,  5.80800680e-01, 4.95026817e+00,  4.53184576e-01, -1.02612348e+00, -3.19471138e+00, -3.08277622e+00, -3.62541739e+00, -1.74932307e-01,  5.64901079e+00, 7.07411639e+00, -1.39018554e+00,  2.46724818e+00, -1.14596684e-01, -2.83008440e-01, -7.08167407e+00, -5.74811827e+00,  1.05915151e+00, 3.27010644e+00,  1.50217680e+00, -5.65604533e-01, -2.86155375e+00, -4.86212742e+00, -1.36804370e-01,  1.19991714e+00,  1.53118287e+00, -1.76843226e+00, -1.98751632e+00, -6.07251008e-02,  2.53082947e+00, -5.37658128e+00,  1.39249309e+00,  4.27613842e+00, -1.35429911e+00, -3.03972901e+00, -8.25716860e+00,  1.85549231e+00,  6.73101071e+00};
    // Random signal, without noise
    private final double[] desired1 = {6.20322971e-01, -4.09841098e-01, -9.80187866e-03, -1.70210263e-01, 1.28024248e+00, -8.93983098e+00,  4.04036826e+00,  2.73370133e+00, -4.33469505e-01,  4.07188976e+00,  5.59847799e+00,  4.23783257e+00, 5.90610898e-01, -7.43888978e-01,  2.54666415e+00,  9.48205572e-01, 7.13774466e+00, -4.61899113e+00, -1.08138482e-01, -4.60741262e-01, -5.06236290e+00, -1.57263124e+00,  1.72463013e-01, -4.38603977e-01, -1.16882719e-01,  9.10950241e+00, -8.85871541e-01, -2.91729735e+00, -5.55785313e-02, -1.27644735e-01,  1.87506586e-01,  1.28218283e+00, 4.73403185e+00,  1.67272470e+00, -8.42694444e-01, -3.22642166e+00, 9.04193863e+00, -1.39864440e+00, -1.39177059e+00,  6.58813300e+00, -4.67862696e+00,  8.76108291e-01, -1.19068484e+00,  6.11042607e+00, 1.79100980e-01,  6.27305024e-01,  5.48635552e+00,  4.10742392e+00, -2.54386792e+00, -6.28572995e+00, -5.01905644e+00,  8.85116304e-01, -3.02076280e+00,  5.18660457e+00, -9.04584478e+00,  1.73407095e-01, -3.68703140e+00,  4.16570237e+00,  3.99193257e+00,  1.47374667e+00, -6.39064738e-01, -4.83285745e+00, -4.04792069e+00, -2.32250034e+00, 4.91442294e+00, -1.04977123e-01, -6.02477757e+00, -3.44587416e+00, 6.32396972e+00,  1.02690757e+01,  3.56600212e+00,  5.42443584e+00, 3.83183761e+00,  5.60846635e+00,  2.09041306e+00, -2.26633937e+00, 5.93800436e+00,  2.49576410e+00, -5.67654734e-01,  1.51122971e-01, -3.03145109e+00, -5.74432978e-01, -4.99956761e+00,  1.22652369e+01, 1.31466921e-01,  4.09905285e+00,  5.50612531e-01,  3.65783953e+00, 5.20012149e+00, -1.67172970e+00, -1.99745466e+00,  5.28773982e-01, -2.26809734e+00,  1.69591397e+00,  2.50532516e+00,  4.99275225e+00, 3.16333140e+00,  8.37706959e-01, -2.48287184e-02, -3.45580122e+00, -4.19744562e+00, -6.69272971e+00,  5.77637076e+00, -7.31016910e+00, -4.31316467e+00,  1.05281527e+01, -5.32266318e+00,  5.46239994e-02, 5.76125167e+00, -1.58207746e+00, -2.94446822e-01, -4.30372151e-01, 3.04597438e+00,  4.51082462e-01, -2.26357625e+00,  6.06163565e-01, 2.66800877e+00,  3.38387646e+00, -7.14577300e+00, -1.66586237e+00, 5.19896805e+00, -4.30426255e+00,  3.86116751e+00, -8.62236402e+00, 2.54446326e+00, -3.69884469e+00,  4.97353534e+00, -5.10947898e+00, -1.37878793e-01,  9.02807877e-01,  5.66539916e+00, -2.67900017e+00, 4.69601540e+00,  7.20228922e+00,  1.86973061e-01,  1.97437397e+00, -6.36157787e+00,  1.79425245e+00,  5.16938162e+00,  2.41459346e-01, 2.31909544e+00, -2.49603769e+00, -2.73398117e+00, -2.42824300e+00, -8.69547609e-01,  8.43916705e-01, -7.64324894e-02, -2.95333197e+00, -1.73548082e+00,  2.55971571e+00,  6.97373108e-01, -3.24185587e+00, 6.34490404e+00,  2.13640391e+00, -5.41039618e+00,  1.89989943e+00, -8.67394519e-01,  2.50562320e+00,  2.83483779e+00, -4.56106610e+00, -4.76721641e+00, -6.68669902e+00, -3.42513446e+00,  1.21542409e-01, 7.54100091e-01, -3.85212268e+00, -3.61436895e-01, -2.81814452e+00, -4.69419194e+00, -7.18260082e+00, -3.63301542e+00, -1.06404260e+01, -6.43552654e-01, -5.97733250e-01, -9.41890005e-01,  7.99054630e-01, -2.97105540e+00,  5.60155411e+00, -6.79822829e+00, -5.90296803e+00, -1.92169072e+00,  1.01048399e+00,  3.15491775e+00, -1.23249426e+01, 8.21689120e-01, -9.43065940e+00, -1.18065987e+00, -7.62606697e+00, 1.43258193e+00,  3.41992754e-01, -3.75724675e+00,  1.88051307e+00, 5.73450966e+00, -1.39757419e+00,  6.28430065e+00,  1.93924165e-02, -9.98333216e-01,  4.56197080e-01,  1.21303472e+00,  1.38239515e+00, 2.84907250e+00, -1.33909614e-01, -8.25361175e-01,  9.39581607e-01, 2.33593522e+00,  3.08130834e+00, -1.43452604e+00,  1.80125539e+00, 2.59420594e-01, -3.41279177e+00, -2.46593092e+00, -2.33606415e+00, 8.18038873e+00,  3.05093528e+00, -1.27341041e+00,  2.07676684e+00, 1.14628046e+00, -7.31658070e+00, -3.94341918e+00, -1.65164926e+00, 2.35260878e+00, -5.71793217e+00,  3.35499677e+00,  8.48756405e+00, -1.25066389e+01, -4.31012734e+00,  7.16134396e-02,  4.57220153e+00, 7.16946897e+00, -1.74166204e+00, -7.55680546e+00,  1.24264780e+00, -5.80918771e+00,  1.44760859e+00,  9.20851910e-01,  3.94643207e-01, -4.89999450e-01,  4.94382258e+00,  7.10513376e-01, -8.34304559e+00, -1.57601053e+00, -2.05179519e-01,  4.73237195e+00, -7.53114293e+00, -7.17659446e-01,  2.58482091e+00,  1.34722002e-01,  1.11417180e+00, -2.53547793e+00,  3.97468674e+00,  3.00231909e+00, -2.47946333e+00, 4.74034007e+00,  3.26079402e+00, -7.88522215e-01,  3.12884483e+00, 6.95294325e+00,  5.21752677e+00, -2.93172727e+00, -3.49744085e-01, 1.54422289e+00,  8.04525484e-01,  2.26146149e+00, -1.27405913e+01, -1.88131431e+00, -5.73100193e-01, -4.57474561e-02,  3.90351981e+00, -1.18576368e-01,  4.71431915e+00, -3.71919014e+00,  2.85307890e+00, 4.80315050e+00, -1.19019226e+01,  4.45382640e-01, -8.82432455e+00, -1.98170017e+00,  3.62441513e+00, -7.90474719e+00, -5.73654223e+00, 5.21990963e+00, -1.85199232e+00,  3.69900823e+00,  1.98197679e+00, -5.07887258e+00, -9.81115406e+00,  2.02079279e+00,  1.78791361e+00, 2.16118872e-01, -7.24936608e+00, -4.21211606e+00, -4.55403775e+00, -8.20091648e-01, -5.81952610e+00,  4.11122554e+00,  4.85243351e+00, -4.16591809e+00,  3.49159211e+00, -5.58550581e+00,  8.24140327e+00, -8.03111184e+00, -6.37194978e+00,  8.43545930e-01,  2.31824619e+00, 6.13608142e+00, -6.83505342e+00, -1.68561751e+00, -5.39587420e+00, 3.78368434e+00,  3.51561246e+00,  2.75214568e+00, -2.29628260e+00, 2.45342513e+00,  2.88149194e+00, -3.27422394e+00,  2.68176949e+00, 8.49346939e+00,  6.42518788e+00,  1.80209062e+00,  3.73245577e+00, -3.81583124e+00, -4.00450649e+00, -2.27875252e+00, -6.43799020e+00, -1.11262480e+00, -4.19203362e+00, -4.97098946e-01, -1.83462482e+00, 2.94695796e+00, -1.99463789e+00,  7.59744017e-01, -6.82969849e+00, -1.10873344e+00,  2.14042603e+00,  1.75642756e+00, -3.91870664e+00, -1.36734001e+00,  6.53409552e+00, -5.23353200e+00,  6.08695015e+00, 4.23322932e+00, -5.47260775e-01, -2.10513908e+00,  3.45686665e+00, -1.65272933e+00, -6.58393827e-01,  2.29402463e+00, -2.70866324e+00, 2.92222764e-01, -3.22720329e+00,  5.61426137e+00, -4.85119662e+00, 4.72946742e+00,  6.81377454e-02,  1.36136286e+01, -5.70172966e+00, -5.95125726e-01, -6.12709200e+00, -2.70412355e-01,  3.09771619e-01, -3.27469313e+00,  1.34660755e+01,  3.23887997e+00,  2.30215012e-01, 2.78455846e+00,  5.75696096e+00,  2.95282995e-01, -3.71083334e+00, 4.42254523e-01, -3.09369103e+00,  6.09689476e+00, -3.50101849e+00, 8.78641050e+00,  8.09768828e+00,  3.79770038e+00, -1.69962376e+00, -2.08158714e+00,  6.15526646e+00, -6.19796768e+00,  1.61587531e-01, 4.17086821e+00,  1.51936988e+00,  3.40938465e+00, -1.69772761e+00, -1.03885009e+01, -2.67767496e+00, -2.64765858e-01, -1.94417939e+00, 1.24247588e+00,  2.63986706e+00,  8.13288936e+00, -1.11161005e-01, 5.81443310e+00, -1.04606658e+01,  4.05065893e+00, -1.92885151e+00, 7.56481535e-01,  6.42495485e+00, -2.47253521e+00,  3.52486095e+00, 4.47514333e+00, -8.17319595e+00, -3.49643060e+00, -1.18349449e+00, -3.11341342e+00,  2.44941138e+00,  9.15618759e-01, -3.13300598e+00, 2.22491866e+00,  7.82019270e-02,  2.81332457e-01,  6.98294094e+00, -3.46731123e+00, -4.81859091e-01, -3.26045272e+00,  6.52704405e+00, -5.81284424e-02,  4.48925332e+00, -4.34025706e+00, -1.04560308e+01, 1.05707641e+00,  7.18074513e-01,  9.32154408e+00,  4.17985157e+00, -1.10776889e+00, -6.93921542e+00, -2.27952655e+00, -6.17852651e+00, 6.79872800e-01, -9.70818301e-01, -8.52015568e+00, -3.89178994e+00, 5.34227394e+00,  5.52702778e+00, -1.29973981e+00, -6.38861974e+00, 8.57134087e+00,  4.16797756e+00, -1.58486075e+00, -6.19099590e+00, 7.63802682e+00, -3.25706066e+00, -2.74141940e+00,  1.68742209e-01, 5.70499335e+00,  6.66880913e+00,  9.26231400e+00,  1.54460016e+00, 7.99694193e-01,  2.19458568e+00, -3.19616589e+00,  5.83860640e+00, 5.34106257e+00,  4.03983792e+00,  9.89695766e+00, -5.08098837e+00, -1.89162539e+00,  2.87188401e+00,  3.83893003e-01,  1.01689223e+00, 4.79405529e+00, -2.26727908e+00,  8.74440507e-02,  4.55223192e-01, 5.07255592e+00,  2.44533574e-01, -1.08519920e+00, -3.09751435e+00, -3.20210200e+00, -3.59039080e+00, -3.04568346e-01,  5.63970837e+00, 6.84273908e+00, -1.47444271e+00,  2.31295604e+00, -1.54773058e-01, -3.24531580e-01, -7.14904049e+00, -5.66832695e+00,  9.70463546e-01, 3.33354510e+00,  1.66510437e+00, -5.51698118e-01, -2.94732077e+00, -4.98706127e+00, -2.07782880e-01,  1.27038141e+00,  1.54674194e+00, -1.67475274e+00, -1.91048324e+00, -4.66440356e-02,  2.57817830e+00, -5.19105666e+00,  1.53405872e+00,  4.24586382e+00, -1.25533117e+00, -2.98114393e+00, -8.14352980e+00,  1.92265397e+00,  6.63359396e+00};

    // Sine wave, with noise added
    private final double[] signal2 = {5.376671e-02,2.336831e-01,-1.254228e-01,2.365922e-01,2.317837e-01,1.181647e-01,2.539706e-01,3.792360e-01,7.495837e-01,7.144667e-01,3.472058e-01,8.291379e-01,6.403065e-01,6.021440e-01,7.190672e-01,6.646005e-01,7.084528e-01,9.037825e-01,9.277511e-01,9.586103e-01,9.120164e-01,7.499552e-01,9.660611e-01,1.078730e+00,9.836480e-01,1.054914e+00,1.038411e+00,9.472111e-01,1.016301e+00,9.150466e-01,1.086960e+00,8.852324e-01,8.923404e-01,9.150365e-01,6.957958e-01,1.125794e+00,1.003721e+00,8.824967e-01,1.079382e+00,7.531785e-01,8.937440e-01,8.571736e-01,8.883583e-01,8.606750e-01,7.137533e-01,7.660629e-01,7.194602e-01,7.637361e-01,7.735349e-01,7.366975e-01,4.993828e-01,5.519793e-01,3.799494e-01,3.458597e-01,4.112163e-01,5.188131e-01,2.413071e-01,3.073296e-01,1.988674e-01,2.838351e-01,1.343109e-02,7.552166e-02,7.726409e-02,8.176216e-02,7.588372e-02,-1.199842e-01,-3.274507e-01,-3.017849e-01,-3.824001e-01,-8.918407e-02,-4.329572e-01,-3.428165e-01,-4.820362e-01,-4.179320e-01,-6.259939e-01,-7.310609e-01,-7.729012e-01,-6.200775e-01,-7.231746e-01,-7.597970e-01,-6.311418e-01,-7.748387e-01,-8.131053e-01,-7.008977e-01,-9.647194e-01,-8.369773e-01,-8.432031e-01,-9.688099e-01,-9.382074e-01,-1.089265e+00,-1.097921e+00,-9.805945e-01,-9.243042e-01,-7.409058e-01,-1.066539e+00,-9.789821e-01,-1.001304e+00,-1.179183e+00,-1.020107e+00,-1.143538e+00,-8.654521e-01,-1.021309e+00,-9.031520e-01,-9.459586e-01,-8.372414e-01,-9.015180e-01,-7.642507e-01,-7.090143e-01,-5.794835e-01,-7.359063e-01,-8.943375e-01,-7.267465e-01,-4.679868e-01,-6.697930e-01,-4.241893e-01,-4.642701e-01,-2.881892e-01,-5.820396e-01,-3.588332e-01,-4.121035e-01,4.796362e-02,-1.112189e-01,-6.256733e-03,-2.000203e-01,-9.087366e-02,-2.095751e-02,1.664175e-01,7.893027e-02,2.267439e-01,8.840814e-04,2.196351e-01,2.209703e-01,1.931643e-01,4.483205e-01,4.713683e-01,4.910429e-01,3.976178e-01,6.856815e-01,6.484467e-01,6.224659e-01,6.919541e-01,6.990125e-01,5.839021e-01,7.621485e-01,7.373659e-01,7.502941e-01,7.581397e-01,8.437777e-01,7.179525e-01,1.033398e+00,1.005368e+00,9.653328e-01,9.753838e-01,9.080924e-01,1.096324e+00,9.851643e-01,9.285359e-01,1.134099e+00,9.729266e-01,9.304245e-01,9.513716e-01,8.848914e-01,8.441539e-01,1.192829e+00,1.087462e+00,9.320146e-01,7.526171e-01,7.666269e-01,8.082056e-01,8.755955e-01,6.318324e-01,4.986886e-01,5.515561e-01,6.928447e-01,6.599874e-01,6.258069e-01,5.259278e-01,5.142782e-01,4.039919e-01,4.923642e-01,2.235193e-01,3.578080e-01,1.792599e-01,1.817994e-01,2.211788e-01,2.200020e-01,-4.577237e-02,1.417889e-01,3.142910e-02,-9.159248e-02,-1.543341e-01,-2.062374e-01,-2.639855e-01,-2.799766e-01,-3.250440e-01,-2.946230e-01,-2.706330e-01,-4.216691e-01,-5.331763e-01,-4.922338e-01,-5.775739e-01,-7.385088e-01,-5.786367e-01,-6.791747e-01,-7.308886e-01,-7.255224e-01,-7.815805e-01,-9.304994e-01,-8.790973e-01,-9.017977e-01,-9.624765e-01,-7.608466e-01,-1.034060e+00,-1.009903e+00,-1.045322e+00,-1.101678e+00,-1.011124e+00,-1.024440e+00,-8.466355e-01,-1.024624e+00,-1.103692e+00,-8.319492e-01,-8.613398e-01,-9.977905e-01,-1.112996e+00,-9.919600e-01,-9.458098e-01,-8.829729e-01,-9.147552e-01,-8.201066e-01,-7.988812e-01,-9.346391e-01,-8.738187e-01,-8.206128e-01,-7.628740e-01,-7.079375e-01,-6.367100e-01,-9.013368e-01,-6.030680e-01,-3.906584e-01,-5.778068e-01,-3.328048e-01,-3.451077e-01,-3.360404e-01,-2.670513e-01,-3.932368e-01,-1.960206e-01,2.246730e-02,-7.810413e-02,-3.359053e-02,-6.083829e-02,5.977192e-02,1.362036e-01,2.054373e-01,1.749352e-01,2.374511e-01,5.116852e-01,1.309173e-01,6.262309e-01,4.825556e-01,5.931821e-01,3.698882e-01,5.190723e-01,5.905773e-01,6.993980e-01,5.271857e-01,7.766915e-01,6.417191e-01,8.011673e-01,8.893172e-01,8.842351e-01,9.850846e-01,1.000502e+00,8.555983e-01,9.648593e-01,8.608034e-01,8.367319e-01,1.072611e+00,9.888693e-01,9.896058e-01,1.089925e+00,1.059457e+00,1.033674e+00,1.119807e+00,1.081370e+00,1.003476e+00,8.990918e-01,8.891508e-01,1.057279e+00,7.582741e-01,8.960720e-01,6.804202e-01,9.519259e-01,9.084678e-01,7.927511e-01,7.538836e-01,4.787452e-01,7.500561e-01,4.355092e-01,3.839812e-01,5.835002e-01,4.387997e-01,5.315870e-01,5.136845e-01,4.861799e-01,2.846972e-01,3.512618e-01,2.681229e-01,2.917489e-01,2.133106e-01,1.996326e-01,4.652068e-02,-5.286073e-03,5.990714e-02,-3.034366e-01,-1.915000e-01,-3.177141e-01,-2.780439e-01,-2.234413e-01,-2.535305e-01,-4.845409e-01,-4.761273e-01,-4.602057e-01,-5.467829e-01,-5.297929e-01,-5.609425e-01,-7.333716e-01,-6.958774e-01,-9.275061e-01,-6.340548e-01,-8.438995e-01,-9.317982e-01,-8.651766e-01,-1.008890e+00,-8.921624e-01,-9.679415e-01,-7.135874e-01,-8.346516e-01,-1.212919e+00,-9.313915e-01,-1.125163e+00,-1.018185e+00,-9.810574e-01,-9.250177e-01,-1.026858e+00,-8.391564e-01,-1.039590e+00,-9.509449e-01,-9.069329e-01,-9.521337e-01,-8.573721e-01,-8.955677e-01,-9.863767e-01,-1.066274e+00,-6.754105e-01,-8.950758e-01,-7.955271e-01,-7.187470e-01,-7.309428e-01,-7.981351e-01,-7.180027e-01,-6.455900e-01,-4.454724e-01,-6.382152e-01,-4.310347e-01,-4.347174e-01,-4.438655e-01,-4.800123e-01,-3.556171e-01,-2.879319e-01,-3.775554e-01,-1.621669e-01,-2.139246e-01,-9.109616e-02,2.179143e-03,-7.159810e-02,4.030341e-02,1.542221e-01,-1.458509e-02,3.219557e-01,5.096087e-01,4.112310e-01,3.310440e-01,4.518959e-01,3.508123e-01,6.864242e-01,6.356729e-01,6.619310e-01,5.357267e-01,6.938492e-01,6.428896e-01,7.026724e-01,7.100532e-01,6.957782e-01,7.367536e-01,8.338202e-01,7.099416e-01,9.633792e-01,9.113458e-01,1.011212e+00,9.840477e-01,1.019876e+00,8.330441e-01,8.877543e-01,9.510005e-01,1.010065e+00,1.112843e+00,9.693119e-01,1.120275e+00,1.034959e+00,1.095625e+00,9.792283e-01,8.867262e-01,7.877314e-01,9.325149e-01,9.775949e-01,8.429874e-01,7.924662e-01,7.878367e-01,6.791252e-01,7.075708e-01,7.049692e-01,6.919686e-01,6.436076e-01,6.720757e-01,5.812838e-01,7.097197e-01,5.161495e-01,6.207980e-01,3.223234e-01,4.005782e-01,2.743058e-01,3.119923e-01,2.623805e-01,-6.511911e-02,-2.911415e-02,-9.066629e-02,4.332918e-02,9.986656e-02,-1.300139e-01,-6.603280e-02,-1.422709e-01,-3.510498e-01,-2.545792e-01,-4.172096e-01,-2.372220e-01,-4.379497e-01,-3.158372e-01,-5.654736e-01,-5.062312e-01,-6.122300e-01,-8.473893e-01,-7.810161e-01,-6.574330e-01,-7.582349e-01,-8.967762e-01,-8.777110e-01,-8.182284e-01,-9.684549e-01,-7.954308e-01,-9.785096e-01,-7.527505e-01,-1.058458e+00,-9.449820e-01,-1.128991e+00,-1.058765e+00,-1.052745e+00,-9.577891e-01,-9.056865e-01,-9.692975e-01,-1.033570e+00,-9.091091e-01,-9.026569e-01,-9.599257e-01,-9.017619e-01,-9.021205e-01,-1.024222e+00,-8.293517e-01,-9.485200e-01,-9.184487e-01,-8.134472e-01,-8.328735e-01,-7.842562e-01,-6.785378e-01,-5.985214e-01,-6.863518e-01,-5.954522e-01,-6.121241e-01,-5.239192e-01,-4.600798e-01,-5.216909e-01,-3.872811e-01,-3.083652e-01,-3.120225e-01,-1.002340e-01,-2.853472e-01,-2.489024e-01,-3.004460e-01,1.564619e-02,6.155301e-02,1.716596e-02,1.652497e-01,1.438284e-01,2.042755e-01,2.357859e-01,3.172134e-01,3.314196e-01,6.472089e-01,2.980983e-01,2.745744e-01,3.900114e-01,4.375445e-01,5.449330e-01,6.113730e-01,6.447026e-01,7.573381e-01,7.770002e-01,8.461971e-01,9.799488e-01,9.534481e-01,7.297312e-01,6.499045e-01,9.955016e-01,7.419618e-01,9.500758e-01,9.624346e-01,1.194663e+00,9.756242e-01,9.399257e-01,1.019844e+00,1.023927e+00,1.006904e+00,9.370647e-01,8.711603e-01,1.018052e+00,8.426010e-01,8.616825e-01,1.083593e+00,8.917464e-01,9.004064e-01,9.829081e-01,8.391419e-01,9.461167e-01,7.805665e-01,8.861832e-01,8.156797e-01,6.973826e-01,5.962332e-01,5.408826e-01,5.789440e-01,5.213604e-01,4.821003e-01,5.777917e-01,4.049234e-01,5.032166e-01,2.888581e-01,3.915824e-01,1.936615e-01,2.144827e-01,2.443389e-01,5.593529e-02,3.326518e-03,1.971943e-01,4.166428e-02,-1.467905e-01,-8.858898e-02,-2.389951e-01,-1.813896e-01,-1.587460e-01,-5.083751e-01,-2.917502e-01,-2.945518e-01,-4.802000e-01,-3.536925e-01,-5.548132e-01,-7.346541e-01,-8.693354e-01,-7.207252e-01,-6.516889e-01,-7.251310e-01,-7.474235e-01,-8.764094e-01,-8.321447e-01,-1.036113e+00,-9.717487e-01,-9.988453e-01,-8.838984e-01,-9.538238e-01,-1.082087e+00,-9.791654e-01,-1.056397e+00,-1.060790e+00,-9.118932e-01,-9.886272e-01,-9.592627e-01,-9.073030e-01,-9.717549e-01,-9.262707e-01,-9.021513e-01,-8.400220e-01,-8.937094e-01,-7.819023e-01,-9.003583e-01,-8.846149e-01,-6.846764e-01,-8.785993e-01,-7.986370e-01,-6.750675e-01,-7.188345e-01,-5.582257e-01,-5.584421e-01,-5.941571e-01,-6.609663e-01,-4.849329e-01,-6.368998e-01,-4.299633e-01,-3.281898e-01,-3.413170e-01,-2.273232e-01,-6.327499e-02,-1.259648e-01,-1.423091e-01,-5.504966e-02,-2.658051e-02,-1.503397e-01,-1.019893e-02,2.041409e-01,1.273369e-01,2.396275e-01,1.299659e-01,2.857146e-01,3.872322e-01,2.381635e-01,4.552388e-01,4.473954e-01,4.155480e-01,5.483803e-01,4.037378e-01,4.203033e-01,5.535389e-01,6.086093e-01,6.249993e-01,6.025209e-01,8.346859e-01,6.752044e-01,8.722917e-01,9.644436e-01,9.077394e-01,9.371999e-01,9.076517e-01,8.123850e-01,9.690244e-01,1.079779e+00,1.165321e+00,9.537658e-01,8.368215e-01,1.016426e+00,1.035124e+00,9.699846e-01,8.704577e-01,1.177957e+00,7.272778e-01,8.975009e-01,7.992027e-01,8.482622e-01,9.218618e-01,8.798302e-01,7.687086e-01,8.891135e-01,8.432299e-01,8.133290e-01,6.717335e-01,7.830524e-01,7.064461e-01,8.518129e-01,6.663208e-01,6.332887e-01,4.792061e-01,3.001818e-01,3.459244e-01,2.603241e-01,2.319123e-01,2.952992e-01,1.349768e-01,5.153002e-02,5.013825e-02,2.478152e-02,3.149937e-02,-1.549781e-01,-7.811196e-02,-1.518929e-01,-7.670339e-02,-2.793766e-01,-3.197719e-01,-4.709487e-01,-5.389329e-01,-4.149359e-01,-5.153868e-01,-4.832734e-01,-6.647730e-01,-4.250580e-01,-6.425296e-01,-5.872355e-01,-7.500657e-01,-7.772175e-01,-7.236297e-01,-7.667205e-01,-9.619016e-01,-1.028574e+00,-1.008305e+00,-1.061034e+00,-9.321118e-01,-9.954312e-01,-1.004929e+00,-1.115596e+00,-9.104346e-01,-9.508406e-01,-1.007616e+00,-8.978808e-01,-1.086210e+00,-9.536276e-01,-9.540202e-01,-9.452025e-01,-1.041836e+00,-9.225571e-01,-9.906418e-01,-1.010334e+00,-1.020221e+00,-7.730397e-01,-9.361236e-01,-8.413730e-01,-9.154135e-01,-7.927165e-01,-1.052732e+00,-8.029017e-01,-7.997700e-01,-7.198288e-01,-5.994025e-01,-5.688394e-01,-2.987363e-01,-5.059765e-01,-4.282896e-01,-5.136842e-01,-3.570543e-01,-3.948942e-01,-2.091862e-01,-7.748984e-02,-7.254352e-02,-1.329153e-01,-1.756329e-01,1.837292e-01,2.929432e-01,1.499774e-01,8.857649e-02,3.565084e-01,2.260309e-01,2.861589e-01,4.687775e-01,2.876556e-01,2.754613e-01,5.569717e-01,5.974404e-01,6.079333e-01,6.876253e-01,7.841040e-01,8.091371e-01,6.896452e-01,8.600198e-01,8.268959e-01,7.875163e-01,7.451182e-01,9.533360e-01,8.752174e-01,9.348592e-01,8.682025e-01,8.073291e-01,9.919865e-01,9.785938e-01,1.112198e+00,1.077441e+00,1.105052e+00,9.247551e-01,9.034008e-01,8.649918e-01,1.034055e+00,1.253030e+00,1.034279e+00,8.691806e-01,1.012720e+00,7.964423e-01,7.447453e-01,9.346078e-01,7.585603e-01,8.393197e-01,9.177005e-01,7.845185e-01,8.028469e-01,5.129787e-01,7.016857e-01,8.097468e-01,6.088668e-01,3.581172e-01,4.480463e-01,3.733341e-01,4.155317e-01,3.713766e-01,3.228304e-01,1.972966e-01,1.245496e-01,7.585308e-02,1.701600e-01,-1.507156e-01,-3.645336e-02,-3.895367e-02,-1.813700e-01,-1.181778e-01,-2.224201e-01,-3.579610e-01,-2.961687e-01,-3.865070e-01,-4.471493e-01,-5.227395e-01,-4.897648e-01,-7.235691e-01,-6.204723e-01,-6.752068e-01,-7.506834e-01,-6.311960e-01,-8.051025e-01,-7.109695e-01,-6.988698e-01,-8.415460e-01,-8.253938e-01,-8.143772e-01,-9.093588e-01,-8.678249e-01,-1.066486e+00,-8.451244e-01,-1.068640e+00,-1.163631e+00,-8.508775e-01,-1.001676e+00,-9.540684e-01,-1.036315e+00,-1.100544e+00,-1.301755e+00,-9.252808e-01,-1.007529e+00,-9.870698e-01,-9.128011e-01,-1.078910e+00,-9.911606e-01,-7.824006e-01,-8.139934e-01,-9.763428e-01,-1.040829e+00,-8.478383e-01,-7.375236e-01,-6.309743e-01,-6.802925e-01,-7.646037e-01,-5.828130e-01,-6.901657e-01,-6.270823e-01,-5.530684e-01,-5.661092e-01,-4.246196e-01,-4.408651e-01,-3.318976e-01,-3.012622e-01,-2.470442e-01,-2.069437e-01,1.661225e-02,4.455473e-03,-3.822178e-04,-1.026826e-01,-6.837809e-02,-5.232131e-02,4.542603e-01,3.400747e-01,3.170171e-01,2.416393e-01,2.713131e-01,4.866228e-01,6.331834e-01,3.509503e-01,5.176377e-01,5.950170e-01,4.435879e-01,7.646266e-01,6.750280e-01,9.418904e-01,7.438608e-01,8.541654e-01,7.272425e-01,8.051071e-01,7.746334e-01,9.524189e-01,1.062690e+00,8.901255e-01,1.007708e+00,9.257746e-01,9.960912e-01,1.112680e+00,1.009743e+00,8.961661e-01,9.137446e-01,9.795422e-01,9.719151e-01,8.965442e-01,9.907475e-01,1.086427e+00,9.193215e-01,9.062549e-01,6.864876e-01,8.068215e-01,7.203403e-01,7.942630e-01,8.565558e-01,9.253997e-01,9.200411e-01,6.937486e-01,6.368773e-01,7.124152e-01,6.398500e-01,6.260341e-01,5.846209e-01,3.147638e-01,4.716606e-01,3.622431e-01,2.482046e-01,2.068823e-01,3.557005e-01,9.731791e-02,4.895460e-03,1.000061e-01,2.293760e-01,-1.945594e-02,-4.143597e-02,-2.161622e-01,-4.677888e-03,-2.089270e-01,-2.171816e-01,-4.134805e-01,-2.801458e-01,-3.729867e-01,-5.728099e-01,-4.973871e-01,-5.893032e-01,-5.748233e-01,-6.508255e-01,-6.831985e-01,-8.042567e-01,-7.682773e-01,-6.924153e-01,-6.257740e-01,-9.454411e-01,-6.186964e-01,-7.287105e-01,-8.871175e-01,-9.544508e-01,-1.012218e+00,-8.747125e-01,-1.040662e+00,-1.028144e+00,-9.018625e-01,-9.523919e-01,-9.095528e-01,-9.494662e-01,-1.038210e+00,-1.045160e+00,-9.072773e-01,-1.044674e+00,-8.470561e-01,-8.723743e-01,-9.059865e-01,-9.153842e-01,-8.577755e-01,-5.180361e-01,-8.561104e-01,-9.725504e-01,-5.953375e-01,-6.938281e-01,-7.856584e-01,-4.233636e-01,-5.924978e-01,-5.790292e-01,-6.455505e-01,-6.321386e-01,-6.590359e-01,-4.798150e-01,-4.970543e-01,-2.801980e-01,-3.290927e-01,-7.203440e-02,-4.884895e-02,-1.339738e-01,-1.287382e-01,6.492201e-02,-1.146508e-01};
    // Sine wave, without noise
    private final double[] desired2 = {0,5.029457e-02,1.004618e-01,1.503748e-01,1.999072e-01,2.489336e-01,2.973298e-01,3.449735e-01,3.917441e-01,4.375230e-01,4.821945e-01,5.256456e-01,5.677661e-01,6.084495e-01,6.475929e-01,6.850971e-01,7.208672e-01,7.548127e-01,7.868477e-01,8.168910e-01,8.448667e-01,8.707039e-01,8.943372e-01,9.157068e-01,9.347587e-01,9.514445e-01,9.657220e-01,9.775552e-01,9.869141e-01,9.937749e-01,9.981204e-01,9.999394e-01,9.992275e-01,9.959864e-01,9.902243e-01,9.819557e-01,9.712018e-01,9.579895e-01,9.423525e-01,9.243302e-01,9.039683e-01,8.813183e-01,8.564376e-01,8.293891e-01,8.002413e-01,7.690680e-01,7.359481e-01,7.009653e-01,6.642084e-01,6.257702e-01,5.857481e-01,5.442434e-01,5.013611e-01,4.572098e-01,4.119012e-01,3.655501e-01,3.182737e-01,2.701917e-01,2.214258e-01,1.720995e-01,1.223375e-01,7.226591e-02,2.201138e-02,-2.829886e-02,-7.853747e-02,-1.285773e-01,-1.782917e-01,-2.275548e-01,-2.762419e-01,-3.242298e-01,-3.713970e-01,-4.176242e-01,-4.627943e-01,-5.067930e-01,-5.495090e-01,-5.908340e-01,-6.306636e-01,-6.688969e-01,-7.054371e-01,-7.401917e-01,-7.730728e-01,-8.039971e-01,-8.328864e-01,-8.596676e-01,-8.842728e-01,-9.066398e-01,-9.267119e-01,-9.444384e-01,-9.597744e-01,-9.726811e-01,-9.831257e-01,-9.910819e-01,-9.965296e-01,-9.994549e-01,-9.998504e-01,-9.977152e-01,-9.930546e-01,-9.858804e-01,-9.762109e-01,-9.640703e-01,-9.494896e-01,-9.325056e-01,-9.131613e-01,-8.915057e-01,-8.675935e-01,-8.414853e-01,-8.132472e-01,-7.829506e-01,-7.506723e-01,-7.164939e-01,-6.805020e-01,-6.427876e-01,-6.034462e-01,-5.625775e-01,-5.202847e-01,-4.766750e-01,-4.318589e-01,-3.859496e-01,-3.390634e-01,-2.913190e-01,-2.428372e-01,-1.937408e-01,-1.441539e-01,-9.420224e-02,-4.401210e-02,6.289433e-03,5.657505e-02,1.067175e-01,1.565898e-01,2.060657e-01,2.550201e-01,3.033289e-01,3.508701e-01,3.975231e-01,4.431699e-01,4.876949e-01,5.309856e-01,5.729323e-01,6.134287e-01,6.523725e-01,6.896651e-01,7.252120e-01,7.589233e-01,7.907136e-01,8.205026e-01,8.482147e-01,8.737799e-01,8.971334e-01,9.182161e-01,9.369747e-01,9.533617e-01,9.673355e-01,9.788610e-01,9.879087e-01,9.944560e-01,9.984861e-01,9.999889e-01,9.989606e-01,9.954037e-01,9.893274e-01,9.807469e-01,9.696840e-01,9.561667e-01,9.402292e-01,9.219119e-01,9.012610e-01,8.783290e-01,8.531737e-01,8.258590e-01,7.964539e-01,7.650328e-01,7.316753e-01,6.964659e-01,6.594936e-01,6.208520e-01,5.806389e-01,5.389562e-01,4.959093e-01,4.516072e-01,4.061620e-01,3.596887e-01,3.123050e-01,2.641309e-01,2.152881e-01,1.659005e-01,1.160929e-01,6.599149e-02,1.572304e-02,-3.458521e-02,-8.480592e-02,-1.348120e-01,-1.844768e-01,-2.336747e-01,-2.822811e-01,-3.301731e-01,-3.772293e-01,-4.233307e-01,-4.683605e-01,-5.122049e-01,-5.547529e-01,-5.958966e-01,-6.355321e-01,-6.735589e-01,-7.098809e-01,-7.444060e-01,-7.770470e-01,-8.077211e-01,-8.363508e-01,-8.628636e-01,-8.871923e-01,-9.092754e-01,-9.290570e-01,-9.464870e-01,-9.615213e-01,-9.741219e-01,-9.842568e-01,-9.919004e-01,-9.970334e-01,-9.996428e-01,-9.997219e-01,-9.972705e-01,-9.922950e-01,-9.848078e-01,-9.748278e-01,-9.623805e-01,-9.474972e-01,-9.302157e-01,-9.105797e-01,-8.886389e-01,-8.644488e-01,-8.380706e-01,-8.095712e-01,-7.790226e-01,-7.465022e-01,-7.120923e-01,-6.758800e-01,-6.379569e-01,-5.984191e-01,-5.573666e-01,-5.149033e-01,-4.711367e-01,-4.261776e-01,-3.801398e-01,-3.331398e-01,-2.852966e-01,-2.367312e-01,-1.875667e-01,-1.379273e-01,-8.793891e-02,-3.772789e-02,1.257862e-02,6.285329e-02,1.129689e-01,1.627985e-01,2.122161e-01,2.610965e-01,3.093161e-01,3.567527e-01,4.032863e-01,4.487992e-01,4.931761e-01,5.363046e-01,5.780758e-01,6.183837e-01,6.571264e-01,6.942058e-01,7.295281e-01,7.630038e-01,7.945483e-01,8.240817e-01,8.515291e-01,8.768213e-01,8.998941e-01,9.206891e-01,9.391537e-01,9.552412e-01,9.689108e-01,9.801280e-01,9.888643e-01,9.950976e-01,9.988123e-01,9.999988e-01,9.986541e-01,9.947817e-01,9.883914e-01,9.794993e-01,9.681280e-01,9.543061e-01,9.380688e-01,9.194571e-01,8.985182e-01,8.753049e-01,8.498761e-01,8.222962e-01,7.926349e-01,7.609673e-01,7.273736e-01,6.919389e-01,6.547527e-01,6.159093e-01,5.755069e-01,5.336478e-01,4.904379e-01,4.459867e-01,4.004067e-01,3.538131e-01,3.063240e-01,2.580596e-01,2.091419e-01,1.596949e-01,1.098437e-01,5.971446e-02,9.434072e-03,-4.087020e-02,-9.107102e-02,-1.410413e-01,-1.906546e-01,-2.397854e-01,-2.883092e-01,-3.361032e-01,-3.830466e-01,-4.290204e-01,-4.739082e-01,-5.175966e-01,-5.599748e-01,-6.009356e-01,-6.403754e-01,-6.781943e-01,-7.142966e-01,-7.485909e-01,-7.809905e-01,-8.114132e-01,-8.397821e-01,-8.660254e-01,-8.900767e-01,-9.118750e-01,-9.313653e-01,-9.484981e-01,-9.632302e-01,-9.755242e-01,-9.853490e-01,-9.926797e-01,-9.974978e-01,-9.997911e-01,-9.995538e-01,-9.967864e-01,-9.914961e-01,-9.836961e-01,-9.734063e-01,-9.606526e-01,-9.454674e-01,-9.278890e-01,-9.079621e-01,-8.857369e-01,-8.612698e-01,-8.346227e-01,-8.058631e-01,-7.750637e-01,-7.423025e-01,-7.076625e-01,-6.712312e-01,-6.331010e-01,-5.933683e-01,-5.521336e-01,-5.095015e-01,-4.655797e-01,-4.204795e-01,-3.743150e-01,-3.272030e-01,-2.792629e-01,-2.306159e-01,-1.813851e-01,-1.316953e-01,-8.167210e-02,-3.144219e-02,1.886730e-02,6.912904e-02,1.192158e-01,1.690008e-01,2.183581e-01,2.671626e-01,3.152909e-01,3.626212e-01,4.090336e-01,4.544107e-01,4.986377e-01,5.416025e-01,5.831964e-01,6.233142e-01,6.618542e-01,6.987191e-01,7.338153e-01,7.670542e-01,7.983515e-01,8.276281e-01,8.548099e-01,8.798280e-01,9.026191e-01,9.231256e-01,9.412955e-01,9.570829e-01,9.704477e-01,9.813562e-01,9.897807e-01,9.957000e-01,9.990990e-01,9.999691e-01,9.983082e-01,9.941204e-01,9.874163e-01,9.782129e-01,9.665336e-01,9.524078e-01,9.358713e-01,9.169660e-01,8.957397e-01,8.722462e-01,8.465449e-01,8.187009e-01,7.887846e-01,7.568718e-01,7.230432e-01,6.873845e-01,6.499859e-01,6.109421e-01,5.703520e-01,5.283182e-01,4.849471e-01,4.403486e-01,3.946355e-01,3.479235e-01,3.003309e-01,2.519781e-01,2.029875e-01,1.534831e-01,1.035902e-01,5.343507e-02,3.144732e-03,-4.715357e-02,-9.733252e-02,-1.472651e-01,-1.968249e-01,-2.458866e-01,-2.943259e-01,-3.420201e-01,-3.888487e-01,-4.346931e-01,-4.794372e-01,-5.229677e-01,-5.651746e-01,-6.059509e-01,-6.451934e-01,-6.828029e-01,-7.186841e-01,-7.527462e-01,-7.849030e-01,-8.150731e-01,-8.431802e-01,-8.691530e-01,-8.929259e-01,-9.144386e-01,-9.336368e-01,-9.504718e-01,-9.649010e-01,-9.768879e-01,-9.864021e-01,-9.934197e-01,-9.979227e-01,-9.998999e-01,-9.993461e-01,-9.962629e-01,-9.906580e-01,-9.825456e-01,-9.719462e-01,-9.588867e-01,-9.434001e-01,-9.255256e-01,-9.053085e-01,-8.827999e-01,-8.580568e-01,-8.311419e-01,-8.021232e-01,-7.710742e-01,-7.380735e-01,-7.032047e-01,-6.665559e-01,-6.282200e-01,-5.882940e-01,-5.468789e-01,-5.040796e-01,-4.600043e-01,-4.147648e-01,-3.684754e-01,-3.212533e-01,-2.732182e-01,-2.244914e-01,-1.751964e-01,-1.254580e-01,-7.540206e-02,-2.515525e-02,2.515525e-02,7.540206e-02,1.254580e-01,1.751964e-01,2.244914e-01,2.732182e-01,3.212533e-01,3.684754e-01,4.147648e-01,4.600043e-01,5.040796e-01,5.468789e-01,5.882940e-01,6.282200e-01,6.665559e-01,7.032047e-01,7.380735e-01,7.710742e-01,8.021232e-01,8.311419e-01,8.580568e-01,8.827999e-01,9.053085e-01,9.255256e-01,9.434001e-01,9.588867e-01,9.719462e-01,9.825456e-01,9.906580e-01,9.962629e-01,9.993461e-01,9.998999e-01,9.979227e-01,9.934197e-01,9.864021e-01,9.768879e-01,9.649010e-01,9.504718e-01,9.336368e-01,9.144386e-01,8.929259e-01,8.691530e-01,8.431802e-01,8.150731e-01,7.849030e-01,7.527462e-01,7.186841e-01,6.828029e-01,6.451934e-01,6.059509e-01,5.651746e-01,5.229677e-01,4.794372e-01,4.346931e-01,3.888487e-01,3.420201e-01,2.943259e-01,2.458866e-01,1.968249e-01,1.472651e-01,9.733252e-02,4.715357e-02,-3.144732e-03,-5.343507e-02,-1.035902e-01,-1.534831e-01,-2.029875e-01,-2.519781e-01,-3.003309e-01,-3.479235e-01,-3.946355e-01,-4.403486e-01,-4.849471e-01,-5.283182e-01,-5.703520e-01,-6.109421e-01,-6.499859e-01,-6.873845e-01,-7.230432e-01,-7.568718e-01,-7.887846e-01,-8.187009e-01,-8.465449e-01,-8.722462e-01,-8.957397e-01,-9.169660e-01,-9.358713e-01,-9.524078e-01,-9.665336e-01,-9.782129e-01,-9.874163e-01,-9.941204e-01,-9.983082e-01,-9.999691e-01,-9.990990e-01,-9.957000e-01,-9.897807e-01,-9.813562e-01,-9.704477e-01,-9.570829e-01,-9.412955e-01,-9.231256e-01,-9.026191e-01,-8.798280e-01,-8.548099e-01,-8.276281e-01,-7.983515e-01,-7.670542e-01,-7.338153e-01,-6.987191e-01,-6.618542e-01,-6.233142e-01,-5.831964e-01,-5.416025e-01,-4.986377e-01,-4.544107e-01,-4.090336e-01,-3.626212e-01,-3.152909e-01,-2.671626e-01,-2.183581e-01,-1.690008e-01,-1.192158e-01,-6.912904e-02,-1.886730e-02,3.144219e-02,8.167210e-02,1.316953e-01,1.813851e-01,2.306159e-01,2.792629e-01,3.272030e-01,3.743150e-01,4.204795e-01,4.655797e-01,5.095015e-01,5.521336e-01,5.933683e-01,6.331010e-01,6.712312e-01,7.076625e-01,7.423025e-01,7.750637e-01,8.058631e-01,8.346227e-01,8.612698e-01,8.857369e-01,9.079621e-01,9.278890e-01,9.454674e-01,9.606526e-01,9.734063e-01,9.836961e-01,9.914961e-01,9.967864e-01,9.995538e-01,9.997911e-01,9.974978e-01,9.926797e-01,9.853490e-01,9.755242e-01,9.632302e-01,9.484981e-01,9.313653e-01,9.118750e-01,8.900767e-01,8.660254e-01,8.397821e-01,8.114132e-01,7.809905e-01,7.485909e-01,7.142966e-01,6.781943e-01,6.403754e-01,6.009356e-01,5.599748e-01,5.175966e-01,4.739082e-01,4.290204e-01,3.830466e-01,3.361032e-01,2.883092e-01,2.397854e-01,1.906546e-01,1.410413e-01,9.107102e-02,4.087020e-02,-9.434072e-03,-5.971446e-02,-1.098437e-01,-1.596949e-01,-2.091419e-01,-2.580596e-01,-3.063240e-01,-3.538131e-01,-4.004067e-01,-4.459867e-01,-4.904379e-01,-5.336478e-01,-5.755069e-01,-6.159093e-01,-6.547527e-01,-6.919389e-01,-7.273736e-01,-7.609673e-01,-7.926349e-01,-8.222962e-01,-8.498761e-01,-8.753049e-01,-8.985182e-01,-9.194571e-01,-9.380688e-01,-9.543061e-01,-9.681280e-01,-9.794993e-01,-9.883914e-01,-9.947817e-01,-9.986541e-01,-9.999988e-01,-9.988123e-01,-9.950976e-01,-9.888643e-01,-9.801280e-01,-9.689108e-01,-9.552412e-01,-9.391537e-01,-9.206891e-01,-8.998941e-01,-8.768213e-01,-8.515291e-01,-8.240817e-01,-7.945483e-01,-7.630038e-01,-7.295281e-01,-6.942058e-01,-6.571264e-01,-6.183837e-01,-5.780758e-01,-5.363046e-01,-4.931761e-01,-4.487992e-01,-4.032863e-01,-3.567527e-01,-3.093161e-01,-2.610965e-01,-2.122161e-01,-1.627985e-01,-1.129689e-01,-6.285329e-02,-1.257862e-02,3.772789e-02,8.793891e-02,1.379273e-01,1.875667e-01,2.367312e-01,2.852966e-01,3.331398e-01,3.801398e-01,4.261776e-01,4.711367e-01,5.149033e-01,5.573666e-01,5.984191e-01,6.379569e-01,6.758800e-01,7.120923e-01,7.465022e-01,7.790226e-01,8.095712e-01,8.380706e-01,8.644488e-01,8.886389e-01,9.105797e-01,9.302157e-01,9.474972e-01,9.623805e-01,9.748278e-01,9.848078e-01,9.922950e-01,9.972705e-01,9.997219e-01,9.996428e-01,9.970334e-01,9.919004e-01,9.842568e-01,9.741219e-01,9.615213e-01,9.464870e-01,9.290570e-01,9.092754e-01,8.871923e-01,8.628636e-01,8.363508e-01,8.077211e-01,7.770470e-01,7.444060e-01,7.098809e-01,6.735589e-01,6.355321e-01,5.958966e-01,5.547529e-01,5.122049e-01,4.683605e-01,4.233307e-01,3.772293e-01,3.301731e-01,2.822811e-01,2.336747e-01,1.844768e-01,1.348120e-01,8.480592e-02,3.458521e-02,-1.572304e-02,-6.599149e-02,-1.160929e-01,-1.659005e-01,-2.152881e-01,-2.641309e-01,-3.123050e-01,-3.596887e-01,-4.061620e-01,-4.516072e-01,-4.959093e-01,-5.389562e-01,-5.806389e-01,-6.208520e-01,-6.594936e-01,-6.964659e-01,-7.316753e-01,-7.650328e-01,-7.964539e-01,-8.258590e-01,-8.531737e-01,-8.783290e-01,-9.012610e-01,-9.219119e-01,-9.402292e-01,-9.561667e-01,-9.696840e-01,-9.807469e-01,-9.893274e-01,-9.954037e-01,-9.989606e-01,-9.999889e-01,-9.984861e-01,-9.944560e-01,-9.879087e-01,-9.788610e-01,-9.673355e-01,-9.533617e-01,-9.369747e-01,-9.182161e-01,-8.971334e-01,-8.737799e-01,-8.482147e-01,-8.205026e-01,-7.907136e-01,-7.589233e-01,-7.252120e-01,-6.896651e-01,-6.523725e-01,-6.134287e-01,-5.729323e-01,-5.309856e-01,-4.876949e-01,-4.431699e-01,-3.975231e-01,-3.508701e-01,-3.033289e-01,-2.550201e-01,-2.060657e-01,-1.565898e-01,-1.067175e-01,-5.657505e-02,-6.289433e-03,4.401210e-02,9.420224e-02,1.441539e-01,1.937408e-01,2.428372e-01,2.913190e-01,3.390634e-01,3.859496e-01,4.318589e-01,4.766750e-01,5.202847e-01,5.625775e-01,6.034462e-01,6.427876e-01,6.805020e-01,7.164939e-01,7.506723e-01,7.829506e-01,8.132472e-01,8.414853e-01,8.675935e-01,8.915057e-01,9.131613e-01,9.325056e-01,9.494896e-01,9.640703e-01,9.762109e-01,9.858804e-01,9.930546e-01,9.977152e-01,9.998504e-01,9.994549e-01,9.965296e-01,9.910819e-01,9.831257e-01,9.726811e-01,9.597744e-01,9.444384e-01,9.267119e-01,9.066398e-01,8.842728e-01,8.596676e-01,8.328864e-01,8.039971e-01,7.730728e-01,7.401917e-01,7.054371e-01,6.688969e-01,6.306636e-01,5.908340e-01,5.495090e-01,5.067930e-01,4.627943e-01,4.176242e-01,3.713970e-01,3.242298e-01,2.762419e-01,2.275548e-01,1.782917e-01,1.285773e-01,7.853747e-02,2.829886e-02,-2.201138e-02,-7.226591e-02,-1.223375e-01,-1.720995e-01,-2.214258e-01,-2.701917e-01,-3.182737e-01,-3.655501e-01,-4.119012e-01,-4.572098e-01,-5.013611e-01,-5.442434e-01,-5.857481e-01,-6.257702e-01,-6.642084e-01,-7.009653e-01,-7.359481e-01,-7.690680e-01,-8.002413e-01,-8.293891e-01,-8.564376e-01,-8.813183e-01,-9.039683e-01,-9.243302e-01,-9.423525e-01,-9.579895e-01,-9.712018e-01,-9.819557e-01,-9.902243e-01,-9.959864e-01,-9.992275e-01,-9.999394e-01,-9.981204e-01,-9.937749e-01,-9.869141e-01,-9.775552e-01,-9.657220e-01,-9.514445e-01,-9.347587e-01,-9.157068e-01,-8.943372e-01,-8.707039e-01,-8.448667e-01,-8.168910e-01,-7.868477e-01,-7.548127e-01,-7.208672e-01,-6.850971e-01,-6.475929e-01,-6.084495e-01,-5.677661e-01,-5.256456e-01,-4.821945e-01,-4.375230e-01,-3.917441e-01,-3.449735e-01,-2.973298e-01,-2.489336e-01,-1.999072e-01,-1.503748e-01,-1.004618e-01,-5.029457e-02,-1.959435e-15};

    @Test
    @Order(1)
    public void createTestOutputDirectory() {
        String dirName = "./test_outputs/";
        File directory = new File(dirName);
        if (! directory.exists()){
            directory.mkdir();
        }
    }

    @Test
    public void LMSTest1() throws IOException {
        double mu = 0.01;
        int length = 4;
        String outputFileName = "test_outputs/LMSTest1.png";
        double[] weights = new double[length];
        Arrays.fill(weights, 0);

        // Results calculated with MATLAB R2020b Update 4 9.9.0.1570001
        double[] result = {0,-1.145232e-03,6.712909e-04,-3.650061e-04,8.144133e-03,-2.028834e-01,4.325592e+00,1.778990e+00,-9.738189e-01,2.914863e+00,4.625670e+00,3.774985e+00,6.412048e-01,-6.397910e-01,2.429660e+00,1.019273e+00,6.529764e+00,-4.328155e+00,1.587326e-01,-2.815395e-01,-4.844148e+00,-1.699221e+00,2.591101e-01,-5.985983e-01,-1.260872e-01,9.177906e+00,-7.674177e-01,-3.154319e+00,4.355714e-03,-1.311670e-01,1.086853e-01,1.240918e+00,4.663283e+00,1.525591e+00,-9.462387e-01,-3.244675e+00,8.930580e+00,-1.540933e+00,-1.477584e+00,6.423151e+00,-4.532109e+00,9.200771e-01,-1.070549e+00,6.182345e+00,1.870438e-01,7.091196e-01,5.664298e+00,4.008660e+00,-2.278300e+00,-6.430990e+00,-4.782385e+00,7.559431e-01,-2.935406e+00,5.163126e+00,-9.197744e+00,4.336167e-02,-3.666259e+00,4.284342e+00,3.952950e+00,1.439054e+00,-8.668607e-01,-4.771498e+00,-4.198757e+00,-2.255156e+00,4.866447e+00,-1.353871e-01,-5.848125e+00,-3.586798e+00,6.360068e+00,9.981677e+00,3.670659e+00,5.571982e+00,3.792485e+00,5.644697e+00,2.018416e+00,-2.440631e+00,6.078266e+00,2.592004e+00,-8.059353e-01,6.534365e-02,-3.070237e+00,-6.320791e-01,-4.929533e+00,1.236907e+01,2.710380e-01,4.334764e+00,8.538658e-01,3.385546e+00,4.843392e+00,-1.522997e+00,-2.223522e+00,5.909964e-01,-2.296611e+00,1.735444e+00,2.386663e+00,5.174195e+00,3.066875e+00,9.399236e-01,-7.489683e-02,-3.586128e+00,-4.137464e+00,-6.685145e+00,5.724723e+00,-7.304592e+00,-4.493758e+00,1.032715e+01,-5.826842e+00,-2.589634e-01,5.296977e+00,-1.554903e+00,-6.080229e-01,-5.207317e-01,3.073736e+00,6.062250e-01,-2.029511e+00,7.851389e-01,2.748394e+00,3.239532e+00,-7.226533e+00,-1.748024e+00,5.199150e+00,-4.446816e+00,3.836414e+00,-8.494255e+00,2.758450e+00,-3.645686e+00,4.983067e+00,-5.086956e+00,-2.241735e-01,8.342661e-01,5.818811e+00,-2.621320e+00,4.506850e+00,7.418929e+00,1.940240e-01,2.109284e+00,-6.457664e+00,1.744726e+00,5.119568e+00,2.158258e-01,2.329769e+00,-2.564036e+00,-2.608931e+00,-2.349517e+00,-6.181682e-01,9.467888e-01,-8.981105e-02,-3.029749e+00,-1.754641e+00,2.620752e+00,7.929375e-01,-3.216500e+00,6.501563e+00,1.997790e+00,-5.292272e+00,2.058339e+00,-6.911451e-01,2.555441e+00,2.921588e+00,-4.292377e+00,-4.701032e+00,-6.651084e+00,-3.425018e+00,-9.289794e-03,8.305904e-01,-3.749247e+00,-3.609430e-01,-2.716159e+00,-4.725702e+00,-7.339693e+00,-3.589032e+00,-1.080018e+01,-5.031004e-01,-3.676587e-01,-1.141766e+00,6.674021e-01,-3.019621e+00,5.580451e+00,-6.632674e+00,-5.854177e+00,-1.911994e+00,1.056410e+00,3.314172e+00,-1.207525e+01,1.050706e+00,-9.788493e+00,-1.605408e+00,-7.089798e+00,2.006714e+00,1.801533e-01,-3.844383e+00,1.625898e+00,5.749705e+00,-1.106993e+00,6.522239e+00,9.486398e-02,-9.607353e-01,3.417258e-01,1.328772e+00,1.318143e+00,2.949487e+00,-4.044447e-02,-9.278939e-01,9.944934e-01,2.251732e+00,3.024768e+00,-1.475238e+00,1.902920e+00,3.490702e-01,-3.462969e+00,-2.383715e+00,-2.508427e+00,8.165602e+00,3.129634e+00,-1.241960e+00,2.331049e+00,9.499026e-01,-7.239117e+00,-3.952925e+00,-1.491317e+00,2.251354e+00,-5.515696e+00,3.263587e+00,8.673782e+00,-1.237981e+01,-4.253246e+00,5.892398e-02,4.769566e+00,7.151571e+00,-1.694669e+00,-7.626578e+00,1.566971e+00,-5.659824e+00,1.262127e+00,9.278518e-01,4.140943e-01,-5.031820e-01,4.953299e+00,7.588297e-01,-8.330037e+00,-1.433181e+00,-4.676378e-01,4.753747e+00,-7.644284e+00,-5.987649e-01,2.657587e+00,3.481217e-01,1.067625e+00,-2.513933e+00,3.988478e+00,2.993604e+00,-2.540067e+00,4.702692e+00,3.242296e+00,-4.529561e-01,3.218345e+00,7.015370e+00,5.223388e+00,-3.030772e+00,-4.927134e-01,1.548966e+00,8.277164e-01,2.389188e+00,-1.261059e+01,-1.706569e+00,-5.618049e-01,-1.673632e-01,4.063490e+00,-5.650956e-02,4.688687e+00,-3.637568e+00,2.791329e+00,4.819106e+00,-1.199113e+01,1.610317e-01,-9.074054e+00,-1.920657e+00,3.551533e+00,-7.946825e+00,-5.567321e+00,5.525448e+00,-1.732386e+00,3.602129e+00,2.120435e+00,-4.912747e+00,-9.536617e+00,1.963228e+00,1.896941e+00,2.052092e-01,-7.253759e+00,-4.262683e+00,-4.718667e+00,-8.463998e-01,-5.740694e+00,3.851897e+00,4.860384e+00,-4.382090e+00,3.512529e+00,-5.570636e+00,8.453345e+00,-7.831959e+00,-6.078014e+00,7.676617e-01,2.508614e+00,6.060554e+00,-6.921532e+00,-1.784823e+00,-5.336305e+00,3.530468e+00,3.684109e+00,2.702318e+00,-2.252155e+00,2.564465e+00,2.875714e+00,-3.361014e+00,2.571348e+00,8.564147e+00,6.537697e+00,1.642932e+00,3.877917e+00,-3.972948e+00,-3.899810e+00,-2.130113e+00,-6.516929e+00,-1.135153e+00,-4.308537e+00,-5.446871e-01,-1.685854e+00,2.961681e+00,-2.033165e+00,8.597567e-01,-6.875942e+00,-1.111646e+00,2.184022e+00,1.820729e+00,-3.738894e+00,-1.295022e+00,6.635752e+00,-5.071652e+00,6.210003e+00,4.053425e+00,-5.921485e-01,-1.946577e+00,3.326141e+00,-1.596484e+00,-7.554612e-01,2.206324e+00,-2.852366e+00,5.660861e-02,-3.216249e+00,5.602577e+00,-4.742271e+00,4.695036e+00,1.170649e-01,1.396398e+01,-5.675921e+00,-6.189313e-01,-5.797253e+00,-2.714261e-04,4.114583e-01,-2.819026e+00,1.353096e+01,3.177567e+00,5.798262e-01,2.950829e+00,5.772202e+00,1.563067e-01,-3.863812e+00,4.421726e-01,-3.067972e+00,5.787052e+00,-3.501322e+00,8.859495e+00,8.152652e+00,3.490813e+00,-1.744665e+00,-2.197986e+00,5.929739e+00,-6.219281e+00,-1.908718e-02,4.086836e+00,1.423120e+00,3.572098e+00,-1.855752e+00,-1.041930e+01,-2.728980e+00,-2.127616e-01,-1.976158e+00,1.250741e+00,2.531691e+00,8.184168e+00,2.377821e-02,5.740594e+00,-1.045580e+01,4.224126e+00,-1.947085e+00,7.611733e-01,6.334082e+00,-2.319410e+00,3.537261e+00,4.554735e+00,-8.119148e+00,-3.512682e+00,-1.230155e+00,-3.200015e+00,2.417188e+00,1.000108e+00,-3.237766e+00,2.152887e+00,-2.807013e-02,3.395274e-01,6.982720e+00,-3.555731e+00,-4.762564e-01,-3.179971e+00,6.322914e+00,-2.601296e-01,4.362939e+00,-4.565139e+00,-1.050310e+01,8.472457e-01,8.449894e-01,9.299387e+00,4.188044e+00,-1.138349e+00,-6.776574e+00,-2.238330e+00,-6.319358e+00,7.832209e-01,-9.340360e-01,-8.582595e+00,-3.824387e+00,5.529635e+00,5.513343e+00,-1.099106e+00,-6.153996e+00,8.629339e+00,4.485832e+00,-1.619169e+00,-6.212311e+00,7.561383e+00,-3.379408e+00,-2.704568e+00,1.370970e-01,5.719368e+00,6.596437e+00,9.073606e+00,1.691819e+00,6.645324e-01,2.100249e+00,-3.430365e+00,5.748249e+00,5.259474e+00,4.296136e+00,1.007277e+01,-5.155287e+00,-1.979243e+00,3.098119e+00,2.987865e-01,1.028644e+00,4.737405e+00,-2.293267e+00,1.101671e-01,5.105804e-01,4.858547e+00,4.225842e-01,-9.796588e-01,-3.216708e+00,-2.991805e+00,-3.575280e+00,-1.297814e-01,5.571457e+00,7.049356e+00,-1.407684e+00,2.506835e+00,-2.178931e-01,-2.845864e-01,-6.929764e+00,-5.599349e+00,1.171110e+00,3.288733e+00,1.583220e+00,-5.605546e-01,-2.907751e+00,-4.901159e+00,-1.764410e-01,1.231616e+00,1.650142e+00,-1.752448e+00,-2.016070e+00,-1.095978e-01,2.540034e+00,-5.328199e+00,1.343955e+00,4.155428e+00,-1.261429e+00,-3.036951e+00,-8.301551e+00,1.861866e+00,6.610725e+00};

        LMS filt1 = new LMS(mu, length, LMS.WeightsFillMethod.ZEROS);
        filt1.filter(this.desired1, this.signal1);

        LMS filt2 = new LMS(mu, weights);
        filt2.filter(this.desired1, this.signal1);

        Assertions.assertArrayEquals(result, filt1.getOutput(), 0.05);
        Assertions.assertArrayEquals(result, filt2.getOutput(), 0.05);

        // Save plot result
        Plotting fig = new Plotting(600, 300, "LMS Application", "Time", "Signal");
        fig.initialisePlot();
        fig.addSignal("Desired", this.desired1, false);
        fig.addSignal("Output", filt1.getOutput(), false);
        fig.addSignal("Error", filt1.getError(), false);
        fig.saveAsPNG(outputFileName);
    }

    @Test
    public void LMSTest2() throws IOException {
        double mu = 0.1;
        int length = 20;
        String outputFileName = "test_outputs/LMSTest2.png";
        double[] weights = new double[length];
        Arrays.fill(weights, 0);

        // Results calculated with MATLAB R2020b Update 4 9.9.0.1570001
        double[] result = {0,0,-8.421734e-05,-2.225732e-04,6.589808e-04,2.152792e-03,5.844287e-03,1.461282e-02,4.124764e-02,8.911210e-02,1.264123e-01,2.138494e-01,2.954630e-01,3.746900e-01,4.693800e-01,5.471038e-01,6.224386e-01,7.202252e-01,7.921595e-01,8.399704e-01,8.577754e-01,8.450263e-01,8.993684e-01,9.437290e-01,9.391693e-01,9.644819e-01,9.706059e-01,9.651871e-01,9.933987e-01,9.756522e-01,1.023895e+00,9.646808e-01,1.006814e+00,9.827173e-01,9.568060e-01,1.048735e+00,9.403563e-01,9.845438e-01,9.597129e-01,8.948503e-01,9.380087e-01,8.648943e-01,8.890165e-01,8.215463e-01,8.041923e-01,7.754266e-01,7.423613e-01,7.166920e-01,6.852841e-01,6.416320e-01,5.698700e-01,5.578308e-01,4.816138e-01,4.503566e-01,4.205737e-01,4.027192e-01,3.127503e-01,2.854733e-01,2.332498e-01,2.007975e-01,1.229624e-01,8.419749e-02,5.036764e-02,1.656973e-02,-1.964423e-02,-8.100072e-02,-1.620753e-01,-2.120238e-01,-2.612091e-01,-2.519046e-01,-3.052466e-01,-3.327289e-01,-3.785539e-01,-4.092054e-01,-4.654936e-01,-5.227459e-01,-5.907126e-01,-6.070044e-01,-6.475931e-01,-6.821977e-01,-6.972190e-01,-7.412858e-01,-7.840075e-01,-7.894104e-01,-8.622249e-01,-8.854600e-01,-9.125950e-01,-9.601434e-01,-9.696972e-01,-9.864560e-01,-1.013955e+00,-9.733674e-01,-9.829667e-01,-9.373614e-01,-1.045728e+00,-9.857252e-01,-1.012265e+00,-1.018864e+00,-9.672050e-01,-1.006103e+00,-8.837979e-01,-9.942936e-01,-8.501631e-01,-9.364704e-01,-8.141755e-01,-8.869306e-01,-7.445110e-01,-8.176325e-01,-6.745537e-01,-7.792587e-01,-6.917730e-01,-6.499351e-01,-5.598224e-01,-5.865262e-01,-4.875195e-01,-4.757663e-01,-3.977594e-01,-4.408190e-01,-3.395045e-01,-3.196043e-01,-1.752398e-01,-1.589024e-01,-1.120863e-01,-1.001688e-01,-6.290082e-02,-2.694137e-03,7.158764e-02,1.206461e-01,1.869603e-01,1.941906e-01,2.209839e-01,2.691190e-01,2.955287e-01,3.688258e-01,4.411898e-01,5.007723e-01,5.359775e-01,6.033917e-01,6.599248e-01,6.809604e-01,7.367389e-01,7.649146e-01,7.643270e-01,7.859514e-01,8.085323e-01,8.236985e-01,8.585105e-01,8.897107e-01,8.973004e-01,9.533202e-01,9.916241e-01,9.773469e-01,9.843565e-01,9.825344e-01,1.029810e+00,9.973045e-01,9.798541e-01,1.046580e+00,9.784488e-01,9.816828e-01,9.841052e-01,9.498581e-01,9.364896e-01,1.006884e+00,9.074319e-01,9.103322e-01,8.382301e-01,8.592512e-01,8.009884e-01,8.330714e-01,7.114380e-01,7.185313e-01,6.780895e-01,6.743494e-01,6.363194e-01,5.867828e-01,5.385896e-01,5.116244e-01,4.444757e-01,4.227769e-01,3.380537e-01,3.136242e-01,2.470887e-01,2.149605e-01,1.941356e-01,1.505306e-01,5.847753e-02,2.642560e-02,-7.937750e-03,-7.050859e-02,-1.319663e-01,-2.067650e-01,-2.648365e-01,-3.092713e-01,-3.470872e-01,-3.765063e-01,-3.911005e-01,-4.342583e-01,-4.952116e-01,-5.301461e-01,-5.859761e-01,-6.547368e-01,-6.840993e-01,-7.181332e-01,-7.526005e-01,-7.690735e-01,-8.124359e-01,-8.560350e-01,-8.788863e-01,-8.971980e-01,-9.270571e-01,-9.004693e-01,-9.563320e-01,-9.757491e-01,-9.844010e-01,-1.001204e+00,-9.765484e-01,-9.973347e-01,-9.643397e-01,-1.005196e+00,-1.009935e+00,-9.556532e-01,-9.689751e-01,-9.886576e-01,-9.816417e-01,-9.401485e-01,-9.349041e-01,-9.056250e-01,-8.937791e-01,-8.509020e-01,-8.409861e-01,-8.187100e-01,-7.951203e-01,-7.472107e-01,-7.206901e-01,-6.767238e-01,-6.317758e-01,-6.549291e-01,-5.198863e-01,-4.965653e-01,-4.946217e-01,-3.820307e-01,-3.612807e-01,-3.276564e-01,-2.813178e-01,-2.601282e-01,-1.895275e-01,-9.605430e-02,-6.880423e-02,-2.467027e-02,1.364135e-02,5.878847e-02,1.170671e-01,1.728099e-01,2.141850e-01,2.580805e-01,3.535097e-01,3.417784e-01,4.206291e-01,4.927149e-01,5.358389e-01,5.514429e-01,5.694694e-01,6.124139e-01,6.576334e-01,6.666003e-01,7.102405e-01,7.528026e-01,7.867638e-01,8.528986e-01,8.723686e-01,9.171589e-01,9.351992e-01,9.265856e-01,9.345255e-01,9.408374e-01,9.488541e-01,9.868976e-01,1.002787e+00,9.934586e-01,1.023298e+00,9.979394e-01,1.001781e+00,1.011742e+00,9.963056e-01,9.639632e-01,9.654237e-01,9.305897e-01,9.719637e-01,8.618995e-01,9.378034e-01,8.131538e-01,9.146293e-01,7.915052e-01,8.202302e-01,7.384320e-01,6.949305e-01,7.251464e-01,6.054936e-01,5.971725e-01,5.948897e-01,5.247877e-01,5.079391e-01,4.776991e-01,4.281668e-01,3.584797e-01,3.163586e-01,2.724832e-01,2.382452e-01,1.801833e-01,1.389848e-01,6.632108e-02,1.426231e-02,-1.263156e-02,-1.031834e-01,-1.661229e-01,-2.369502e-01,-2.768469e-01,-3.082853e-01,-3.412627e-01,-3.918780e-01,-4.487169e-01,-4.764249e-01,-5.143584e-01,-5.412090e-01,-5.746896e-01,-6.240749e-01,-6.689980e-01,-7.297382e-01,-7.419127e-01,-7.622582e-01,-8.256610e-01,-8.402735e-01,-8.746796e-01,-8.969166e-01,-9.096716e-01,-8.931263e-01,-9.094198e-01,-9.974525e-01,-9.633614e-01,-1.002445e+00,-1.001476e+00,-9.793088e-01,-9.934907e-01,-9.957366e-01,-9.695444e-01,-1.008425e+00,-9.751142e-01,-9.754451e-01,-9.548743e-01,-9.393016e-01,-9.352030e-01,-9.197744e-01,-9.240436e-01,-8.105521e-01,-8.817289e-01,-7.687051e-01,-7.860396e-01,-7.457859e-01,-7.188717e-01,-6.882551e-01,-6.268272e-01,-5.775043e-01,-5.611212e-01,-5.051343e-01,-4.445606e-01,-4.384603e-01,-3.874586e-01,-3.370123e-01,-2.800054e-01,-2.521779e-01,-1.838695e-01,-1.440583e-01,-1.022914e-01,-1.876293e-02,9.108004e-03,5.667121e-02,1.239948e-01,1.489845e-01,2.059194e-01,3.068867e-01,3.666373e-01,4.053829e-01,4.372038e-01,4.640788e-01,5.201840e-01,5.770562e-01,6.044858e-01,6.194061e-01,6.445410e-01,6.675668e-01,6.893585e-01,7.199744e-01,7.456168e-01,7.846558e-01,8.263418e-01,8.481880e-01,9.019312e-01,9.301639e-01,9.650652e-01,9.934024e-01,9.905705e-01,9.659061e-01,9.726788e-01,9.932355e-01,1.015825e+00,1.028289e+00,9.986529e-01,1.013783e+00,9.985134e-01,9.871028e-01,9.671188e-01,9.323164e-01,9.188887e-01,9.179222e-01,9.102446e-01,8.446514e-01,8.625797e-01,7.972256e-01,7.935411e-01,7.420765e-01,7.371951e-01,6.737123e-01,6.575762e-01,6.183164e-01,5.779419e-01,5.611681e-01,4.882108e-01,4.718018e-01,3.907542e-01,3.528987e-01,3.049163e-01,2.474227e-01,2.054257e-01,1.170881e-01,6.561660e-02,1.270941e-02,-1.799934e-02,-3.156524e-02,-9.211088e-02,-1.356294e-01,-1.723406e-01,-2.435035e-01,-2.938968e-01,-3.458164e-01,-3.757705e-01,-4.027477e-01,-4.310600e-01,-4.648734e-01,-5.223480e-01,-5.643465e-01,-6.572861e-01,-7.170610e-01,-7.326716e-01,-7.711245e-01,-8.257618e-01,-8.558975e-01,-8.497954e-01,-8.682151e-01,-8.789295e-01,-8.980724e-01,-9.007347e-01,-9.514243e-01,-9.674714e-01,-9.936011e-01,-9.946542e-01,-9.909346e-01,-9.821229e-01,-9.825998e-01,-9.909890e-01,-9.982809e-01,-9.884749e-01,-9.686482e-01,-9.753974e-01,-9.477613e-01,-9.512724e-01,-9.406196e-01,-8.895945e-01,-9.087836e-01,-8.531581e-01,-8.393844e-01,-7.897321e-01,-7.916637e-01,-7.126132e-01,-7.099984e-01,-6.670369e-01,-6.322339e-01,-5.859510e-01,-5.441524e-01,-4.977146e-01,-4.755582e-01,-4.085518e-01,-3.551249e-01,-3.197131e-01,-2.451691e-01,-2.214741e-01,-2.016915e-01,-1.571997e-01,-8.912463e-02,-1.419312e-02,2.669910e-02,8.743241e-02,1.382909e-01,1.895374e-01,2.413824e-01,2.888357e-01,3.351898e-01,4.165011e-01,4.517096e-01,4.463799e-01,4.647241e-01,4.899585e-01,5.307483e-01,5.792149e-01,6.439553e-01,7.006852e-01,7.529726e-01,7.922434e-01,8.586771e-01,8.925712e-01,8.670983e-01,8.467267e-01,8.985631e-01,9.066144e-01,9.267223e-01,9.702619e-01,1.008029e+00,1.013212e+00,9.658125e-01,1.000049e+00,9.923219e-01,9.984692e-01,9.859692e-01,9.782948e-01,9.924890e-01,9.630405e-01,9.525492e-01,9.838014e-01,9.258495e-01,9.285716e-01,8.962234e-01,8.591882e-01,8.723143e-01,7.867010e-01,8.183410e-01,7.436989e-01,7.372488e-01,6.574232e-01,6.360779e-01,6.019888e-01,5.619518e-01,5.176193e-01,4.901491e-01,4.315128e-01,4.066963e-01,3.350849e-01,2.967212e-01,2.564823e-01,1.906838e-01,1.647210e-01,1.035789e-01,3.851359e-02,2.581207e-02,-1.540494e-02,-8.349884e-02,-1.273817e-01,-1.862502e-01,-2.414063e-01,-2.745722e-01,-3.473285e-01,-3.978962e-01,-4.152674e-01,-4.529329e-01,-4.819057e-01,-5.133201e-01,-5.919331e-01,-6.706371e-01,-7.269698e-01,-7.367399e-01,-7.499886e-01,-7.780852e-01,-8.161455e-01,-8.254012e-01,-8.721376e-01,-9.133787e-01,-9.225533e-01,-9.283349e-01,-9.263898e-01,-9.650131e-01,-9.850611e-01,-9.734718e-01,-9.900989e-01,-9.768719e-01,-9.754915e-01,-9.942748e-01,-9.782630e-01,-1.003032e+00,-9.615370e-01,-9.621956e-01,-9.373755e-01,-9.405639e-01,-9.061268e-01,-9.081392e-01,-8.966073e-01,-8.278345e-01,-8.612061e-01,-7.871536e-01,-7.676088e-01,-7.430801e-01,-6.823943e-01,-6.603251e-01,-6.314049e-01,-5.975769e-01,-5.434359e-01,-5.216082e-01,-4.625160e-01,-3.986903e-01,-3.599666e-01,-3.023848e-01,-2.258265e-01,-1.831760e-01,-1.501421e-01,-1.052318e-01,-5.672837e-02,-2.673988e-02,3.292604e-03,8.208407e-02,1.374082e-01,1.878373e-01,2.351748e-01,2.826925e-01,3.455181e-01,3.693189e-01,4.199062e-01,4.607233e-01,4.951458e-01,5.472112e-01,5.679768e-01,5.791349e-01,6.265096e-01,6.750147e-01,7.159085e-01,7.520997e-01,8.198636e-01,8.436612e-01,8.827533e-01,9.551504e-01,9.685745e-01,9.758965e-01,9.678210e-01,9.609784e-01,9.820225e-01,1.006042e+00,1.033114e+00,9.982639e-01,9.718402e-01,1.013435e+00,9.904421e-01,9.783145e-01,9.699275e-01,1.002672e+00,9.200357e-01,9.428122e-01,9.259162e-01,8.840212e-01,9.195512e-01,8.581934e-01,8.459096e-01,8.199683e-01,7.984706e-01,7.407096e-01,7.198053e-01,6.948672e-01,6.682850e-01,6.204460e-01,5.674909e-01,5.314585e-01,4.737505e-01,4.011681e-01,3.600472e-01,3.335377e-01,2.472971e-01,2.314435e-01,1.688678e-01,1.080565e-01,7.018775e-02,2.496548e-02,-2.268269e-02,-7.646536e-02,-1.205945e-01,-1.581059e-01,-1.982391e-01,-2.419851e-01,-3.020645e-01,-3.550158e-01,-4.244481e-01,-4.622000e-01,-5.070203e-01,-5.533374e-01,-6.033315e-01,-6.231499e-01,-6.476635e-01,-6.759727e-01,-7.164313e-01,-7.715893e-01,-7.972298e-01,-8.215141e-01,-8.665879e-01,-9.273024e-01,-9.383125e-01,-9.534628e-01,-9.407402e-01,-9.558069e-01,-9.713966e-01,-9.961733e-01,-9.829431e-01,-9.716396e-01,-1.005298e+00,-9.739617e-01,-1.014321e+00,-9.714029e-01,-9.898018e-01,-9.644133e-01,-9.899650e-01,-9.392489e-01,-9.484054e-01,-9.246187e-01,-9.211637e-01,-8.589989e-01,-8.748493e-01,-8.237362e-01,-8.020367e-01,-7.692074e-01,-7.618996e-01,-7.085815e-01,-6.519074e-01,-6.371682e-01,-5.612639e-01,-5.316684e-01,-4.689682e-01,-4.374304e-01,-4.015760e-01,-3.586355e-01,-3.202217e-01,-2.611625e-01,-2.160005e-01,-1.479536e-01,-1.030134e-01,-5.058643e-02,-3.081843e-02,4.508772e-02,1.238676e-01,1.694454e-01,1.784297e-01,2.364751e-01,2.821548e-01,3.089538e-01,3.643106e-01,3.958529e-01,4.208112e-01,4.650941e-01,5.252321e-01,5.602606e-01,6.120250e-01,6.685015e-01,7.263693e-01,7.600483e-01,7.980380e-01,8.203757e-01,8.161831e-01,8.466108e-01,8.950315e-01,9.099799e-01,9.170846e-01,9.459780e-01,9.308037e-01,9.678302e-01,9.986782e-01,9.972669e-01,1.003521e+00,1.020425e+00,9.938214e-01,9.830934e-01,9.836915e-01,9.951568e-01,1.013413e+00,9.540017e-01,9.521845e-01,9.321382e-01,8.958614e-01,8.571853e-01,8.880194e-01,8.065564e-01,8.273184e-01,7.786040e-01,7.475066e-01,7.171675e-01,6.515486e-01,6.529103e-01,6.214199e-01,5.635741e-01,4.861138e-01,4.571442e-01,4.082082e-01,3.789870e-01,3.509091e-01,2.883841e-01,2.265463e-01,1.797258e-01,1.163706e-01,7.266126e-02,1.565083e-02,-4.747275e-02,-7.456986e-02,-1.201368e-01,-1.637324e-01,-2.029170e-01,-2.786630e-01,-3.230430e-01,-3.528557e-01,-4.021535e-01,-4.673312e-01,-5.110804e-01,-5.710836e-01,-6.212538e-01,-6.504043e-01,-6.868987e-01,-7.106429e-01,-7.366216e-01,-7.624629e-01,-7.662139e-01,-8.093824e-01,-8.413509e-01,-8.604350e-01,-8.943303e-01,-9.137393e-01,-9.517299e-01,-9.618328e-01,-9.718617e-01,-1.017719e+00,-9.790716e-01,-9.934631e-01,-1.001183e+00,-1.009085e+00,-1.011207e+00,-1.030289e+00,-9.832156e-01,-9.704311e-01,-9.854128e-01,-9.266539e-01,-9.563838e-01,-9.126941e-01,-8.889444e-01,-8.552448e-01,-8.730401e-01,-8.208766e-01,-8.070195e-01,-7.307011e-01,-7.435801e-01,-6.708360e-01,-6.638763e-01,-6.042640e-01,-5.760834e-01,-5.473163e-01,-4.944649e-01,-4.708208e-01,-3.913187e-01,-3.599229e-01,-3.068135e-01,-2.522469e-01,-2.184183e-01,-1.647417e-01,-8.714265e-02,-2.615305e-02,5.237161e-03,2.652161e-02,5.790286e-02,9.668972e-02,1.804936e-01,2.651827e-01,3.037055e-01,3.447014e-01,3.673302e-01,4.047895e-01,4.631893e-01,4.878791e-01,5.111702e-01,5.522367e-01,5.774594e-01,6.139397e-01,6.657684e-01,7.289983e-01,7.929567e-01,8.271055e-01,8.472967e-01,8.410055e-01,8.523619e-01,8.807535e-01,9.669089e-01,9.679916e-01,9.735698e-01,9.702891e-01,9.738417e-01,1.015757e+00,1.011567e+00,9.682731e-01,9.925088e-01,9.968239e-01,9.694558e-01,9.881661e-01,9.613666e-01,1.003458e+00,9.155492e-01,9.510171e-01,8.562388e-01,8.940635e-01,8.239221e-01,8.488180e-01,8.110593e-01,7.939165e-01,7.715733e-01,6.994798e-01,6.732978e-01,6.520288e-01,5.955562e-01,5.501697e-01,5.134984e-01,4.489341e-01,4.126027e-01,3.668872e-01,3.058566e-01,2.650998e-01,2.300340e-01,1.761758e-01,8.425583e-02,5.310712e-02,3.301936e-02,-1.748670e-02,-7.092340e-02,-1.196330e-01,-1.482082e-01,-1.948236e-01,-2.520058e-01,-3.121484e-01,-3.594239e-01,-3.911695e-01,-4.496182e-01,-5.236944e-01,-5.656582e-01,-6.124573e-01,-6.583155e-01,-7.022225e-01,-7.290904e-01,-7.719639e-01,-7.899756e-01,-7.853036e-01,-8.019281e-01,-8.236061e-01,-8.236368e-01,-8.847394e-01,-9.139873e-01,-9.542297e-01,-9.597378e-01,-9.897676e-01,-9.938819e-01,-9.825987e-01,-1.003479e+00,-9.891601e-01,-1.001115e+00,-1.005976e+00,-1.007598e+00,-9.793871e-01,-9.993601e-01,-9.552637e-01,-9.386124e-01,-9.265302e-01,-9.354046e-01,-8.641562e-01,-8.442335e-01,-8.448187e-01,-8.494816e-01,-7.633925e-01,-7.491192e-01,-7.458119e-01,-6.634827e-01,-6.345058e-01,-6.183563e-01,-5.743961e-01,-5.469036e-01,-5.213535e-01,-4.687420e-01,-4.054345e-01,-3.632679e-01,-2.955694e-01,-2.271318e-01,-1.651211e-01,-1.332020e-01,-9.570618e-02,-8.832947e-03,1.440568e-02};

        LMS filt1 = new LMS(mu, length, LMS.WeightsFillMethod.ZEROS);
        filt1.filter(this.desired2, this.signal2);
        LMS filt2 = new LMS(mu, weights);
        filt2.filter(this.desired2, this.signal2);

        Assertions.assertArrayEquals(result, filt1.getOutput(), 0.05);
        Assertions.assertArrayEquals(result, filt2.getOutput(), 0.05);

        // Save plot result
        Plotting fig = new Plotting(600, 300, "LMS Application", "Time", "Signal");
        fig.initialisePlot();
        fig.addSignal("Desired", this.desired2, false);
        fig.addSignal("Output", filt1.getOutput(), false);
        fig.addSignal("Error", filt1.getError(), false);
        fig.saveAsPNG(outputFileName);
    }

    @Test
    public void LMSTestLeakage1() {
        double mu = 0.01;
        double leakageFactor = 0.5;
        int length = 4;
        double[] weights = new double[length];
        Arrays.fill(weights, 0);

        // Results calculated with MATLAB R2020b Update 4 9.9.0.1570001
        double[] result = {0,-1.145232e-03,7.058800e-04,-8.378217e-05,1.615787e-03,-1.520679e-01,4.262660e+00,9.134201e-01,-8.370837e-01,1.782784e-01,1.568164e+00,2.306801e+00,1.753618e+00,-1.935961e-01,-1.553064e-02,1.214521e-01,3.510760e-01,-1.736068e+00,1.146839e+00,-2.164733e-01,-2.585165e-01,-5.038974e-01,-1.025699e-01,-2.470125e-01,-6.681924e-02,1.930588e-01,-7.893536e-01,-1.482185e+00,1.669030e-01,2.119204e-01,2.382712e-02,4.232955e-02,1.523465e-01,6.380138e-01,5.023882e-02,-3.861309e-01,8.971231e-01,-3.174113e+00,-1.692682e+00,1.170003e+00,-3.120438e+00,3.116109e-01,4.597358e-01,9.245257e-01,-8.089605e-01,4.537106e-01,1.422733e-01,1.627273e+00,2.186127e-01,-1.429031e+00,-2.936175e+00,3.815540e-01,6.698031e-01,2.050080e-01,-4.344362e+00,4.246546e+00,2.932402e-01,2.469037e+00,2.233451e-01,1.143277e+00,-3.474885e-01,-5.886130e-01,-1.496758e+00,-9.514734e-01,4.363562e-01,1.175014e+00,-9.798943e-01,-7.280037e-01,2.117512e+00,5.094275e+00,4.422531e+00,-1.143559e+00,8.790349e+00,-6.604638e-01,3.485633e+00,2.419454e-01,1.384900e-01,4.198942e-01,-5.255286e-01,5.076752e-01,-1.317654e-01,-3.897611e-02,-3.476725e-01,2.997918e+00,-5.181893e+00,5.338944e-01,-1.983087e+00,1.724448e+00,1.897279e+00,9.690901e-01,-2.456805e-01,1.039855e-01,-3.175605e-02,1.037253e-01,4.077635e-02,4.354750e-01,1.451453e+00,9.432212e-01,8.035561e-02,-2.034209e-01,-7.634958e-01,-1.966499e+00,9.952967e-02,-3.335153e+00,7.863494e-01,7.935060e+00,-4.152284e+00,-1.342754e+00,1.059113e+00,-3.741675e+00,-7.854284e-01,3.919154e-01,1.253187e-01,8.116022e-02,-1.177614e-01,2.185276e-02,1.673408e-01,2.144415e-01,-8.067259e-01,-5.152776e-01,2.089773e+00,-1.548727e+00,8.859473e-01,-3.062934e+00,6.528334e+00,8.171067e-03,3.057577e+00,-2.839339e+00,2.329333e+00,2.702250e-01,2.084052e-01,-5.705696e-01,9.751323e-01,6.892531e-01,4.653978e-01,1.122885e+00,-3.331944e-02,1.429415e+00,7.207089e-01,-1.264640e-01,-3.115181e-01,-1.443516e-01,-2.179107e-01,-4.657258e-01,-1.271990e-01,-2.633877e-03,9.812501e-02,-5.374355e-02,-1.789775e-01,1.562425e-01,1.996132e-01,-2.744186e-01,9.119917e-01,-2.217167e-01,-2.122020e+00,1.348971e+00,6.350835e-01,1.856961e-01,-8.338732e-02,-4.418088e-01,-9.723072e-01,-2.091793e+00,-3.151529e+00,-6.569765e-01,6.273342e-01,-5.467066e-02,-2.874560e-03,-1.803680e-01,-6.275470e-01,-2.563335e+00,-4.657883e+00,-2.627660e+00,-9.155524e+00,2.002992e+00,1.053023e+00,8.369389e-02,-3.964378e-01,8.479023e-01,-3.465980e+00,4.236689e-01,2.571523e-01,9.963034e-02,1.273350e+00,-1.344098e+00,4.882267e+00,-3.520493e+00,7.387671e-01,-6.499135e+00,-1.378285e+00,-5.915227e-01,5.316938e-01,9.067561e-01,7.828664e-01,-7.920936e-01,6.226590e-01,-8.941309e-02,5.360717e-01,4.030990e-01,9.398694e-02,4.214217e-02,1.349043e-01,1.735642e-01,-1.348064e-02,-8.052969e-03,5.945662e-02,2.039072e-01,5.672607e-02,3.002795e-02,-1.565792e-02,-1.370923e-01,-1.662570e-01,-3.624910e-01,6.180434e-01,1.898069e+00,-8.461990e-01,-4.050075e-01,5.644476e-01,-7.008683e-01,-1.415191e+00,-4.603315e-01,1.534514e-01,-2.799347e-02,1.834959e+00,1.383527e+00,-9.911296e+00,-2.780476e+00,3.338654e+00,2.799260e+00,3.304664e+00,1.197458e+00,-3.298240e+00,-1.016952e+00,3.533410e-02,1.102706e+00,-8.225414e-01,-2.030671e-01,-5.542377e-02,1.675504e-01,7.059483e-02,-1.083158e+00,-5.909394e-01,1.356883e+00,9.554154e-01,-1.456941e+00,1.767706e+00,1.524049e+00,-8.758494e-02,-8.705564e-02,-1.557969e-01,3.954902e-01,3.136227e-02,-5.426854e-01,6.492134e-01,6.823354e-01,-5.166414e-01,6.888369e-01,1.411555e+00,3.501665e+00,9.394298e-01,-1.556608e+00,6.786415e-01,-1.891676e-01,5.802906e-02,-9.464540e-01,5.386805e-01,2.690077e-01,8.002719e-01,6.832188e-01,8.583588e-02,5.507458e-01,-1.009007e+00,1.564060e+00,-2.649336e-01,-4.546607e+00,3.837118e+00,-3.782094e-01,1.785909e+00,-2.364089e+00,-4.487880e+00,-3.398062e+00,3.121119e+00,-1.040022e+00,-5.107547e-01,-1.119570e+00,-8.463370e-01,-2.561574e+00,-8.233290e-01,3.405409e+00,-6.143249e-01,-8.531753e-01,-2.268176e+00,-1.744247e+00,-1.371505e+00,-9.018442e-01,-5.730534e-02,3.964691e-01,-1.590335e+00,8.651868e-01,-1.255258e+00,5.515093e+00,-7.166275e+00,1.785422e+00,5.023733e+00,2.124220e+00,2.155723e+00,-9.282979e-01,-4.395458e-01,-1.389856e+00,2.828280e+00,5.719528e-01,1.339540e+00,-6.435993e-01,-3.980208e-01,2.030485e-01,-6.422298e-01,6.010842e-01,1.105536e+00,4.220048e+00,2.147030e+00,8.707952e-01,1.435954e+00,-1.119336e+00,-8.698091e-01,-7.114986e-01,-2.637507e+00,-1.436469e+00,-9.271651e-01,-6.356121e-01,6.823685e-02,-3.599588e-01,4.272198e-01,-5.222450e-01,4.785058e-01,1.369752e-02,5.698497e-01,-4.095626e-01,-2.834991e-01,9.454132e-01,-2.639938e+00,2.395106e+00,-1.021279e+00,-2.439264e+00,1.561368e-01,-5.958228e-02,-3.219025e-01,-1.146464e-01,3.146261e-01,-3.756217e-01,1.214181e-01,-8.837068e-02,9.269562e-01,-2.619513e+00,3.016709e+00,-2.028101e+00,1.072014e+00,-1.245553e+01,-1.652319e+00,-3.195160e+00,6.465855e-01,-9.128976e-01,2.757973e-01,1.893631e+00,6.065971e-01,1.596221e-01,1.521736e+00,2.299199e+00,9.851864e-01,-3.605306e-01,-2.323485e-01,1.209694e-02,1.037818e+00,-2.678401e+00,3.093946e+00,-3.740432e-02,6.287244e+00,-1.269944e-01,-1.477517e+00,8.050899e-01,-3.013790e+00,1.159314e+00,1.804509e+00,-1.036285e+00,2.093709e-01,-2.478658e-02,-1.267536e+00,-4.322631e+00,2.140173e+00,-1.177710e+00,-1.079383e-01,9.107277e-02,8.844617e-01,1.582246e+00,1.587674e+00,-3.843663e+00,8.762805e+00,1.180412e+00,4.230758e+00,1.402934e+00,-1.050626e+00,5.855616e-01,9.606263e-01,-2.494070e+00,-2.546699e-01,1.054634e+00,-4.224126e-01,-6.377365e-01,2.671378e-02,-2.812819e-01,5.055159e-01,-2.829162e-03,-1.420012e-01,2.069369e-01,-1.617858e+00,2.788186e-01,-5.274723e-02,1.864781e+00,-1.026281e+00,1.158342e+00,-2.309271e+00,-1.234710e+00,-1.488455e+00,3.010458e+00,1.094136e+00,3.421612e+00,1.968486e-01,-4.032293e+00,-2.313693e+00,-2.626167e-01,-1.184947e+00,-8.372767e-01,-5.258526e-01,-3.086235e+00,1.575246e+00,2.304316e+00,-4.094988e-01,-2.776616e+00,1.510562e+00,8.808818e-01,-3.875302e+00,-2.293706e+00,4.761434e-01,-4.177043e+00,-1.977977e+00,1.078355e+00,7.502004e-01,2.754429e+00,5.021995e+00,5.479964e+00,-3.379464e+00,2.111646e+00,-3.147015e-02,1.163589e+00,3.256975e-01,1.779344e+00,4.286506e+00,2.828977e+00,-1.190005e+00,8.927545e-01,-6.629765e-01,-2.229733e-01,2.831958e-01,-3.879292e-01,1.597823e-01,2.037707e-01,1.515777e-01,2.109924e-01,-1.680926e-01,-4.162181e-01,-5.025187e-01,-7.791017e-01,-7.735552e-01,4.277306e-01,3.134931e+00,4.558419e-01,-1.065966e+00,5.748813e-01,1.765958e-01,-3.339415e-01,-2.967857e+00,-8.051678e-01,1.701101e+00,9.262687e-01,-3.457225e-01,-3.947472e-01,-6.669875e-01,-6.044358e-01,3.947683e-01,4.230662e-01,-7.883410e-02,-1.856563e-01,-3.892015e-02,1.556603e-01,-2.922307e-01,1.003063e+00,6.400072e-01,-1.147204e+00,-6.934078e-01,-9.616543e-01,-3.621547e-01,3.401548e+00};

        LMS filt1 = new LMS(mu, leakageFactor, length, LMS.WeightsFillMethod.ZEROS);
        filt1.filter(this.desired1, this.signal1);

        LMS filt2 = new LMS(mu, leakageFactor, weights);
        filt2.filter(this.desired1, this.signal1);

        Assertions.assertArrayEquals(result, filt1.getOutput(), 0.05);
        Assertions.assertArrayEquals(result, filt2.getOutput(), 0.05);
    }

    @Test
    public void LMSTestLeakage2() {
        double mu = 0.1;
        double leakageFactor = 0.9;
        int length = 20;
        double[] weights = new double[length];
        Arrays.fill(weights, 0);

        // Results calculated with MATLAB R2020b Update 4 9.9.0.1570001
        double[] result = {0,0,-8.421734e-05,-2.469882e-04,5.755072e-04,1.927682e-03,5.178049e-03,1.282486e-02,3.603218e-02,7.813741e-02,1.098982e-01,1.815508e-01,2.484409e-01,3.125364e-01,3.880693e-01,4.517166e-01,5.147495e-01,5.950216e-01,6.604140e-01,7.123478e-01,7.448504e-01,7.554877e-01,8.077083e-01,8.486406e-01,8.601031e-01,8.897889e-01,9.032574e-01,9.102644e-01,9.303075e-01,9.261503e-01,9.606436e-01,9.242107e-01,9.577765e-01,9.360580e-01,9.311236e-01,9.580927e-01,9.140992e-01,9.227672e-01,9.028793e-01,8.731942e-01,8.750153e-01,8.405128e-01,8.262854e-01,7.895768e-01,7.685017e-01,7.340149e-01,7.065360e-01,6.753621e-01,6.395872e-01,6.067528e-01,5.550588e-01,5.314587e-01,4.797053e-01,4.428691e-01,4.074776e-01,3.570798e-01,3.132418e-01,2.747120e-01,2.268271e-01,1.915256e-01,1.451067e-01,1.056858e-01,6.752827e-02,3.188660e-02,-1.512960e-03,-3.388061e-02,-6.371421e-02,-8.799718e-02,-1.069091e-01,-1.149139e-01,-1.318922e-01,-1.417723e-01,-1.626366e-01,-1.847481e-01,-2.129924e-01,-2.438035e-01,-3.078614e-01,-3.539131e-01,-4.204037e-01,-4.793761e-01,-5.393582e-01,-6.033455e-01,-6.593054e-01,-6.876408e-01,-7.526441e-01,-7.869561e-01,-8.240861e-01,-8.619388e-01,-8.801842e-01,-9.052951e-01,-9.270416e-01,-9.207278e-01,-9.315672e-01,-9.177821e-01,-9.631190e-01,-9.335332e-01,-9.508033e-01,-9.489129e-01,-9.271743e-01,-9.374125e-01,-8.904986e-01,-9.160694e-01,-8.539863e-01,-8.825177e-01,-8.037728e-01,-8.422164e-01,-7.480455e-01,-7.815928e-01,-6.881376e-01,-7.158784e-01,-6.393692e-01,-6.340924e-01,-5.673857e-01,-5.613722e-01,-4.875280e-01,-4.701380e-01,-4.124677e-01,-3.804300e-01,-3.340191e-01,-2.899540e-01,-2.451295e-01,-2.017590e-01,-1.621070e-01,-1.227983e-01,-8.550924e-02,-4.709813e-02,-1.240793e-02,1.994126e-02,5.147816e-02,7.666731e-02,9.358165e-02,1.063532e-01,1.218567e-01,1.278048e-01,1.434350e-01,1.577445e-01,1.806402e-01,1.976004e-01,2.347730e-01,2.690617e-01,3.612303e-01,4.330886e-01,4.925798e-01,5.531350e-01,6.102657e-01,6.641883e-01,7.194690e-01,7.653501e-01,7.881545e-01,8.428383e-01,8.744095e-01,8.872714e-01,9.024725e-01,9.129661e-01,9.441454e-01,9.330191e-01,9.374837e-01,9.610272e-01,9.336177e-01,9.419032e-01,9.302182e-01,9.206699e-01,9.086647e-01,9.199265e-01,8.773261e-01,8.728412e-01,8.286008e-01,8.278443e-01,7.868769e-01,7.735249e-01,7.199967e-01,7.043351e-01,6.606849e-01,6.416826e-01,5.902004e-01,5.640595e-01,5.171189e-01,4.768402e-01,4.365282e-01,3.983054e-01,3.488461e-01,3.123755e-01,2.665071e-01,2.190335e-01,1.801790e-01,1.424028e-01,1.027796e-01,6.707219e-02,3.149256e-02,-1.064947e-03,-3.075280e-02,-6.052995e-02,-8.794297e-02,-1.087545e-01,-1.250264e-01,-1.360109e-01,-1.451506e-01,-1.544791e-01,-1.735665e-01,-1.856178e-01,-2.265422e-01,-2.735878e-01,-3.276886e-01,-3.919784e-01,-4.565421e-01,-5.156880e-01,-5.979142e-01,-6.673856e-01,-7.192735e-01,-7.680908e-01,-8.122803e-01,-8.148482e-01,-8.710770e-01,-8.881184e-01,-9.088193e-01,-9.258924e-01,-9.246993e-01,-9.415333e-01,-9.265425e-01,-9.573442e-01,-9.486389e-01,-9.289211e-01,-9.390456e-01,-9.310965e-01,-9.301232e-01,-9.013578e-01,-8.982431e-01,-8.636008e-01,-8.634006e-01,-8.166778e-01,-8.143604e-01,-7.784833e-01,-7.521717e-01,-7.179560e-01,-6.864969e-01,-6.484622e-01,-6.156251e-01,-5.866488e-01,-5.370716e-01,-4.950313e-01,-4.597281e-01,-4.146137e-01,-3.743141e-01,-3.286621e-01,-2.835414e-01,-2.455404e-01,-1.999665e-01,-1.557981e-01,-1.157541e-01,-7.648149e-02,-3.856473e-02,-1.529724e-03,3.134220e-02,6.091674e-02,8.631754e-02,1.086793e-01,1.319371e-01,1.326467e-01,1.465329e-01,1.702870e-01,1.861799e-01,2.079697e-01,2.374511e-01,2.743475e-01,3.293664e-01,3.572583e-01,4.305962e-01,5.040338e-01,5.766359e-01,6.514635e-01,7.040592e-01,7.647208e-01,8.082928e-01,8.199466e-01,8.524937e-01,8.625968e-01,8.858785e-01,9.163917e-01,9.260433e-01,9.326198e-01,9.509376e-01,9.450114e-01,9.500448e-01,9.543712e-01,9.430709e-01,9.372028e-01,9.190044e-01,9.166084e-01,9.040433e-01,8.662753e-01,8.768995e-01,8.127206e-01,8.447080e-01,7.688717e-01,7.808711e-01,7.160701e-01,7.050012e-01,6.608966e-01,6.247860e-01,5.864575e-01,5.551513e-01,5.077832e-01,4.755456e-01,4.291103e-01,3.893896e-01,3.440335e-01,3.058903e-01,2.624279e-01,2.182211e-01,1.805142e-01,1.387590e-01,9.986381e-02,5.998411e-02,2.687634e-02,-5.683299e-03,-3.283931e-02,-6.192842e-02,-8.293447e-02,-1.062542e-01,-1.302857e-01,-1.495797e-01,-1.731075e-01,-1.903637e-01,-2.103357e-01,-2.307287e-01,-2.696822e-01,-3.191724e-01,-3.755051e-01,-4.542563e-01,-4.986107e-01,-5.678146e-01,-6.484799e-01,-6.996628e-01,-7.526268e-01,-7.936813e-01,-8.237175e-01,-8.207292e-01,-8.542294e-01,-9.138538e-01,-8.917642e-01,-9.404090e-01,-9.261247e-01,-9.406264e-01,-9.376057e-01,-9.544354e-01,-9.282348e-01,-9.616776e-01,-9.211833e-01,-9.370434e-01,-9.123295e-01,-9.037297e-01,-8.851688e-01,-8.774003e-01,-8.508019e-01,-8.150728e-01,-8.123445e-01,-7.681890e-01,-7.496168e-01,-7.029269e-01,-6.925715e-01,-6.348050e-01,-6.153411e-01,-5.620345e-01,-5.407535e-01,-4.843750e-01,-4.558277e-01,-4.063234e-01,-3.699229e-01,-3.246959e-01,-2.804996e-01,-2.416896e-01,-1.953376e-01,-1.535381e-01,-1.116444e-01,-7.471334e-02,-3.770082e-02,-2.875760e-03,3.010900e-02,5.814579e-02,8.306172e-02,1.061075e-01,1.259103e-01,1.489016e-01,1.632955e-01,1.819896e-01,2.125094e-01,2.442928e-01,2.768971e-01,3.106938e-01,3.646390e-01,4.046675e-01,4.698248e-01,5.240044e-01,5.804615e-01,6.396526e-01,6.925014e-01,7.240645e-01,7.917036e-01,8.131222e-01,8.630132e-01,8.870957e-01,9.025948e-01,8.938792e-01,9.180926e-01,9.294431e-01,9.444036e-01,9.534108e-01,9.384781e-01,9.590398e-01,9.336873e-01,9.471029e-01,9.135248e-01,9.154740e-01,8.833662e-01,8.916683e-01,8.521862e-01,8.448238e-01,8.016587e-01,7.952267e-01,7.426109e-01,7.364365e-01,6.845918e-01,6.712601e-01,6.190471e-01,5.954675e-01,5.449523e-01,5.159773e-01,4.677963e-01,4.306304e-01,3.815160e-01,3.420659e-01,2.986156e-01,2.585404e-01,2.171104e-01,1.681286e-01,1.273270e-01,8.863989e-02,5.297847e-02,1.853442e-02,-1.656145e-02,-4.791769e-02,-7.628697e-02,-1.024494e-01,-1.242043e-01,-1.425719e-01,-1.561250e-01,-1.618777e-01,-1.689358e-01,-1.728714e-01,-1.982213e-01,-2.261569e-01,-2.909807e-01,-3.546324e-01,-4.086550e-01,-5.052580e-01,-5.984952e-01,-6.697536e-01,-7.019402e-01,-7.492415e-01,-7.724409e-01,-8.180367e-01,-8.184372e-01,-8.844151e-01,-8.836391e-01,-9.259390e-01,-9.201537e-01,-9.383261e-01,-9.313483e-01,-9.415859e-01,-9.463101e-01,-9.501815e-01,-9.338076e-01,-9.371300e-01,-9.273125e-01,-9.128483e-01,-9.019289e-01,-8.921090e-01,-8.583639e-01,-8.567777e-01,-8.197209e-01,-7.990857e-01,-7.750600e-01,-7.354217e-01,-7.119431e-01,-6.656237e-01,-6.465759e-01,-5.968569e-01,-5.713849e-01,-5.250405e-01,-4.864276e-01,-4.459088e-01,-4.039029e-01,-3.605220e-01,-3.177605e-01,-2.721357e-01,-2.336319e-01,-1.894752e-01,-1.517563e-01,-1.071902e-01,-6.843814e-02,-3.381305e-02,-2.345203e-06,2.950214e-02,5.680513e-02,8.243266e-02,1.030575e-01,1.215748e-01,1.418645e-01,1.548540e-01,1.662975e-01,1.743688e-01,1.913428e-01,2.216227e-01,2.601994e-01,3.252437e-01,3.869262e-01,4.542319e-01,5.214586e-01,6.255278e-01,6.988496e-01,7.130264e-01,7.358874e-01,8.058422e-01,8.093554e-01,8.562479e-01,8.808431e-01,9.238529e-01,9.143648e-01,9.199029e-01,9.385524e-01,9.423961e-01,9.462606e-01,9.412404e-01,9.375852e-01,9.467596e-01,9.154632e-01,9.260952e-01,9.124192e-01,8.849211e-01,8.794406e-01,8.596074e-01,8.325363e-01,8.143035e-01,7.801224e-01,7.614645e-01,7.203973e-01,6.883506e-01,6.546890e-01,6.185365e-01,5.823501e-01,5.422467e-01,5.033299e-01,4.676862e-01,4.220801e-01,3.815806e-01,3.376975e-01,2.975979e-01,2.473005e-01,2.090731e-01,1.678339e-01,1.239393e-01,8.515224e-02,4.973179e-02,1.479957e-02,-1.797789e-02,-4.497944e-02,-7.013504e-02,-9.276523e-02,-1.129830e-01,-1.323897e-01,-1.476895e-01,-1.609020e-01,-1.700518e-01,-1.830935e-01,-1.964099e-01,-2.426209e-01,-3.008559e-01,-3.708835e-01,-4.275331e-01,-4.868314e-01,-5.600283e-01,-6.410606e-01,-6.787388e-01,-7.525612e-01,-7.982466e-01,-8.265723e-01,-8.409380e-01,-8.674045e-01,-8.994329e-01,-9.104845e-01,-9.258954e-01,-9.350391e-01,-9.306309e-01,-9.480887e-01,-9.413362e-01,-9.432538e-01,-9.430071e-01,-9.304670e-01,-9.261662e-01,-9.069563e-01,-9.046899e-01,-8.700041e-01,-8.767521e-01,-8.297580e-01,-8.196016e-01,-7.933735e-01,-7.663156e-01,-7.299844e-01,-7.038228e-01,-6.629215e-01,-6.316537e-01,-5.949106e-01,-5.645816e-01,-5.156340e-01,-4.859427e-01,-4.379645e-01,-3.946844e-01,-3.546994e-01,-3.106458e-01,-2.665113e-01,-2.249561e-01,-1.860065e-01,-1.430383e-01,-1.036840e-01,-6.965386e-02,-3.306735e-02,4.248000e-04,2.938144e-02,5.534448e-02,7.846109e-02,1.001748e-01,1.184530e-01,1.258786e-01,1.401738e-01,1.428374e-01,1.531876e-01,1.783855e-01,1.963257e-01,2.258033e-01,2.837373e-01,3.439973e-01,4.053292e-01,4.686017e-01,5.583750e-01,6.043028e-01,6.814774e-01,7.632884e-01,8.007938e-01,8.361230e-01,8.513816e-01,8.620786e-01,8.995529e-01,9.228274e-01,9.449144e-01,9.262266e-01,9.281506e-01,9.513922e-01,9.446647e-01,9.410661e-01,9.293861e-01,9.521170e-01,8.855580e-01,9.311466e-01,8.606628e-01,8.952749e-01,8.348152e-01,8.444946e-01,7.887055e-01,7.948932e-01,7.396841e-01,7.324121e-01,6.737808e-01,6.628869e-01,6.069139e-01,5.935841e-01,5.387746e-01,5.040445e-01,4.572214e-01,4.146785e-01,3.768807e-01,3.255321e-01,2.923531e-01,2.467544e-01,2.036091e-01,1.594672e-01,1.178440e-01,7.818978e-02,4.071683e-02,2.648918e-03,-2.999369e-02,-5.976798e-02,-8.701752e-02,-1.095429e-01,-1.286720e-01,-1.375988e-01,-1.489542e-01,-1.536674e-01,-1.684102e-01,-1.966965e-01,-2.348754e-01,-2.660098e-01,-3.186591e-01,-3.614351e-01,-4.361978e-01,-5.165382e-01,-5.777167e-01,-6.362173e-01,-7.082790e-01,-7.770672e-01,-8.089470e-01,-8.433551e-01,-8.460809e-01,-8.807509e-01,-8.981506e-01,-9.278157e-01,-9.135735e-01,-9.348160e-01,-9.428914e-01,-9.356440e-01,-9.617397e-01,-9.328101e-01,-9.500637e-01,-9.267061e-01,-9.391261e-01,-8.999850e-01,-9.181552e-01,-8.715571e-01,-8.827006e-01,-8.149731e-01,-8.485292e-01,-7.608416e-01,-8.000843e-01,-7.012466e-01,-7.459317e-01,-6.325582e-01,-6.718966e-01,-5.714264e-01,-5.793709e-01,-5.088727e-01,-4.776846e-01,-4.402000e-01,-3.941170e-01,-3.561429e-01,-3.069073e-01,-2.680601e-01,-2.205407e-01,-1.758069e-01,-1.348342e-01,-9.607614e-02,-5.627325e-02,-1.539534e-02,2.146013e-02,5.379868e-02,7.815882e-02,1.027440e-01,1.199139e-01,1.333753e-01,1.495552e-01,1.588823e-01,1.811370e-01,1.976995e-01,2.231619e-01,2.443943e-01,2.879327e-01,3.407844e-01,4.186219e-01,4.892822e-01,5.722233e-01,6.275108e-01,6.637190e-01,7.178051e-01,7.891235e-01,8.073736e-01,8.338019e-01,8.577525e-01,8.643221e-01,9.045219e-01,9.170901e-01,9.384589e-01,9.388694e-01,9.535054e-01,9.340036e-01,9.460146e-01,9.323223e-01,9.483207e-01,9.417357e-01,9.153328e-01,9.038632e-01,8.973119e-01,8.588239e-01,8.565625e-01,8.254521e-01,8.020296e-01,7.778958e-01,7.534611e-01,7.154416e-01,6.878539e-01,6.384693e-01,6.198510e-01,5.746886e-01,5.351999e-01,4.919566e-01,4.569432e-01,4.121413e-01,3.695139e-01,3.222695e-01,2.833812e-01,2.407623e-01,1.955283e-01,1.561904e-01,1.174074e-01,7.315116e-02,3.688953e-02,1.767968e-03,-3.049810e-02,-5.786255e-02,-8.108887e-02,-1.081034e-01,-1.256269e-01,-1.333327e-01,-1.436616e-01,-1.692737e-01,-1.892865e-01,-2.280504e-01,-2.622028e-01,-3.061324e-01,-3.631902e-01,-4.178627e-01,-4.951882e-01,-5.535317e-01,-5.939303e-01,-6.725977e-01,-7.154929e-01,-7.484244e-01,-7.961743e-01,-8.175393e-01,-8.673697e-01,-8.654464e-01,-9.072635e-01,-9.294376e-01,-9.064758e-01,-9.437653e-01,-9.335820e-01,-9.541865e-01,-9.505104e-01,-9.692592e-01,-9.187126e-01,-9.570039e-01,-9.064945e-01,-9.282869e-01,-8.939505e-01,-8.910321e-01,-8.456717e-01,-8.542009e-01,-8.073103e-01,-8.114700e-01,-7.392657e-01,-7.564295e-01,-6.675147e-01,-6.898674e-01,-6.143948e-01,-6.038613e-01,-5.496911e-01,-5.197850e-01,-4.697207e-01,-4.308278e-01,-3.911060e-01,-3.469591e-01,-3.029142e-01,-2.609848e-01,-2.149196e-01,-1.736834e-01,-1.314505e-01,-9.037915e-02,-5.052375e-02,-1.581967e-02,1.648247e-02,4.727422e-02,7.985619e-02,1.078099e-01,1.287703e-01,1.494111e-01,1.611439e-01,1.741968e-01,1.932779e-01,1.988118e-01,2.200688e-01,2.455598e-01,2.713138e-01,3.285331e-01,3.866583e-01,4.794305e-01,5.592695e-01,6.361071e-01,6.746283e-01,7.118682e-01,7.418584e-01,7.938902e-01,8.664819e-01,8.624267e-01,8.924662e-01,8.947674e-01,9.181213e-01,9.435090e-01,9.365451e-01,9.323860e-01,9.437117e-01,9.451186e-01,9.405072e-01,9.304567e-01,9.335472e-01,9.199871e-01,8.992719e-01,8.889076e-01,8.542813e-01,8.554506e-01,8.104581e-01,8.067861e-01,7.637507e-01,7.557771e-01,7.068413e-01,6.814011e-01,6.383783e-01,6.096463e-01,5.677168e-01,5.347192e-01,4.912120e-01,4.435391e-01,4.097293e-01,3.641683e-01,3.184846e-01,2.742453e-01,2.375524e-01,1.915905e-01,1.513694e-01,1.108511e-01,7.355388e-02,3.289942e-02,-3.484977e-03,-3.620397e-02,-6.062265e-02,-8.516597e-02,-1.069155e-01,-1.234071e-01,-1.347046e-01,-1.418599e-01,-1.514226e-01,-1.778728e-01,-1.992464e-01,-2.308965e-01,-2.820526e-01,-3.431771e-01,-4.041548e-01,-4.829682e-01,-5.484934e-01,-5.858443e-01,-6.549717e-01,-6.790955e-01,-7.223990e-01,-7.864810e-01,-8.203499e-01,-8.607416e-01,-8.644979e-01,-9.073550e-01,-9.132851e-01,-9.144628e-01,-9.347823e-01,-9.314926e-01,-9.436935e-01,-9.486971e-01,-9.456736e-01,-9.304991e-01,-9.414003e-01,-9.045726e-01,-9.157234e-01,-8.881672e-01,-8.784063e-01,-8.557380e-01,-8.162471e-01,-8.235510e-01,-7.787847e-01,-7.464074e-01,-7.269964e-01,-6.893958e-01,-6.449092e-01,-6.256307e-01,-5.800039e-01,-5.507986e-01,-5.072143e-01,-4.687116e-01,-4.220821e-01,-3.860109e-01,-3.350145e-01,-2.989497e-01,-2.512253e-01,-2.083376e-01,-1.686748e-01,-1.299923e-01,-9.183401e-02,-5.348792e-02};

        LMS filt1 = new LMS(mu, leakageFactor, length, LMS.WeightsFillMethod.ZEROS);
        filt1.filter(this.desired2, this.signal2);
        LMS filt2 = new LMS(mu, leakageFactor, weights);
        filt2.filter(this.desired2, this.signal2);

        Assertions.assertArrayEquals(result, filt1.getOutput(), 0.05);
        Assertions.assertArrayEquals(result, filt2.getOutput(), 0.05);
    }
}
