/*
 * Copyright (c) 2019 - 2023  Sambit Paul
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

package com.github.psambit9791.jdsp;


import com.github.psambit9791.jdsp.transform.ContinuousWavelet;
import org.apache.commons.math3.complex.Complex;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

public class TestContinuousWavelet {

    private double[] signal = {1.0003, -0.1876, -0.931 ,  0.5332,  0.7249, -0.8137, -0.4293,
            0.9693,  0.0711, -0.9737,  0.3371,  0.9089, -0.6114, -0.6335,
            0.8421,  0.2268, -1.1182, -0.0832,  0.8464, -0.4692, -0.7236,
            0.9668,  0.9045, -0.5044,  0.1777,  1.1745, -0.3053, -1.3719,
            -0.1669, -0.0787, -1.5103, -0.8144,  1.0282,  0.5865, -0.1208,
            1.309 ,  1.7476, -0.1137, -0.5778,  0.4877, -0.3923, -1.7997,
            -0.6399,  0.5264, -0.5437, -0.6345,  1.094 ,  0.9612, -0.5611,
            0.0504};

    private int[] widths = {1,  2,  3,  4,  5,  6,  7,  8,  9, 10};

    @Test
    public void testRickerWavelet(){
        ContinuousWavelet wR = new ContinuousWavelet(this.signal, this.widths);
        Complex[][] out_cplx = wR.transform(ContinuousWavelet.waveletType.RICKER, 0.0);

        double[][] result = {
                {0.8147 ,0.6726 ,-1.3093 ,-0.4463 ,1.4176 ,-0.0928 ,-1.3902 ,0.6026 ,1.1516 ,-1.0436 ,-0.7593 ,1.3472 ,0.2952 ,-1.3991 ,0.2916 ,1.3317 ,-0.7985 ,-1.1132 ,1.0574 ,0.5064 ,-1.4529 ,-0.0841 ,1.5219 ,-0.2465 ,-1.0065 ,1.1382 ,1.0363 ,-1.2944 ,-0.6678 ,1.05 ,-0.5047 ,-1.7215 ,0.4632 ,1.2609 ,-0.7069 ,-0.292 ,1.8039 ,0.6035 ,-1.3261 ,0.1223 ,0.9933 ,-1.1812 ,-1.4113 ,0.9311 ,0.5677 ,-1.2604 ,0.1376 ,1.6885 ,-0.035 ,-0.8364},
                {0.4576 ,0.1542 ,-0.2044 ,-0.198 ,-0.0341 ,-0.061 ,-0.1071 ,0.0125 ,0.0562 ,-0.0396 ,0.0087 ,0.157 ,0.1191 ,0.0153 ,0.0524 ,0.0093 ,-0.2339 ,-0.3676 ,-0.3052 ,-0.2834 ,-0.2074 ,0.1623 ,0.5885 ,0.7672 ,0.8228 ,0.7782 ,0.3448 ,-0.3907 ,-0.9798 ,-1.3244 ,-1.4952 ,-1.2242 ,-0.4061 ,0.5114 ,1.1972 ,1.6897 ,1.8041 ,1.2687 ,0.3702 ,-0.4247 ,-1.076 ,-1.532 ,-1.4574 ,-0.8853 ,-0.2596 ,0.3053 ,0.8895 ,1.138 ,0.714 ,0.0026},
                {0.2821 ,0.1969 ,0.0581 ,-0.068 ,-0.1379 ,-0.1463 ,-0.1122 ,-0.0578 ,0.0021 ,0.0596 ,0.1062 ,0.1286 ,0.1103 ,0.0385 ,-0.0866 ,-0.2453 ,-0.3956 ,-0.4795 ,-0.4393 ,-0.2398 ,0.1107 ,0.5477 ,0.9554 ,1.1936 ,1.1408 ,0.7412 ,0.0394 ,-0.8129 ,-1.5878 ,-2.0442 ,-2.0054 ,-1.4245 ,-0.4142 ,0.774 ,1.8196 ,2.4296 ,2.4298 ,1.82 ,0.7752 ,-0.4101 ,-1.4132 ,-1.9796 ,-1.9931 ,-1.5025 ,-0.6994 ,0.1472 ,0.7798 ,1.0411 ,0.9285 ,0.5804},
                {0.2238 ,0.1826 ,0.1095 ,0.027 ,-0.0416 ,-0.0795 ,-0.0814 ,-0.0532 ,-0.0092 ,0.0319 ,0.0513 ,0.0342 ,-0.026 ,-0.1243 ,-0.2409 ,-0.3427 ,-0.3885 ,-0.3396 ,-0.1737 ,0.102 ,0.443 ,0.7708 ,0.9873 ,1.001 ,0.7574 ,0.2647 ,-0.3954 ,-1.0778 ,-1.6064 ,-1.821 ,-1.6265 ,-1.0281 ,-0.1403 ,0.8366 ,1.667 ,2.144 ,2.1472 ,1.6777 ,0.8577 ,-0.1047 ,-0.9745 ,-1.5548 ,-1.7382 ,-1.5292 ,-1.0322 ,-0.4114 ,0.1633 ,0.5657 ,0.7418 ,0.7108},
                {0.1934 ,0.1735 ,0.1363 ,0.0905 ,0.0456 ,0.0092 ,-0.0151 ,-0.029 ,-0.0387 ,-0.0523 ,-0.0773 ,-0.1168 ,-0.1672 ,-0.2171 ,-0.249 ,-0.2426 ,-0.181 ,-0.0572 ,0.1204 ,0.3251 ,0.5145 ,0.6374 ,0.6464 ,0.5115 ,0.2326 ,-0.1543 ,-0.5795 ,-0.9518 ,-1.1785 ,-1.1893 ,-0.9568 ,-0.5079 ,0.0779 ,0.6841 ,1.1834 ,1.4683 ,1.4772 ,1.2098 ,0.7265 ,0.133 ,-0.4465 ,-0.899 ,-1.1485 ,-1.1698 ,-0.9891 ,-0.6715 ,-0.3004 ,0.0445 ,0.3048 ,0.4521},
                {0.1831 ,0.1733 ,0.1523 ,0.123 ,0.0865 ,0.0466 ,0.0071 ,-0.0322 ,-0.072 ,-0.1097 ,-0.1428 ,-0.1696 ,-0.1846 ,-0.179 ,-0.1479 ,-0.0896 ,-0.0042 ,0.1014 ,0.2101 ,0.3011 ,0.3543 ,0.3495 ,0.2729 ,0.1267 ,-0.0717 ,-0.2941 ,-0.4992 ,-0.6461 ,-0.6975 ,-0.6302 ,-0.4456 ,-0.1684 ,0.1597 ,0.4827 ,0.7406 ,0.886 ,0.8937 ,0.7611 ,0.5113 ,0.1911 ,-0.1423 ,-0.4357 ,-0.6452 ,-0.7432 ,-0.727 ,-0.6151 ,-0.437 ,-0.2286 ,-0.028 ,0.136},
                {0.1752 ,0.1593 ,0.1404 ,0.1198 ,0.0851 ,0.0439 ,0.011 ,-0.0225 ,-0.0631 ,-0.0947 ,-0.1106 ,-0.1226 ,-0.1253 ,-0.1025 ,-0.0616 ,-0.0168 ,0.0375 ,0.0997 ,0.1452 ,0.1621 ,0.1573 ,0.123 ,0.047 ,-0.054 ,-0.1566 ,-0.2567 ,-0.3275 ,-0.3663 ,-0.3567 ,-0.2824 ,-0.1589 ,-0.0098 ,0.1573 ,0.3213 ,0.4427 ,0.5038 ,0.5075 ,0.4457 ,0.3163 ,0.1488 ,-0.0257 ,-0.1963 ,-0.3427 ,-0.4334 ,-0.4637 ,-0.4478 ,-0.3853 ,-0.2798 ,-0.1605 ,-0.0501},
                {0.1581 ,0.1214 ,0.1018 ,0.0995 ,0.0707 ,0.0365 ,0.0349 ,0.0295 ,-0.0067 ,-0.0295 ,-0.0287 ,-0.0488 ,-0.077 ,-0.0657 ,-0.0389 ,-0.0331 ,-0.0139 ,0.0323 ,0.0521 ,0.0365 ,0.0292 ,0.0157 ,-0.0421 ,-0.107 ,-0.14 ,-0.1741 ,-0.1733 ,-0.1764 ,-0.1663 ,-0.1025 ,-0.0198 ,0.0437 ,0.12 ,0.2131 ,0.2658 ,0.2733 ,0.2774 ,0.2572 ,0.1779 ,0.0814 ,0.0033 ,-0.0899 ,-0.1961 ,-0.2583 ,-0.2788 ,-0.2989 ,-0.2937 ,-0.2327 ,-0.1616 ,-0.1101},
                {0.1334 ,0.0688 ,0.0529 ,0.0815 ,0.0633 ,0.0405 ,0.0836 ,0.112 ,0.0701 ,0.0455 ,0.0543 ,0.0054 ,-0.0708 ,-0.0771 ,-0.0619 ,-0.0922 ,-0.0911 ,-0.0277 ,-0.0053 ,-0.0341 ,-0.0226 ,-0.0038 ,-0.057 ,-0.1117 ,-0.1016 ,-0.1073 ,-0.0652 ,-0.0643 ,-0.0779 ,-0.0212 ,0.0439 ,0.0493 ,0.0737 ,0.146 ,0.1664 ,0.1348 ,0.1441 ,0.1559 ,0.0912 ,0.0211 ,0.0044 ,-0.043 ,-0.1369 ,-0.175 ,-0.1672 ,-0.2008 ,-0.2253 ,-0.1687 ,-0.1112 ,-0.1037},
                {0.1077 ,0.0162 ,0.0089 ,0.0734 ,0.0669 ,0.0552 ,0.1424 ,0.199 ,0.1412 ,0.1061 ,0.1159 ,0.0312 ,-0.0956 ,-0.1134 ,-0.0996 ,-0.1542 ,-0.1551 ,-0.0574 ,-0.0212 ,-0.0578 ,-0.0258 ,0.0196 ,-0.0439 ,-0.1062 ,-0.0708 ,-0.0674 ,0.0018 ,-0.0032 ,-0.0455 ,0.0095 ,0.0719 ,0.0371 ,0.0304 ,0.1049 ,0.1116 ,0.0498 ,0.0662 ,0.1053 ,0.0407 ,-0.024 ,0.0006 ,-0.0193 ,-0.1179 ,-0.1412 ,-0.1039 ,-0.1446 ,-0.1879 ,-0.1182 ,-0.0546 ,-0.0756}
        };

        double[][] out = new double[result.length][result[0].length];
        for (int i=0; i<out_cplx.length; i++) {
            for (int j=0; j<out_cplx[0].length; j++) {
                out[i][j] = out_cplx[i][j].getReal();
            }
        }

        for (int i=0; i<result.length; i++) {
            Assertions.assertArrayEquals(result[i], out[i], 0.001);
        }
    }

    @Test
    public void testMorletCWTWavelet1() {
        ContinuousWavelet wR = new ContinuousWavelet(this.signal, this.widths);
        Complex[][] out_cplx = wR.transform(ContinuousWavelet.waveletType.MORLET, 5.0);

        double[][][] result = {
                {{ -0.5775 ,  -0.3551 }, { -0.4924 ,  0.6865 }, { 0.7473 ,  0.402 }, { 0.2627 ,  -0.7942 }, { -0.8352 ,  -0.1035 }, { 0.0572 ,  0.8351 }, { 0.8225 ,  -0.2095 }, { -0.3574 ,  -0.7612 }, { -0.6862 ,  0.4837 }, { 0.605 ,  0.5623 }, { 0.4323 ,  -0.7154 }, { -0.8135 ,  -0.3114 }, { -0.1873 ,  0.8293 }, { 0.8269 ,  0.0236 }, { -0.1501 ,  -0.7821 }, { -0.7379 ,  0.356 }, { 0.5441 ,  0.7486 }, { 0.7405 ,  -0.5553 }, { -0.5552 ,  -0.5191 }, { -0.2731 ,  0.674 }, { 0.8131 ,  0.0765 }, { -0.081 ,  -0.9873 }, { -1.1064 ,  -0.0235 }, { -0.1011 ,  0.7438 }, { 0.3703 ,  -0.3362 }, { -0.8016 ,  -0.4478 }, { -0.5843 ,  0.9406 }, { 0.9784 ,  0.7277 }, { 0.7734 ,  -0.5374 }, { -0.1494 ,  -0.0047 }, { 0.7496 ,  0.7227 }, { 1.328 ,  -0.5256 }, { -0.1978 ,  -1.2083 }, { -0.9426 ,  0.0257 }, { -0.0196 ,  0.2242 }, { -0.4041 ,  -0.8349 }, { -1.6422 ,  -0.179 }, { -0.7937 ,  1.1697 }, { 0.5857 ,  0.4658 }, { 0.0036 ,  -0.3699 }, { -0.2757 ,  0.6255 }, { 1.1493 ,  0.818 }, { 1.3046 ,  -0.6726 }, { -0.1711 ,  -0.7495 }, { -0.1216 ,  0.4318 }, { 0.7724 ,  -0.0883 }, { -0.2101 ,  -1.0312 }, { -1.2085 ,  0.0364 }, { -0.1368 ,  0.8448 }, { 0.3882 ,  -0.0241 }},
                {{ -0.0446 ,  -0.5392 }, { 0.49 ,  0.2922 }, { -0.4377 ,  0.292 }, { -0.1445 ,  -0.4526 }, { 0.4476 ,  -0.0522 }, { -0.0294 ,  0.4446 }, { -0.43 ,  -0.1109 }, { 0.1891 ,  -0.4024 }, { 0.3592 ,  0.2614 }, { -0.3237 ,  0.3044 }, { -0.2379 ,  -0.3755 }, { 0.4128 ,  -0.1637 }, { 0.0832 ,  0.4368 }, { -0.444 ,  -0.0 }, { 0.0832 ,  -0.4369 }, { 0.4129 ,  0.1637 }, { -0.2379 ,  0.3756 }, { -0.3237 ,  -0.3043 }, { 0.3591 ,  -0.2613 }, { 0.1889 ,  0.4024 }, { -0.4302 ,  0.1106 }, { -0.028 ,  -0.444 }, { 0.4405 ,  0.0555 }, { -0.1371 ,  0.4227 }, { -0.3888 ,  -0.2144 }, { 0.2834 ,  -0.3426 }, { 0.2833 ,  0.3429 }, { -0.3889 ,  0.2147 }, { -0.1373 ,  -0.4225 }, { 0.4401 ,  -0.0554 }, { -0.0284 ,  0.4439 }, { -0.4305 ,  -0.1109 }, { 0.1888 ,  -0.4029 }, { 0.3593 ,  0.2608 }, { -0.3233 ,  0.304 }, { -0.2373 ,  -0.3757 }, { 0.4134 ,  -0.1635 }, { 0.0836 ,  0.4373 }, { -0.4439 ,  0.0006 }, { 0.0829 ,  -0.4363 }, { 0.4123 ,  0.164 }, { -0.2384 ,  0.3754 }, { -0.324 ,  -0.3047 }, { 0.3585 ,  -0.2619 }, { 0.1917 ,  0.4004 }, { -0.4347 ,  0.1229 }, { -0.0406 ,  -0.4894 }, { 0.546 ,  0.1308 }, { -0.4104 ,  0.4445 }, { -0.079 ,  -0.5442 }},
                {{ 0.722 ,  -0.5626 }, { 0.5657 ,  0.9629 }, { -1.1867 ,  0.49 }, { -0.3374 ,  -1.3656 }, { 1.4811 ,  -0.1228 }, { -0.1318 ,  1.5257 }, { -1.5005 ,  -0.4036 }, { 0.6729 ,  -1.4114 }, { 1.2661 ,  0.9238 }, { -1.1442 ,  1.073 }, { -0.8405 ,  -1.3247 }, { 1.4585 ,  -0.5776 }, { 0.2939 ,  1.5407 }, { -1.5686 ,  -0.0004 }, { 0.2944 ,  -1.5413 }, { 1.4593 ,  0.5775 }, { -0.8399 ,  1.3251 }, { -1.1433 ,  -1.0729 }, { 1.2688 ,  -0.9209 }, { 0.6668 ,  1.4204 }, { -1.5213 ,  0.3902 }, { -0.1003 ,  -1.5668 }, { 1.5555 ,  0.1944 }, { -0.4842 ,  1.4893 }, { -1.3725 ,  -0.7579 }, { 1.0034 ,  -1.2092 }, { 1.0034 ,  1.2105 }, { -1.3728 ,  0.7595 }, { -0.4854 ,  -1.4874 }, { 1.5531 ,  -0.193 }, { -0.1037 ,  1.5668 }, { -1.5246 ,  -0.3923 }, { 0.6648 ,  -1.4244 }, { 1.2694 ,  0.9161 }, { -1.1399 ,  1.0691 }, { -0.8347 ,  -1.3264 }, { 1.4645 ,  -0.5757 }, { 0.2977 ,  1.5458 }, { -1.5685 ,  0.006 }, { 0.2905 ,  -1.536 }, { 1.4533 ,  0.5785 }, { -0.8423 ,  1.3232 }, { -1.1472 ,  -1.0679 }, { 1.2446 ,  -0.9299 }, { 0.6826 ,  1.3625 }, { -1.4107 ,  0.4252 }, { -0.1831 ,  -1.3785 }, { 1.2626 ,  0.0184 }, { -0.1602 ,  1.0739 }, { -0.8401 ,  -0.2345 }},
                {{ 0.5158 ,  0.1523 }, { -0.0629 ,  0.5525 }, { -0.5404 ,  0.0152 }, { -0.0629 ,  -0.4908 }, { 0.4216 ,  -0.0723 }, { 0.0474 ,  0.3503 }, { -0.2878 ,  -0.0003 }, { 0.0573 ,  -0.2375 }, { 0.197 ,  0.1123 }, { -0.1583 ,  0.1614 }, { -0.1255 ,  -0.1925 }, { 0.2152 ,  -0.0859 }, { 0.0419 ,  0.2288 }, { -0.2355 ,  -0.004 }, { 0.0477 ,  -0.235 }, { 0.225 ,  0.0866 }, { -0.1212 ,  0.2027 }, { -0.1691 ,  -0.155 }, { 0.1897 ,  -0.1301 }, { 0.0931 ,  0.2213 }, { -0.2412 ,  0.0607 }, { -0.0277 ,  -0.2423 }, { 0.2268 ,  0.0152 }, { -0.0707 ,  0.2064 }, { -0.193 ,  -0.1293 }, { 0.1734 ,  -0.1869 }, { 0.1742 ,  0.1924 }, { -0.1927 ,  0.1378 }, { -0.0753 ,  -0.1947 }, { 0.2139 ,  -0.0048 }, { -0.0479 ,  0.2447 }, { -0.2626 ,  -0.0714 }, { 0.0798 ,  -0.2449 }, { 0.1922 ,  0.1005 }, { -0.1488 ,  0.1306 }, { -0.0892 ,  -0.2115 }, { 0.2571 ,  -0.0755 }, { 0.0686 ,  0.2623 }, { -0.2321 ,  0.0394 }, { 0.0235 ,  -0.1939 }, { 0.172 ,  0.1042 }, { -0.1758 ,  0.1675 }, { -0.1611 ,  -0.2261 }, { 0.2677 ,  -0.1362 }, { 0.0996 ,  0.3243 }, { -0.4045 ,  0.0806 }, { -0.109 ,  -0.4883 }, { 0.5367 ,  -0.1903 }, { 0.2985 ,  0.5173 }, { -0.425 ,  0.3904 }},
                {{ 0.2568 ,  0.102 }, { 0.0364 ,  0.263 }, { -0.1935 ,  0.1481 }, { -0.1967 ,  -0.0834 }, { -0.0213 ,  -0.1781 }, { 0.1154 ,  -0.0872 }, { 0.1044 ,  0.042 }, { 0.0151 ,  0.0839 }, { -0.0454 ,  0.0439 }, { -0.045 ,  -0.0078 }, { -0.0157 ,  -0.0272 }, { 0.0041 ,  -0.0192 }, { 0.0059 ,  -0.0098 }, { 0.006 ,  -0.0112 }, { 0.0157 ,  -0.0116 }, { 0.0257 ,  0.0002 }, { 0.0242 ,  0.0182 }, { 0.0116 ,  0.033 }, { -0.0098 ,  0.0406 }, { -0.0377 ,  0.0334 }, { -0.059 ,  0.005 }, { -0.0568 ,  -0.035 }, { -0.0291 ,  -0.0678 }, { 0.0153 ,  -0.0807 }, { 0.0656 ,  -0.0655 }, { 0.1024 ,  -0.0171 }, { 0.1017 ,  0.0508 }, { 0.0569 ,  0.1075 }, { -0.0152 ,  0.1282 }, { -0.0907 ,  0.1037 }, { -0.1427 ,  0.0352 }, { -0.1438 ,  -0.0575 }, { -0.086 ,  -0.1348 }, { 0.0075 ,  -0.1628 }, { 0.1008 ,  -0.1317 }, { 0.1614 ,  -0.0503 }, { 0.1612 ,  0.0555 }, { 0.0926 ,  0.1388 }, { -0.0102 ,  0.1557 }, { -0.0885 ,  0.105 }, { -0.1073 ,  0.033 }, { -0.0861 ,  -0.0087 }, { -0.0798 ,  -0.0171 }, { -0.1073 ,  -0.0523 }, { -0.0933 ,  -0.1581 }, { 0.0573 ,  -0.2486 }, { 0.2823 ,  -0.1536 }, { 0.3437 ,  0.1444 }, { 0.0975 ,  0.3908 }, { -0.2654 ,  0.3108 }},
                {{ 0.1963 ,  0.0601 }, { 0.0801 ,  0.182 }, { -0.0808 ,  0.1684 }, { -0.1646 ,  0.0432 }, { -0.1228 ,  -0.0873 }, { -0.0085 ,  -0.1296 }, { 0.0819 ,  -0.0733 }, { 0.0908 ,  0.0183 }, { 0.0328 ,  0.0727 }, { -0.0359 ,  0.0622 }, { -0.068 ,  0.0093 }, { -0.0524 ,  -0.045 }, { -0.0067 ,  -0.0718 }, { 0.0441 ,  -0.0634 }, { 0.0804 ,  -0.026 }, { 0.0901 ,  0.0282 }, { 0.0661 ,  0.0841 }, { 0.0088 ,  0.122 }, { -0.0698 ,  0.1215 }, { -0.1439 ,  0.0702 }, { -0.1801 ,  -0.0258 }, { -0.1517 ,  -0.1384 }, { -0.053 ,  -0.2238 }, { 0.0915 ,  -0.2387 }, { 0.2316 ,  -0.1604 }, { 0.308 ,  -0.0021 }, { 0.2771 ,  0.1864 }, { 0.133 ,  0.3337 }, { -0.0837 ,  0.374 }, { -0.2963 ,  0.2767 }, { -0.4203 ,  0.0642 }, { -0.3985 ,  -0.1915 }, { -0.2278 ,  -0.3944 }, { 0.0345 ,  -0.4636 }, { 0.2919 ,  -0.3683 }, { 0.4484 ,  -0.1427 }, { 0.4494 ,  0.1285 }, { 0.3021 ,  0.3491 }, { 0.0649 ,  0.4508 }, { -0.1838 ,  0.4123 }, { -0.3752 ,  0.2526 }, { -0.46 ,  0.0131 }, { -0.4045 ,  -0.2487 }, { -0.1993 ,  -0.4519 }, { 0.1108 ,  -0.5014 }, { 0.4077 ,  -0.3373 }, { 0.5368 ,  -0.0009 }, { 0.404 ,  0.3486 }, { 0.0643 ,  0.5143 }, { -0.2884 ,  0.3974 }},
                {{ 0.1682 ,  0.034 }, { 0.1016 ,  0.1317 }, { -0.0084 ,  0.1558 }, { -0.0978 ,  0.1018 }, { -0.1221 ,  0.0121 }, { -0.0827 ,  -0.0574 }, { -0.0194 ,  -0.0742 }, { 0.0226 ,  -0.0448 }, { 0.0216 ,  -0.0052 }, { -0.0095 ,  0.0071 }, { -0.035 ,  -0.0207 }, { -0.0223 ,  -0.0679 }, { 0.0352 ,  -0.0966 }, { 0.1129 ,  -0.075 }, { 0.1692 ,  0.0054 }, { 0.1641 ,  0.1224 }, { 0.0784 ,  0.2286 }, { -0.0731 ,  0.2702 }, { -0.2418 ,  0.2108 }, { -0.3608 ,  0.0483 }, { -0.369 ,  -0.1782 }, { -0.2353 ,  -0.3927 }, { 0.0205 ,  -0.5064 }, { 0.3239 ,  -0.4532 }, { 0.5665 ,  -0.2209 }, { 0.6448 ,  0.1354 }, { 0.5009 ,  0.5015 }, { 0.1555 ,  0.7408 }, { -0.2907 ,  0.7478 }, { -0.6865 ,  0.4926 }, { -0.8826 ,  0.04 }, { -0.7903 ,  -0.4652 }, { -0.4219 ,  -0.8464 }, { 0.1093 ,  -0.9628 }, { 0.6275 ,  -0.7625 }, { 0.9544 ,  -0.3024 }, { 0.9733 ,  0.2685 }, { 0.6719 ,  0.7592 }, { 0.1474 ,  1.003 }, { -0.4263 ,  0.9153 }, { -0.855 ,  0.5227 }, { -0.9886 ,  -0.0425 }, { -0.7783 ,  -0.5815 }, { -0.3012 ,  -0.8987 }, { 0.2625 ,  -0.8789 }, { 0.6963 ,  -0.5382 }, { 0.8352 ,  -0.0227 }, { 0.6409 ,  0.4509 }, { 0.221 ,  0.6913 }, { -0.2247 ,  0.6235 }},
                {{ 0.1696 ,  0.017 }, { 0.1287 ,  0.1088 }, { 0.0469 ,  0.16 }, { -0.043 ,  0.1575 }, { -0.1148 ,  0.1093 }, { -0.1492 ,  0.037 }, { -0.1425 ,  -0.0354 }, { -0.1095 ,  -0.0928 }, { -0.0643 ,  -0.1333 }, { -0.0061 ,  -0.1586 }, { 0.0677 ,  -0.1639 }, { 0.1493 ,  -0.1366 }, { 0.224 ,  -0.0636 }, { 0.2663 ,  0.059 }, { 0.2382 ,  0.2133 }, { 0.1133 ,  0.3529 }, { -0.0953 ,  0.4164 }, { -0.3357 ,  0.3523 }, { -0.5312 ,  0.1438 }, { -0.5947 ,  -0.1744 }, { -0.462 ,  -0.513 }, { -0.1356 ,  -0.7514 }, { 0.3054 ,  -0.7813 }, { 0.7298 ,  -0.5504 }, { 0.9872 ,  -0.0909 }, { 0.9549 ,  0.4759 }, { 0.6019 ,  0.9704 }, { 0.0002 ,  1.2124 }, { -0.6751 ,  1.0872 }, { -1.2008 ,  0.5966 }, { -1.3899 ,  -0.1305 }, { -1.1535 ,  -0.8742 }, { -0.5342 ,  -1.3906 }, { 0.2891 ,  -1.4957 }, { 1.0532 ,  -1.1349 }, { 1.5079 ,  -0.4095 }, { 1.5022 ,  0.4553 }, { 1.0287 ,  1.1824 }, { 0.2357 ,  1.5348 }, { -0.6137 ,  1.4004 }, { -1.2401 ,  0.8333 }, { -1.4502 ,  0.032 }, { -1.1936 ,  -0.7317 }, { -0.5767 ,  -1.208 }, { 0.1698 ,  -1.2579 }, { 0.7822 ,  -0.9009 }, { 1.0703 ,  -0.2979 }, { 0.9766 ,  0.32 }, { 0.5793 ,  0.7411 }, { 0.0574 ,  0.8488 }},
                {{ 0.1794 ,  0.0366 }, { 0.1418 ,  0.1247 }, { 0.0576 ,  0.188 }, { -0.0538 ,  0.2045 }, { -0.1592 ,  0.1548 }, { -0.2271 ,  0.0538 }, { -0.2394 ,  -0.0659 }, { -0.1875 ,  -0.1842 }, { -0.0733 ,  -0.2761 }, { 0.0815 ,  -0.3013 }, { 0.2402 ,  -0.2397 }, { 0.3628 ,  -0.1033 }, { 0.4092 ,  0.0909 }, { 0.344 ,  0.3125 }, { 0.1576 ,  0.4936 }, { -0.1201 ,  0.5597 }, { -0.4262 ,  0.4724 }, { -0.6747 ,  0.2252 }, { -0.7713 ,  -0.1546 }, { -0.6476 ,  -0.5753 }, { -0.2982 ,  -0.8984 }, { 0.2095 ,  -1.0061 }, { 0.7475 ,  -0.8333 }, { 1.1517 ,  -0.3757 }, { 1.2693 ,  0.2764 }, { 1.0213 ,  0.9369 }, { 0.4347 ,  1.4001 }, { -0.3498 ,  1.5084 }, { -1.1158 ,  1.1847 }, { -1.6273 ,  0.4747 }, { -1.7031 ,  -0.4311 }, { -1.289 ,  -1.2654 }, { -0.4825 ,  -1.7836 }, { 0.4966 ,  -1.8184 }, { 1.365 ,  -1.3296 }, { 1.8594 ,  -0.4498 }, { 1.8272 ,  0.5544 }, { 1.2807 ,  1.3917 }, { 0.3865 ,  1.8271 }, { -0.5881 ,  1.7339 }, { -1.3531 ,  1.1519 }, { -1.6919 ,  0.2853 }, { -1.5331 ,  -0.5922 }, { -0.9616 ,  -1.2343 }, { -0.1772 ,  -1.472 }, { 0.5704 ,  -1.2653 }, { 1.0633 ,  -0.7298 }, { 1.1892 ,  -0.0721 }, { 0.965 ,  0.5058 }, { 0.5085 ,  0.8517 }},
                {{ 0.1533 ,  0.0734 }, { 0.1105 ,  0.1519 }, { 0.0157 ,  0.195 }, { -0.1057 ,  0.1792 }, { -0.1963 ,  0.1022 }, { -0.2353 ,  -0.0174 }, { -0.2209 ,  -0.1531 }, { -0.1281 ,  -0.2686 }, { 0.0406 ,  -0.319 }, { 0.2228 ,  -0.2746 }, { 0.362 ,  -0.135 }, { 0.4318 ,  0.0778 }, { 0.3879 ,  0.3192 }, { 0.1962 ,  0.5189 }, { -0.1003 ,  0.6029 }, { -0.417 ,  0.5254 }, { -0.6848 ,  0.2778 }, { -0.8217 ,  -0.106 }, { -0.7354 ,  -0.5401 }, { -0.4098 ,  -0.901 }, { 0.0784 ,  -1.0714 }, { 0.625 ,  -0.9737 }, { 1.1029 ,  -0.5892 }, { 1.3473 ,  0.0196 }, { 1.2411 ,  0.7077 }, { 0.791 ,  1.2898 }, { 0.0668 ,  1.59 }, { -0.7372 ,  1.4955 }, { -1.4148 ,  0.9989 }, { -1.7903 ,  0.2 }, { -1.723 ,  -0.7094 }, { -1.1885 ,  -1.4855 }, { -0.3289 ,  -1.9095 }, { 0.6305 ,  -1.8585 }, { 1.4597 ,  -1.3339 }, { 1.9348 ,  -0.4628 }, { 1.9054 ,  0.5249 }, { 1.3924 ,  1.3636 }, { 0.5584 ,  1.8382 }, { -0.3852 ,  1.839 }, { -1.2007 ,  1.3814 }, { -1.6619 ,  0.6062 }, { -1.6665 ,  -0.2607 }, { -1.2702 ,  -0.9878 }, { -0.6072 ,  -1.4042 }, { 0.1465 ,  -1.4322 }, { 0.7763 ,  -1.1031 }, { 1.1183 ,  -0.5476 }, { 1.1395 ,  0.0585 }, { 0.8918 ,  0.5565 }}
        };

        double[][][] out = new double[result.length][result[0].length][2];
        for (int i=0; i<out_cplx.length; i++) {
            for (int j=0; j<out_cplx[0].length; j++) {
                out[i][j][0] = out_cplx[i][j].getReal();
                out[i][j][1] = out_cplx[i][j].getImaginary();
            }
        }

        for (int i=0; i<result.length; i++) {
            for (int j=0; j<result[0].length; j++) {
                Assertions.assertArrayEquals(result[i][j], out[i][j], 0.001);
            }
        }

    }


    @Test
    public void testMorletCWTWavelet2() {
        ContinuousWavelet wR = new ContinuousWavelet(this.signal, this.widths);
        Complex[][] out_cplx = wR.transform(ContinuousWavelet.waveletType.MORLET, 8.0);

        double[][][] result = {
                {{ -0.4854 ,  0.5051 }, { -0.5377 ,  -0.7342 }, { 0.8113 ,  -0.4555 }, { 0.2861 ,  0.9088 }, { -0.9155 ,  0.1188 }, { 0.0606 ,  -0.9552 }, { 0.8983 ,  0.2388 }, { -0.3915 ,  0.8687 }, { -0.7485 ,  -0.5566 }, { 0.6686 ,  -0.6473 }, { 0.484 ,  0.815 }, { -0.8765 ,  0.3556 }, { -0.1921 ,  -0.9445 }, { 0.9106 ,  -0.0165 }, { -0.1727 ,  0.9112 }, { -0.8357 ,  -0.388 }, { 0.547 ,  -0.8405 }, { 0.7485 ,  0.6399 }, { -0.6669 ,  0.5798 }, { -0.3333 ,  -0.8069 }, { 0.9035 ,  -0.1419 }, { -0.0113 ,  1.0684 }, { -1.0706 ,  -0.0222 }, { 0.0695 ,  -0.8674 }, { 0.5816 ,  0.4162 }, { -0.7601 ,  0.5952 }, { -0.6327 ,  -0.9549 }, { 0.9386 ,  -0.7025 }, { 0.5842 ,  0.7156 }, { -0.5053 ,  0.0416 }, { 0.4815 ,  -0.8757 }, { 1.2106 ,  0.4708 }, { -0.2873 ,  1.1994 }, { -0.8974 ,  -0.2166 }, { 0.2943 ,  -0.3959 }, { -0.02 ,  0.9036 }, { -1.3749 ,  0.2563 }, { -0.5528 ,  -1.1986 }, { 0.775 ,  -0.3457 }, { -0.0669 ,  0.6058 }, { -0.5443 ,  -0.585 }, { 0.9188 ,  -0.8868 }, { 1.0858 ,  0.7332 }, { -0.4494 ,  0.7565 }, { -0.2652 ,  -0.624 }, { 0.852 ,  -0.0201 }, { -0.1127 ,  1.0966 }, { -1.144 ,  -0.0747 }, { 0.0545 ,  -0.9196 }, { 0.4348 ,  0.2137 }},
                {{ -0.0588 ,  -0.6488 }, { -0.6456 ,  0.412 }, { 0.6456 ,  0.47 }, { 0.2717 ,  -0.7414 }, { -0.7699 ,  -0.1031 }, { 0.0476 ,  0.7696 }, { 0.7451 ,  -0.1913 }, { -0.3274 ,  -0.6958 }, { -0.622 ,  0.452 }, { 0.5606 ,  0.5264 }, { 0.412 ,  -0.6494 }, { -0.7149 ,  -0.2832 }, { -0.1441 ,  0.7552 }, { 0.7687 ,  -0.0001 }, { -0.1443 ,  -0.7554 }, { -0.7151 ,  0.2833 }, { 0.4119 ,  0.6496 }, { 0.5606 ,  -0.526 }, { -0.6216 ,  -0.4516 }, { -0.3267 ,  0.6959 }, { 0.7455 ,  0.1909 }, { 0.0488 ,  -0.7683 }, { -0.7628 ,  0.0953 }, { 0.2369 ,  0.7303 }, { 0.6724 ,  -0.371 }, { -0.4917 ,  -0.5922 }, { -0.4914 ,  0.5938 }, { 0.6733 ,  0.3725 }, { 0.2384 ,  -0.7293 }, { -0.7609 ,  -0.095 }, { 0.0508 ,  0.7676 }, { 0.7471 ,  -0.1926 }, { -0.3261 ,  -0.6983 }, { -0.6224 ,  0.4491 }, { 0.5586 ,  0.5241 }, { 0.4091 ,  -0.6501 }, { -0.7178 ,  -0.2822 }, { -0.146 ,  0.7577 }, { 0.7685 ,  0.0029 }, { -0.1428 ,  -0.7528 }, { -0.7125 ,  0.2845 }, { 0.4145 ,  0.6492 }, { 0.5625 ,  -0.5278 }, { -0.6213 ,  -0.4546 }, { -0.3298 ,  0.6961 }, { 0.757 ,  0.1899 }, { 0.0154 ,  -0.8045 }, { -0.7883 ,  0.2284 }, { 0.495 ,  0.5976 }, { 0.2234 ,  -0.5941 }},
                {{ -0.111 ,  -0.2962 }, { 0.2372 ,  0.1506 }, { -0.2093 ,  0.0279 }, { 0.0786 ,  -0.1006 }, { 0.0143 ,  0.0513 }, { -0.0061 ,  0.0096 }, { -0.0306 ,  0.0007 }, { 0.0122 ,  -0.0382 }, { 0.0343 ,  0.0232 }, { -0.0297 ,  0.0278 }, { -0.0215 ,  -0.034 }, { 0.0373 ,  -0.0147 }, { 0.0075 ,  0.0394 }, { -0.0401 ,  -0.0 }, { 0.0075 ,  -0.0394 }, { 0.0373 ,  0.0148 }, { -0.0215 ,  0.0339 }, { -0.0292 ,  -0.0275 }, { 0.0325 ,  -0.0236 }, { 0.0171 ,  0.0363 }, { -0.0389 ,  0.01 }, { -0.0025 ,  -0.04 }, { 0.0398 ,  0.005 }, { -0.0124 ,  0.0382 }, { -0.0352 ,  -0.0193 }, { 0.0256 ,  -0.0309 }, { 0.0256 ,  0.0309 }, { -0.0352 ,  0.0193 }, { -0.0124 ,  -0.0381 }, { 0.0398 ,  -0.005 }, { -0.0025 ,  0.04 }, { -0.0389 ,  -0.01 }, { 0.0171 ,  -0.0363 }, { 0.0325 ,  0.0236 }, { -0.0292 ,  0.0275 }, { -0.0215 ,  -0.0339 }, { 0.0373 ,  -0.0148 }, { 0.0075 ,  0.0394 }, { -0.0401 ,  0.0001 }, { 0.0073 ,  -0.0396 }, { 0.0383 ,  0.015 }, { -0.0245 ,  0.0346 }, { -0.023 ,  -0.0332 }, { 0.0258 ,  -0.0042 }, { 0.0096 ,  -0.007 }, { 0.0141 ,  0.0753 }, { -0.136 ,  -0.0915 }, { 0.2528 ,  -0.0305 }, { -0.2301 ,  0.2272 }, { 0.0606 ,  -0.3447 }},
                {{ 0.0396 ,  -0.8628 }, { 0.9168 ,  0.3635 }, { -0.692 ,  0.8347 }, { -0.6348 ,  -0.9633 }, { 1.1394 ,  -0.3609 }, { 0.0622 ,  1.2123 }, { -1.1961 ,  -0.2239 }, { 0.4772 ,  -1.1135 }, { 0.9851 ,  0.6912 }, { -0.8664 ,  0.8246 }, { -0.6403 ,  -1.004 }, { 1.1039 ,  -0.4377 }, { 0.2222 ,  1.1648 }, { -1.1849 ,  -0.0001 }, { 0.2221 ,  -1.1636 }, { 1.1013 ,  0.4361 }, { -0.6347 ,  1.0 }, { -0.8634 ,  -0.8108 }, { 0.9582 ,  -0.6962 }, { 0.5043 ,  1.0717 }, { -1.1472 ,  0.2945 }, { -0.0744 ,  -1.1821 }, { 1.1751 ,  0.1484 }, { -0.366 ,  1.1264 }, { -1.0379 ,  -0.5706 }, { 0.755 ,  -0.9126 }, { 0.755 ,  0.9126 }, { -1.0379 ,  0.5706 }, { -0.366 ,  -1.1264 }, { 1.1751 ,  -0.1484 }, { -0.0744 ,  1.1821 }, { -1.1472 ,  -0.2945 }, { 0.5043 ,  -1.0717 }, { 0.9582 ,  0.6962 }, { -0.8634 ,  0.8109 }, { -0.6349 ,  -1.0001 }, { 1.1017 ,  -0.4365 }, { 0.2225 ,  1.1649 }, { -1.188 ,  -0.0003 }, { 0.2257 ,  -1.1704 }, { 1.1111 ,  0.4487 }, { -0.6647 ,  1.0077 }, { -0.8546 ,  -0.8663 }, { 1.0396 ,  -0.6451 }, { 0.3772 ,  1.1607 }, { -1.1982 ,  0.063 }, { 0.2636 ,  -1.1238 }, { 0.9289 ,  0.5493 }, { -0.7364 ,  0.6383 }, { -0.3093 ,  -0.7871 }},
                {{ 0.9739 ,  -0.2974 }, { 0.2362 ,  1.1236 }, { -1.2555 ,  0.1382 }, { -0.0038 ,  -1.359 }, { 1.4245 ,  0.1631 }, { -0.3556 ,  1.4446 }, { -1.4145 ,  -0.5639 }, { 0.7769 ,  -1.3326 }, { 1.2002 ,  0.9824 }, { -1.1689 ,  1.0214 }, { -0.8028 ,  -1.3256 }, { 1.4437 ,  -0.5525 }, { 0.28 ,  1.5162 }, { -1.5386 ,  -0.0042 }, { 0.2896 ,  -1.5087 }, { 1.4267 ,  0.5656 }, { -0.822 ,  1.295 }, { -1.1178 ,  -1.0497 }, { 1.2403 ,  -0.9012 }, { 0.6527 ,  1.3871 }, { -1.4848 ,  0.3812 }, { -0.0963 ,  -1.5299 }, { 1.5208 ,  0.1921 }, { -0.4737 ,  1.4579 }, { -1.3433 ,  -0.7385 }, { 0.9771 ,  -1.1811 }, { 0.9771 ,  1.1811 }, { -1.3433 ,  0.7385 }, { -0.4737 ,  -1.4579 }, { 1.5208 ,  -0.1921 }, { -0.0963 ,  1.53 }, { -1.485 ,  -0.3813 }, { 0.6528 ,  -1.3875 }, { 1.2411 ,  0.9014 }, { -1.1183 ,  1.0512 }, { -0.8249 ,  -1.296 }, { 1.4288 ,  -0.5708 }, { 0.2986 ,  1.5125 }, { -1.5453 ,  0.0192 }, { 0.256 ,  -1.5277 }, { 1.4627 ,  0.5157 }, { -0.7487 ,  1.3555 }, { -1.2139 ,  -0.945 }, { 1.0965 ,  -1.0473 }, { 0.8665 ,  1.1976 }, { -1.2459 ,  0.6825 }, { -0.5059 ,  -1.2424 }, { 1.1919 ,  -0.3459 }, { 0.2091 ,  1.1022 }, { -0.9833 ,  0.0996 }},
                {{ 0.4353 ,  0.2048 }, { -0.1389 ,  0.4616 }, { -0.4618 ,  -0.0722 }, { 0.0129 ,  -0.4374 }, { 0.3934 ,  -0.0323 }, { 0.0596 ,  0.3364 }, { -0.2739 ,  0.0687 }, { -0.062 ,  -0.2122 }, { 0.1561 ,  -0.0436 }, { 0.0186 ,  0.1082 }, { -0.069 ,  -0.0081 }, { 0.0327 ,  -0.0378 }, { 0.0131 ,  0.0525 }, { -0.0662 ,  -0.007 }, { 0.024 ,  -0.0735 }, { 0.0747 ,  0.0389 }, { -0.0521 ,  0.0709 }, { -0.0628 ,  -0.0636 }, { 0.0733 ,  -0.0514 }, { 0.0376 ,  0.0808 }, { -0.0858 ,  0.0221 }, { -0.0057 ,  -0.088 }, { 0.0873 ,  0.011 }, { -0.0273 ,  0.0837 }, { -0.0772 ,  -0.0425 }, { 0.0561 ,  -0.068 }, { 0.0562 ,  0.0677 }, { -0.0771 ,  0.0423 }, { -0.027 ,  -0.0839 }, { 0.088 ,  -0.0109 }, { -0.0052 ,  0.0891 }, { -0.0873 ,  -0.0207 }, { 0.0346 ,  -0.0823 }, { 0.0744 ,  0.0463 }, { -0.0548 ,  0.0633 }, { -0.0489 ,  -0.0591 }, { 0.0584 ,  -0.0302 }, { 0.0061 ,  0.0528 }, { -0.0432 ,  -0.025 }, { 0.0645 ,  -0.0317 }, { 0.0218 ,  0.1127 }, { -0.1688 ,  0.0177 }, { -0.0241 ,  -0.2299 }, { 0.2912 ,  -0.0446 }, { 0.0813 ,  0.3461 }, { -0.3874 ,  0.1336 }, { -0.1976 ,  -0.4077 }, { 0.4023 ,  -0.2662 }, { 0.3307 ,  0.3694 }, { -0.3115 ,  0.3816 }},
                {{ 0.2479 ,  0.1127 }, { -0.0089 ,  0.2667 }, { -0.2391 ,  0.0907 }, { -0.1642 ,  -0.1739 }, { 0.089 ,  -0.2002 }, { 0.1962 ,  0.0045 }, { 0.0634 ,  0.1603 }, { -0.1052 ,  0.1037 }, { -0.1151 ,  -0.0476 }, { -0.0014 ,  -0.1028 }, { 0.0761 ,  -0.0341 }, { 0.0484 ,  0.0444 }, { -0.0173 ,  0.048 }, { -0.0387 ,  0.0024 }, { -0.0127 ,  -0.0255 }, { 0.013 ,  -0.0155 }, { 0.0132 ,  0.0042 }, { 0.0014 ,  0.0092 }, { -0.0045 ,  0.0031 }, { -0.0028 ,  -0.0017 }, { 0.0006 ,  -0.0017 }, { 0.0016 ,  0.0003 }, { -0.0003 ,  0.0017 }, { -0.0025 ,  0.0005 }, { -0.0017 ,  -0.0021 }, { 0.0008 ,  -0.0027 }, { 0.0029 ,  -0.0006 }, { 0.0019 ,  0.0016 }, { -0.0005 ,  0.0017 }, { -0.0012 ,  0.0 }, { 0.001 ,  -0.0013 }, { 0.0037 ,  0.0015 }, { 0.0 ,  0.0081 }, { -0.0124 ,  0.0067 }, { -0.0178 ,  -0.0128 }, { 0.0051 ,  -0.0315 }, { 0.0421 ,  -0.0121 }, { 0.0381 ,  0.0437 }, { -0.0306 ,  0.0673 }, { -0.0927 ,  -0.0006 }, { -0.0449 ,  -0.1041 }, { 0.0939 ,  -0.0995 }, { 0.1519 ,  0.0556 }, { 0.0095 ,  0.1882 }, { -0.1936 ,  0.0941 }, { -0.1816 ,  -0.1586 }, { 0.0818 ,  -0.2513 }, { 0.2821 ,  -0.0247 }, { 0.1404 ,  0.2613 }, { -0.1885 ,  0.2373 }},
                {{ 0.1923 ,  0.0741 }, { 0.0393 ,  0.2003 }, { -0.145 ,  0.1341 }, { -0.1836 ,  -0.0519 }, { -0.0494 ,  -0.173 }, { 0.1127 ,  -0.1234 }, { 0.1476 ,  0.0267 }, { 0.0476 ,  0.1238 }, { -0.069 ,  0.0936 }, { -0.0988 ,  -0.0072 }, { -0.0394 ,  -0.0736 }, { 0.0362 ,  -0.0583 }, { 0.0587 ,  0.0028 }, { 0.0219 ,  0.043 }, { -0.0231 ,  0.0324 }, { -0.0322 ,  -0.0038 }, { -0.0104 ,  -0.026 }, { 0.0122 ,  -0.0213 }, { 0.0205 ,  -0.0028 }, { 0.0146 ,  0.013 }, { -0.0004 ,  0.0176 }, { -0.0133 ,  0.011 }, { -0.0148 ,  -0.0 }, { -0.0094 ,  -0.0082 }, { -0.0038 ,  -0.0124 }, { 0.0044 ,  -0.0131 }, { 0.0109 ,  -0.0095 }, { 0.0177 ,  -0.0004 }, { 0.0176 ,  0.014 }, { 0.0026 ,  0.0255 }, { -0.0196 ,  0.0229 }, { -0.0335 ,  0.0027 }, { -0.0276 ,  -0.027 }, { 0.0026 ,  -0.0449 }, { 0.0427 ,  -0.0272 }, { 0.0531 ,  0.0232 }, { 0.0084 ,  0.0625 }, { -0.0564 ,  0.042 }, { -0.0706 ,  -0.0318 }, { -0.0052 ,  -0.088 }, { 0.0858 ,  -0.0548 }, { 0.1045 ,  0.0572 }, { 0.004 ,  0.1401 }, { -0.1373 ,  0.0856 }, { -0.1655 ,  -0.0839 }, { -0.0169 ,  -0.2056 }, { 0.1812 ,  -0.1356 }, { 0.2257 ,  0.0841 }, { 0.0535 ,  0.2469 }, { -0.1822 ,  0.1859 }},
                {{ 0.1739 ,  0.0543 }, { 0.0604 ,  0.1682 }, { -0.0908 ,  0.1506 }, { -0.1617 ,  0.025 }, { -0.1148 ,  -0.1029 }, { 0.0054 ,  -0.1431 }, { 0.1111 ,  -0.0787 }, { 0.1239 ,  0.0326 }, { 0.0436 ,  0.1027 }, { -0.0481 ,  0.085 }, { -0.0804 ,  0.0128 }, { -0.0548 ,  -0.0465 }, { -0.0076 ,  -0.0592 }, { 0.0306 ,  -0.0347 }, { 0.0366 ,  0.0004 }, { 0.0131 ,  0.0191 }, { -0.0042 ,  0.0121 }, { 0.0049 ,  -0.0005 }, { 0.0172 ,  0.0049 }, { 0.0112 ,  0.0227 }, { -0.0061 ,  0.0318 }, { -0.0271 ,  0.0237 }, { -0.047 ,  -0.0011 }, { -0.0438 ,  -0.0367 }, { -0.006 ,  -0.0622 }, { 0.0398 ,  -0.0546 }, { 0.0739 ,  -0.0123 }, { 0.0651 ,  0.0403 }, { 0.0194 ,  0.0726 }, { -0.0318 ,  0.0704 }, { -0.0685 ,  0.0329 }, { -0.074 ,  -0.0246 }, { -0.036 ,  -0.0651 }, { 0.0198 ,  -0.0608 }, { 0.0455 ,  -0.0258 }, { 0.0334 ,  0.0044 }, { 0.0158 ,  0.0116 }, { 0.0144 ,  0.0028 }, { 0.0281 ,  0.0009 }, { 0.0415 ,  0.0307 }, { 0.0187 ,  0.0821 }, { -0.0613 ,  0.0965 }, { -0.1458 ,  0.0243 }, { -0.1409 ,  -0.1059 }, { -0.0187 ,  -0.1992 }, { 0.1477 ,  -0.1692 }, { 0.2433 ,  -0.0073 }, { 0.1837 ,  0.1918 }, { -0.019 ,  0.2789 }, { -0.2289 ,  0.1719 }},
                {{ 0.1416 ,  0.0652 }, { 0.0561 ,  0.1408 }, { -0.0678 ,  0.1377 }, { -0.1581 ,  0.0534 }, { -0.1502 ,  -0.0787 }, { -0.0474 ,  -0.1651 }, { 0.0754 ,  -0.139 }, { 0.1449 ,  -0.037 }, { 0.1353 ,  0.0679 }, { 0.056 ,  0.1374 }, { -0.0515 ,  0.1409 }, { -0.122 ,  0.0629 }, { -0.1189 ,  -0.0437 }, { -0.0624 ,  -0.1061 }, { 0.0116 ,  -0.115 }, { 0.0802 ,  -0.0894 }, { 0.1165 ,  -0.0245 }, { 0.0993 ,  0.0617 }, { 0.0413 ,  0.1148 }, { -0.0295 ,  0.1165 }, { -0.0982 ,  0.0867 }, { -0.1432 ,  0.0209 }, { -0.1301 ,  -0.08 }, { -0.0535 ,  -0.1585 }, { 0.0519 ,  -0.1634 }, { 0.1473 ,  -0.1045 }, { 0.1883 ,  -0.0033 }, { 0.1573 ,  0.1195 }, { 0.054 ,  0.205 }, { -0.0823 ,  0.1934 }, { -0.1836 ,  0.1014 }, { -0.2106 ,  -0.017 }, { -0.164 ,  -0.1353 }, { -0.0568 ,  -0.2194 }, { 0.0817 ,  -0.2159 }, { 0.1955 ,  -0.124 }, { 0.2392 ,  0.0048 }, { 0.2028 ,  0.1392 }, { 0.0892 ,  0.2526 }, { -0.0831 ,  0.2778 }, { -0.2484 ,  0.1723 }, { -0.3196 ,  -0.0181 }, { -0.2525 ,  -0.2135 }, { -0.0635 ,  -0.3428 }, { 0.1795 ,  -0.3255 }, { 0.3597 ,  -0.1291 }, { 0.3639 ,  0.1484 }, { 0.1769 ,  0.3457 }, { -0.0988 ,  0.3689 }, { -0.3193 ,  0.2121 }}
        };

        double[][][] out = new double[result.length][result[0].length][2];
        for (int i=0; i<out_cplx.length; i++) {
            for (int j=0; j<out_cplx[0].length; j++) {
                out[i][j][0] = out_cplx[i][j].getReal();
                out[i][j][1] = out_cplx[i][j].getImaginary();
            }
        }

        for (int i=0; i<result.length; i++) {
            for (int j=0; j<result[0].length; j++) {
                Assertions.assertArrayEquals(result[i][j], out[i][j], 0.001);
            }
        }

    }

    @Test
    public void testPaulWavelet1() {
        ContinuousWavelet wR = new ContinuousWavelet(this.signal, this.widths);
        Complex[][] out_cplx = wR.transform(ContinuousWavelet.waveletType.PAUL, 4.0);

        double[][][] result = {
                {{ -0.427574067 ,  -0.466169535 }, { -0.347068167 ,  0.487716644 }, { 0.490731218 ,  0.312963228 }, { 0.174218774 ,  -0.617200196 }, { -0.549104863 ,  -0.0809444151 }, { 0.0385782458 ,  0.648648783 }, { 0.542335694 ,  -0.16185219 }, { -0.235508287 ,  -0.588994218 }, { -0.453468773 ,  0.379714076 }, { 0.394902333 ,  0.441772076 }, { 0.279211245 ,  -0.551530862 }, { -0.542239108 ,  -0.24075336 }, { -0.128798539 ,  0.639721783 }, { 0.543073785 ,  0.00611317964 }, { -0.0930804125 ,  -0.627200976 }, { -0.470753953 ,  0.253332124 }, { 0.382676474 ,  0.561885753 }, { 0.51713049 ,  -0.438046379 }, { -0.338882222 ,  -0.387792684 }, { -0.166573388 ,  0.565650228 }, { 0.524746585 ,  0.124220391 }, { -0.0945072326 ,  -0.693430232 }, { -0.798495868 ,  0.0419252351 }, { -0.153262756 ,  0.599625155 }, { 0.161762031 ,  -0.29704578 }, { -0.579293116 ,  -0.445941168 }, { -0.382172381 ,  0.586028161 }, { 0.713014545 ,  0.408765192 }, { 0.638446513 ,  -0.540026891 }, { 0.0663166124 ,  -0.0489529273 }, { 0.654452779 ,  0.618571881 }, { 0.987760982 ,  -0.252704375 }, { -0.0996395059 ,  -0.71954067 }, { -0.687339263 ,  0.245029293 }, { -0.165278002 ,  0.342044634 }, { -0.468567422 ,  -0.586604781 }, { -1.28392035 ,  -0.201113205 }, { -0.675067121 ,  0.740880615 }, { 0.319063573 ,  0.136848779 }, { 0.0329874405 ,  -0.50649821 }, { -0.0683454768 ,  0.330299856 }, { 0.917615066 ,  0.578387112 }, { 1.02379968 ,  -0.477218054 }, { 0.0164553547 ,  -0.459742881 }, { -0.0113694807 ,  0.492082138 }, { 0.51129084 ,  0.076137698 }, { -0.190245392 ,  -0.702802659 }, { -0.879385918 ,  0.0657549107 }, { -0.160218545 ,  0.6331433 }, { 0.23187304 ,  -0.33339467 }},
                {{ 0.293354239 ,  -0.673339781 }, { 0.406335476 ,  0.763242061 }, { -0.65277686 ,  0.483735988 }, { -0.22435064 ,  -1.01828769 }, { 0.746337336 ,  -0.134048316 }, { -0.0453646422 ,  1.06202535 }, { -0.724733906 ,  -0.26381129 }, { 0.317864615 ,  -0.962079419 }, { 0.60396096 ,  0.624233278 }, { -0.547446719 ,  0.725585438 }, { -0.402291541 ,  -0.901617038 }, { 0.696189747 ,  -0.395473328 }, { 0.143065537 ,  1.04208063 }, { -0.742924005 ,  0.000908495713 }, { 0.147382321 ,  -1.03858901 }, { 0.702547819 ,  0.402949247 }, { -0.397612497 ,  0.912674021 }, { -0.548213717 ,  -0.714598527 }, { 0.59544227 ,  -0.619214667 }, { 0.302537855 ,  0.954939806 }, { -0.742960395 ,  0.241413487 }, { -0.0609219273 ,  -1.09716662 }, { 0.738904012 ,  0.0940495317 }, { -0.220791635 ,  0.982367948 }, { -0.632219243 ,  -0.517488119 }, { 0.507593846 ,  -0.792316811 }, { 0.504667832 ,  0.877024249 }, { -0.641378607 ,  0.58685304 }, { -0.236612686 ,  -0.942463819 }, { 0.717568993 ,  -0.0942340396 }, { -0.0837651414 ,  1.05311375 }, { -0.76070007 ,  -0.323099287 }, { 0.296976871 ,  -1.05706869 }, { 0.606364348 ,  0.521908053 }, { -0.521994808 ,  0.648753767 }, { -0.363406521 ,  -0.927600795 }, { 0.733422869 ,  -0.36183429 }, { 0.163783916 ,  1.1239134 }, { -0.74746928 ,  0.103197624 }, { 0.118564397 ,  -0.949864728 }, { 0.659995886 ,  0.450117253 }, { -0.438041019 ,  0.906374291 }, { -0.57087808 ,  -0.766890878 }, { 0.59955357 ,  -0.694031432 }, { 0.331822211 ,  0.887707841 }, { -0.700092783 ,  0.206117745 }, { -0.0221781224 ,  -1.09298159 }, { 0.757869061 ,  0.118722718 }, { -0.193891304 ,  0.972468557 }, { -0.383685458 ,  -0.458782473 }},
                {{ 0.569067732 ,  -0.381074123 }, { 0.437536848 ,  0.801476787 }, { -0.899754861 ,  0.422488014 }, { -0.301388352 ,  -0.963518695 }, { 0.955735943 ,  -0.135209218 }, { -0.0567198539 ,  0.974168395 }, { -0.928268362 ,  -0.243784755 }, { 0.404827138 ,  -0.887205098 }, { 0.770983456 ,  0.571316606 }, { -0.701033056 ,  0.66210863 }, { -0.511141119 ,  -0.838236384 }, { 0.900804082 ,  -0.372059318 }, { 0.197824476 ,  0.955518696 }, { -0.934487743 ,  0.00481018687 }, { 0.201610473 ,  -0.941736813 }, { 0.901312219 ,  0.395758575 }, { -0.524961664 ,  0.870217515 }, { -0.737580781 ,  -0.632587235 }, { 0.712003575 ,  -0.561201288 }, { 0.335302095 ,  0.861634825 }, { -0.985976472 ,  0.174740797 }, { -0.075875233 ,  -1.08038514 }, { 0.996978438 ,  0.0122957259 }, { -0.185808948 ,  0.851771207 }, { -0.687184995 ,  -0.482956101 }, { 0.76222892 ,  -0.675947207 }, { 0.707904001 ,  0.91607859 }, { -0.841624692 ,  0.677810485 }, { -0.414434513 ,  -0.742637039 }, { 0.73707156 ,  -0.0175370626 }, { -0.311446868 ,  0.952763382 }, { -1.13928163 ,  -0.40462636 }, { 0.308895518 ,  -1.14440251 }, { 0.827773829 ,  0.295377631 }, { -0.503291561 ,  0.455597476 }, { -0.232160846 ,  -0.907062125 }, { 1.17206396 ,  -0.280069501 }, { 0.37455858 ,  1.17671635 }, { -0.905905914 ,  0.280221344 }, { 0.0800873776 ,  -0.703427327 }, { 0.679136829 ,  0.521671479 }, { -0.765699094 ,  0.851181214 }, { -0.913697661 ,  -0.776055933 }, { 0.65417264 ,  -0.765692965 }, { 0.401740185 ,  0.675778831 }, { -0.836386795 ,  0.0706199128 }, { 0.0915775609 ,  -1.08379794 }, { 1.14250295 ,  0.079688123 }, { -0.0185434077 ,  0.994829944 }, { -0.598925809 ,  -0.0102998828 }},
                {{ 0.561046358 ,  -0.11228429 }, { 0.250986262 ,  0.660242381 }, { -0.658910469 ,  0.301855078 }, { -0.239942237 ,  -0.617109643 }, { 0.589952673 ,  -0.105166923 }, { -0.0410646182 ,  0.592716918 }, { -0.592376096 ,  -0.160086029 }, { 0.253228205 ,  -0.56007041 }, { 0.486469765 ,  0.344182894 }, { -0.443377792 ,  0.396954173 }, { -0.314436576 ,  -0.53743915 }, { 0.592133313 ,  -0.243110427 }, { 0.154751884 ,  0.594238169 }, { -0.561453793 ,  0.0212670146 }, { 0.150703563 ,  -0.546175457 }, { 0.571844064 ,  0.302353145 }, { -0.367511868 ,  0.600073012 }, { -0.539121544 ,  -0.353594247 }, { 0.355003791 ,  -0.351481483 }, { 0.115587145 ,  0.474732146 }, { -0.687523966 ,  -0.0114418229 }, { -0.0395808282 ,  -0.828719892 }, { 0.731833091 ,  -0.141997018 }, { 0.0646985486 ,  0.441485353 }, { -0.209460361 ,  -0.28025248 }, { 0.688956849 ,  -0.271194836 }, { 0.559895179 ,  0.827990683 }, { -0.573647882 ,  0.726118238 }, { -0.467075089 ,  -0.201267048 }, { 0.138311196 ,  0.115958676 }, { -0.565711757 ,  0.527689579 }, { -1.01978401 ,  -0.509945336 }, { 0.0683533225 ,  -1.10179622 }, { 0.617500112 ,  -0.22869588 }, { -0.0242908889 ,  -0.0286709518 }, { 0.268931328 ,  -0.680221421 }, { 1.16020067 ,  -0.0582156865 }, { 0.532706654 ,  1.04399067 }, { -0.483333267 ,  0.5866687 }, { -0.0776367336 ,  -0.0479180787 }, { 0.133218005 ,  0.58197276 }, { -0.855762342 ,  0.592811328 }, { -0.91172951 ,  -0.612948344 }, { 0.208944241 ,  -0.743845523 }, { 0.216092655 ,  0.102897486 }, { -0.408978336 ,  -0.23583878 }, { 0.304062428 ,  -0.847847617 }, { 1.04345521 ,  0.046097062 }, { 0.246110876 ,  0.864861314 }, { -0.466822919 ,  0.348431453 }},
                {{ 0.449317056 ,  0.0238499878 }, { 0.150330045 ,  0.470526744 }, { -0.380121809 ,  0.2325621 }, { -0.185530386 ,  -0.274797652 }, { 0.233547249 ,  -0.0651720669 }, { -0.0420509446 ,  0.258030087 }, { -0.291636393 ,  -0.0939628888 }, { 0.110929757 ,  -0.282383513 }, { 0.226731827 ,  0.139075637 }, { -0.200477759 ,  0.16127216 }, { -0.125789997 ,  -0.275212863 }, { 0.315778398 ,  -0.12599275 }, { 0.120317746 ,  0.288732392 }, { -0.219109597 ,  0.0493721897 }, { 0.0944622887 ,  -0.186942237 }, { 0.251468269 ,  0.230082476 }, { -0.244780137 ,  0.363882429 }, { -0.378297674 ,  -0.123610717 }, { 0.0126699524 ,  -0.195419737 }, { -0.0854423896 ,  0.100907714 }, { -0.393664207 ,  -0.210573915 }, { 0.0296777933 ,  -0.635398642 }, { 0.533565392 ,  -0.283132314 }, { 0.339542854 ,  0.102639316 }, { 0.260687928 ,  -0.0587984009 }, { 0.628701006 ,  0.143637784 }, { 0.403060645 ,  0.815660651 }, { -0.372572353 ,  0.820124778 }, { -0.576315129 ,  0.29664628 }, { -0.475460486 ,  0.223113522 }, { -0.850685612 ,  0.112752454 }, { -0.937450887 ,  -0.671696363 }, { -0.151605798 ,  -1.14555196 }, { 0.45363244 ,  -0.760966843 }, { 0.468676734 ,  -0.504001503 }, { 0.794903158 ,  -0.501222625 }, { 1.21379926 ,  0.154131888 }, { 0.73001246 ,  0.980163107 }, { -0.0649654033 ,  0.928119732 }, { -0.221647232 ,  0.604121555 }, { -0.397037706 ,  0.702650862 }, { -0.988793824 ,  0.408351191 }, { -0.969814996 ,  -0.464916962 }, { -0.255085341 ,  -0.753930358 }, { 0.0123828124 ,  -0.450079301 }, { -0.0171040745 ,  -0.556788613 }, { 0.516691623 ,  -0.664358782 }, { 0.934008993 ,  0.028318917 }, { 0.422067643 ,  0.690792455 }, { -0.228561814 ,  0.517494283 }},
                {{ 0.346171692 ,  0.0645988053 }, { 0.124682341 ,  0.327534463 }, { -0.188094316 ,  0.209067814 }, { -0.148237125 ,  -0.0562912909 }, { 0.0259151488 ,  -0.0226005296 }, { -0.0608243758 ,  0.0817054202 }, { -0.141017944 ,  -0.0644738457 }, { 0.0300826395 ,  -0.142683331 }, { 0.0891060593 ,  0.0191671087 }, { -0.0611827256 ,  0.0285440149 }, { -0.012673979 ,  -0.133600409 }, { 0.176827016 ,  -0.0550396961 }, { 0.1068499 ,  0.139267385 }, { -0.0379331468 ,  0.0842287409 }, { 0.0485793572 ,  0.0255735444 }, { 0.0510323296 ,  0.202342256 }, { -0.213023222 ,  0.233149972 }, { -0.324496618 ,  -0.0222904895 }, { -0.193623955 ,  -0.152642762 }, { -0.193663835 ,  -0.153906995 }, { -0.206119296 ,  -0.371095859 }, { 0.123252569 ,  -0.568962421 }, { 0.500490486 ,  -0.367170853 }, { 0.563848185 ,  -0.0496683097 }, { 0.572516226 ,  0.128224158 }, { 0.617477608 ,  0.460871452 }, { 0.292666844 ,  0.908603353 }, { -0.33627443 ,  0.952080559 }, { -0.742142873 ,  0.606027855 }, { -0.925792515 ,  0.268105348 }, { -1.10806833 ,  -0.17863685 }, { -0.956725872 ,  -0.869596446 }, { -0.278100579 ,  -1.29980044 }, { 0.417762195 ,  -1.16992131 }, { 0.83769741 ,  -0.846655085 }, { 1.20967759 ,  -0.436305457 }, { 1.37338481 ,  0.29902156 }, { 0.939305568 ,  1.03108465 }, { 0.213787618 ,  1.23266321 }, { -0.306653774 ,  1.08394778 }, { -0.745928674 ,  0.8754982 }, { -1.16108587 ,  0.373140313 }, { -1.11389239 ,  -0.376050205 }, { -0.601958731 ,  -0.801745647 }, { -0.154446867 ,  -0.822997876 }, { 0.183221469 ,  -0.807433849 }, { 0.646526464 ,  -0.62022231 }, { 0.8840412 ,  -0.0216585862 }, { 0.536312537 ,  0.528126663 }, { -0.000602702684 ,  0.55228682 }},
                {{ 0.277055668 ,  0.0657743754 }, { 0.12666064 ,  0.237747287 }, { -0.0746979627 ,  0.198201493 }, { -0.115197141 ,  0.0581254731 }, { -0.065041902 ,  0.0174172215 }, { -0.0814151166 ,  0.017642413 }, { -0.0891596945 ,  -0.0525665384 }, { -0.0097068348 ,  -0.089504618 }, { 0.0322790091 ,  -0.0370108408 }, { 0.00377130946 ,  -0.0291288835 }, { 0.0427538994 ,  -0.0691642898 }, { 0.123448761 ,  -0.0132778284 }, { 0.099576063 ,  0.0931851635 }, { 0.0264361743 ,  0.116452824 }, { 0.00593653187 ,  0.12719472 }, { -0.0648684317 ,  0.19048266 }, { -0.232468586 ,  0.160594132 }, { -0.326575764 ,  -0.0152408214 }, { -0.286990896 ,  -0.183729605 }, { -0.220047146 ,  -0.313755464 }, { -0.0811722897 ,  -0.480825823 }, { 0.229048952 ,  -0.558868428 }, { 0.559939978 ,  -0.38657911 }, { 0.720894328 ,  -0.0621979458 }, { 0.738248156 ,  0.286554981 }, { 0.607138433 ,  0.686097783 }, { 0.197680191 ,  1.03100616 }, { -0.404725945 ,  1.06275575 }, { -0.914521922 ,  0.749281992 }, { -1.21573473 ,  0.253234033 }, { -1.29376664 ,  -0.376336202 }, { -1.00316182 ,  -1.05475707 }, { -0.323200887 ,  -1.4740871 }, { 0.455628563 ,  -1.4386136 }, { 1.08128692 ,  -1.05694745 }, { 1.49190004 ,  -0.432873769 }, { 1.54803176 ,  0.382012048 }, { 1.11586437 ,  1.1163349 }, { 0.385188794 ,  1.45494415 }, { -0.332511856 ,  1.39252282 }, { -0.928059446 ,  1.04694042 }, { -1.30508024 ,  0.430594342 }, { -1.26550553 ,  -0.305250041 }, { -0.838277311 ,  -0.829988607 }, { -0.296546582 ,  -1.02044189 }, { 0.221411045 ,  -0.969434895 }, { 0.674586318 ,  -0.663733896 }, { 0.852268004 ,  -0.116773422 }, { 0.613451106 ,  0.370843787 }, { 0.185883617 ,  0.508542807 }},
                {{ 0.234683446 ,  0.0562956694 }, { 0.13218975 ,  0.183037019 }, { -0.0110163646 ,  0.186593231 }, { -0.0836293068 ,  0.111227411 }, { -0.0920730164 ,  0.0504966205 }, { -0.0938726446 ,  0.00864212312 }, { -0.0782335157 ,  -0.0420008134 }, { -0.028601199 ,  -0.0694452531 }, { 0.0118976338 ,  -0.0571045292 }, { 0.030093847 ,  -0.0464357739 }, { 0.0651687771 ,  -0.0373525977 }, { 0.101959505 ,  0.0148696456 }, { 0.0862561565 ,  0.0911481323 }, { 0.0291788539 ,  0.138803793 }, { -0.0374887723 ,  0.164485317 }, { -0.13680326 ,  0.171994746 }, { -0.26328144 ,  0.103874495 }, { -0.335547697 ,  -0.0561810143 }, { -0.306364194 ,  -0.24269543 }, { -0.19103985 ,  -0.411135672 }, { 0.0214891612 ,  -0.539508737 }, { 0.332093486 ,  -0.544720049 }, { 0.637753134 ,  -0.351528466 }, { 0.809931142 ,  0.000147118236 }, { 0.796111549 ,  0.421123391 }, { 0.565421784 ,  0.83746521 }, { 0.0969261838 ,  1.12142794 }, { -0.509673252 ,  1.11467011 }, { -1.05320873 ,  0.777088282 }, { -1.37788761 ,  0.195149737 }, { -1.39032424 ,  -0.516643422 }, { -1.01985187 ,  -1.1929949 }, { -0.314091992 ,  -1.59950083 }, { 0.512534959 ,  -1.58236663 }, { 1.22271401 ,  -1.16146586 }, { 1.65180685 ,  -0.442053139 }, { 1.66962969 ,  0.419634959 }, { 1.23428002 ,  1.17297178 }, { 0.492208106 ,  1.57899113 }, { -0.312964629 ,  1.56353505 }, { -0.988082983 ,  1.17822085 }, { -1.37891194 ,  0.520187642 }, { -1.36813813 ,  -0.223112181 }, { -0.990277664 ,  -0.805550377 }, { -0.42373709 ,  -1.08459133 }, { 0.159359498 ,  -1.05029668 }, { 0.619040313 ,  -0.733099273 }, { 0.802440008 ,  -0.23661121 }, { 0.654928705 ,  0.212690821 }, { 0.32541934 ,  0.41855081 }},
                {{ 0.207003405 ,  0.0467459629 }, { 0.134459111 ,  0.147946081 }, { 0.0260217098 ,  0.171729778 }, { -0.0535781756 ,  0.13168071 }, { -0.0883444239 ,  0.0742294569 }, { -0.0942577768 ,  0.0200490946 }, { -0.0760563191 ,  -0.0275449574 }, { -0.0372092128 ,  -0.0549505211 }, { 0.00341786795 ,  -0.0561855346 }, { 0.0365483131 ,  -0.0429162476 }, { 0.0673122674 ,  -0.0154437583 }, { 0.0838431604 ,  0.0363899885 }, { 0.063136445 ,  0.0997482196 }, { 0.0046104925 ,  0.147054103 }, { -0.0794015336 ,  0.164799454 }, { -0.183149628 ,  0.139497939 }, { -0.283146994 ,  0.0465877446 }, { -0.32827288 ,  -0.113534034 }, { -0.27984515 ,  -0.30000572 }, { -0.130121532 ,  -0.462917049 }, { 0.114466523 ,  -0.551531147 }, { 0.418377482 ,  -0.503189592 }, { 0.693701006 ,  -0.279102241 }, { 0.83666954 ,  0.0917729383 }, { 0.777935162 ,  0.528373576 }, { 0.488307181 ,  0.925427155 }, { -0.0098281274 ,  1.15470709 }, { -0.609151678 ,  1.10058574 }, { -1.13915215 ,  0.7305955 }, { -1.43965997 ,  0.113015573 }, { -1.40228488 ,  -0.616100381 }, { -0.989041758 ,  -1.27107627 }, { -0.272891359 ,  -1.65063028 }, { 0.559425585 ,  -1.62347194 }, { 1.28300568 ,  -1.18556089 }, { 1.70855903 ,  -0.441462888 }, { 1.71450108 ,  0.425028228 }, { 1.28883484 ,  1.17846711 }, { 0.558450056 ,  1.61101656 }, { -0.263650472 ,  1.62760477 }, { -0.964848984 ,  1.25400335 }, { -1.3755505 ,  0.60644652 }, { -1.40279155 ,  -0.12515283 }, { -1.07610833 ,  -0.728302869 }, { -0.534081444 ,  -1.05601649 }, { 0.0489760428 ,  -1.06337989 }, { 0.509652164 ,  -0.78962261 }, { 0.722009225 ,  -0.354956515 }, { 0.657713978 ,  0.0589922335 }, { 0.417913057 ,  0.30346855 }},
                {{ 0.188034408 ,  0.0385718361 }, { 0.134491288 ,  0.122919748 }, { 0.0490988974 ,  0.155271654 }, { -0.0266534161 ,  0.136141694 }, { -0.0715180412 ,  0.0896057132 }, { -0.0850062884 ,  0.0369327999 }, { -0.0719838438 ,  -0.00881949228 }, { -0.040312785 ,  -0.0369486938 }, { -0.0025128052 ,  -0.0426895402 }, { 0.0316450292 ,  -0.028564212 }, { 0.0561510322 ,  0.00376223674 }, { 0.0603977907 ,  0.0523399781 }, { 0.0324016989 ,  0.104815234 }, { -0.0292705404 ,  0.140992232 }, { -0.115377945 ,  0.142997524 }, { -0.209905419 ,  0.0955955472 }, { -0.284487115 ,  -0.0115034641 }, { -0.300273244 ,  -0.168854329 }, { -0.226732491 ,  -0.340966943 }, { -0.0557979018 ,  -0.477764832 }, { 0.19548865 ,  -0.525193772 }, { 0.47877738 ,  -0.434836745 }, { 0.713685118 ,  -0.187457172 }, { 0.811669506 ,  0.185122014 }, { 0.708987238 ,  0.603287987 }, { 0.386998568 ,  0.95771615 }, { -0.113204244 ,  1.13055346 }, { -0.683131078 ,  1.03142201 }, { -1.16962629 ,  0.640204062 }, { -1.42400013 ,  0.0235253485 }, { -1.34630444 ,  -0.680377382 }, { -0.916574708 ,  -1.2908137 }, { -0.215642416 ,  -1.63034993 }, { 0.585994057 ,  -1.58597395 }, { 1.28042861 ,  -1.15115093 }, { 1.68449559 ,  -0.426115652 }, { 1.6876091 ,  0.408459632 }, { 1.28674098 ,  1.13585696 }, { 0.594517017 ,  1.56902944 }, { -0.198820442 ,  1.61099066 }, { -0.888447804 ,  1.27537487 }, { -1.30882704 ,  0.672681525 }, { -1.37493103 ,  -0.020684989 }, { -1.10762304 ,  -0.614664175 }, { -0.620874447 ,  -0.967772439 }, { -0.0746225605 ,  -1.02394437 }, { 0.374517769 ,  -0.816000186 }, { 0.615856883 ,  -0.452289678 }, { 0.623870752 ,  -0.0800712325 }, { 0.465650961 ,  0.179866537 }}
        };

        double[][][] out = new double[result.length][result[0].length][2];
        for (int i=0; i<out_cplx.length; i++) {
            for (int j=0; j<out_cplx[0].length; j++) {
                out[i][j][0] = out_cplx[i][j].getReal();
                out[i][j][1] = out_cplx[i][j].getImaginary();
            }
        }

        for (int i=0; i<result.length; i++) {
            for (int j=0; j<result[0].length; j++) {
                Assertions.assertArrayEquals(result[i][j], out[i][j], 0.001);
            }
        }

    }

    @Test
    public void testPaulWavelet2() {
        ContinuousWavelet wR = new ContinuousWavelet(this.signal, this.widths);
        Complex[][] out_cplx = wR.transform(ContinuousWavelet.waveletType.PAUL, 7.0);

        double[][][] result = {
                {{ 0.273574521 ,  0.425450182 }, { -0.312124825 ,  0.346149754 }, { -0.196628749 ,  -0.475829231 }, { 0.387278421 ,  -0.16927523 }, { 0.050736151 ,  0.535218941 }, { -0.406937361 ,  -0.03780673 }, { 0.10164558 ,  -0.528825285 }, { 0.369784335 ,  0.229759778 }, { -0.237744839 ,  0.442643916 }, { -0.276568114 ,  -0.383986527 }, { 0.346496459 ,  -0.270805685 }, { 0.151169966 ,  0.530132862 }, { -0.401868239 ,  0.126593934 }, { -0.00527446056 ,  -0.529623775 }, { 0.391174581 ,  0.0886827956 }, { -0.16164701 ,  0.454622081 }, { -0.35479232 ,  -0.379373158 }, { 0.274050689 ,  -0.511228727 }, { 0.245115957 ,  0.324611903 }, { -0.349913364 ,  0.160480577 }, { -0.0703347586 ,  -0.507323983 }, { 0.443630293 ,  0.10372571 }, { -0.0192820742 ,  0.796509585 }, { -0.373665335 ,  0.170619326 }, { 0.182106828 ,  -0.138680202 }, { 0.26824426 ,  0.575426697 }, { -0.384598492 ,  0.369656397 }, { -0.274757762 ,  -0.714001883 }, { 0.324468534 ,  -0.655335787 }, { 0.0254463277 ,  -0.105234468 }, { -0.381338949 ,  -0.67673787 }, { 0.176769443 ,  -0.989484803 }, { 0.477053198 ,  0.0909104989 }, { -0.127384088 ,  0.687332697 }, { -0.194944697 ,  0.198862961 }, { 0.375257018 ,  0.50646628 }, { 0.118912509 ,  1.30137269 }, { -0.484421101 ,  0.695868157 }, { -0.112184527 ,  -0.293832691 }, { 0.292093965 ,  -0.0383905769 }, { -0.225448441 ,  0.0401377959 }, { -0.369565144 ,  -0.933300866 }, { 0.304643463 ,  -1.03870684 }, { 0.302730241 ,  -0.0489422286 }, { -0.290382691 ,  -0.007783152 }, { -0.0308067615 ,  -0.501401549 }, { 0.4525681 ,  0.195646767 }, { -0.0368705672 ,  0.874678417 }, { -0.401628576 ,  0.170144095 }, { 0.17658488 ,  -0.216847903 }},
                {{ -0.644926482 ,  0.284221425 }, { 0.618136497 ,  0.262133104 }, { 0.399499623 ,  -0.395623013 }, { -0.776229727 ,  -0.138896382 }, { -0.101962377 ,  0.445185481 }, { 0.815977215 ,  -0.0300556322 }, { -0.203664126 ,  -0.43761536 }, { -0.740959854 ,  0.19047079 }, { 0.477911781 ,  0.365095435 }, { 0.556124705 ,  -0.323100509 }, { -0.693483052 ,  -0.231872034 }, { -0.302558256 ,  0.430938069 }, { 0.804901402 ,  0.0974952434 }, { 0.00726863994 ,  -0.441528029 }, { -0.790110222 ,  0.0808269618 }, { 0.317183905 ,  0.396946758 }, { 0.705233887 ,  -0.282327621 }, { -0.552309332 ,  -0.384458129 }, { -0.487880136 ,  0.305426113 }, { 0.713414564 ,  0.151665162 }, { 0.159883527 ,  -0.434070648 }, { -0.867603945 ,  0.0320001358 }, { 0.0574218614 ,  0.56778074 }, { 0.75719568 ,  0.0256558375 }, { -0.374366943 ,  -0.225440203 }, { -0.565899155 ,  0.407297602 }, { 0.728809361 ,  0.308624134 }, { 0.504191237 ,  -0.501631907 }, { -0.688092797 ,  -0.371688084 }, { -0.0658069839 ,  0.132728367 }, { 0.78049464 ,  -0.345845603 }, { -0.309072605 ,  -0.668498493 }, { -0.891878125 ,  0.11718183 }, { 0.322449959 ,  0.481550036 }, { 0.441071938 ,  -0.0385621071 }, { -0.73401469 ,  0.149339739 }, { -0.257019678 ,  0.808598875 }, { 0.921365076 ,  0.373631342 }, { 0.157993932 ,  -0.332183801 }, { -0.650611304 ,  0.00994541291 }, { 0.406696108 ,  0.185423546 }, { 0.725406091 ,  -0.558627527 }, { -0.596179222 ,  -0.641452969 }, { -0.569737216 ,  0.13121873 }, { 0.629144834 ,  0.0840388374 }, { 0.104225311 ,  -0.413940758 }, { -0.879487042 ,  0.091709013 }, { 0.0859939789 ,  0.613461013 }, { 0.813746412 ,  0.0405311181 }, { -0.499076987 ,  -0.207166162 }},
                {{ -0.711316749 ,  -0.154613716 }, { 0.614863321 ,  -0.404936202 }, { 0.439807026 ,  0.522663831 }, { -0.866237806 ,  0.190395588 }, { -0.112638033 ,  -0.624973724 }, { 0.917429983 ,  0.0400794381 }, { -0.228299758 ,  0.610889483 }, { -0.831178071 ,  -0.268442432 }, { 0.539876755 ,  -0.509961692 }, { 0.628561899 ,  0.460130413 }, { -0.776161259 ,  0.338629473 }, { -0.338817249 ,  -0.585388352 }, { 0.901869088 ,  -0.117380813 }, { -1.17805515e-05 ,  0.630824717 }, { -0.901537961 ,  -0.118831434 }, { 0.340009451 ,  -0.588090782 }, { 0.778193339 ,  0.33511894 }, { -0.626366655 ,  0.456536324 }, { -0.538702655 ,  -0.512689257 }, { 0.830074987 ,  -0.269332902 }, { 0.224253976 ,  0.612478649 }, { -0.923687448 ,  0.0441024764 }, { 0.107360724 ,  -0.618929956 }, { 0.867727381 ,  0.20222074 }, { -0.443782219 ,  0.558613741 }, { -0.702386325 ,  -0.399222314 }, { 0.719779329 ,  -0.403856441 }, { 0.458297806 ,  0.545857927 }, { -0.85891958 ,  0.184465474 }, { -0.106659311 ,  -0.63743633 }, { 0.91510059 ,  0.0291061093 }, { -0.241221796 ,  0.604221276 }, { -0.852009147 ,  -0.269352106 }, { 0.517233326 ,  -0.50490924 }, { 0.611348875 ,  0.470004512 }, { -0.782204481 ,  0.351098793 }, { -0.331617304 ,  -0.573078808 }, { 0.919885418 ,  -0.107826422 }, { 0.0227321065 ,  0.635815603 }, { -0.881595752 ,  -0.119028265 }, { 0.35092672 ,  -0.592855255 }, { 0.777357901 ,  0.327360165 }, { -0.637362854 ,  0.447756152 }, { -0.554730667 ,  -0.520766062 }, { 0.81575219 ,  -0.275763139 }, { 0.21807928 ,  0.60782329 }, { -0.915932483 ,  0.0431106146 }, { 0.127754334 ,  -0.598199126 }, { 0.808453634 ,  0.267430803 }, { -0.602387582 ,  0.257661033 }},
                {{ -0.599808939 ,  -0.460020337 }, { 0.785778984 ,  -0.58259518 }, { 0.493585687 ,  0.969858256 }, { -1.11258308 ,  0.324133336 }, { -0.138736315 ,  -1.13908111 }, { 1.16955575 ,  0.0710117824 }, { -0.288251839 ,  1.1053329 }, { -1.05520857 ,  -0.4845895 }, { 0.68680997 ,  -0.92133315 }, { 0.799016097 ,  0.83295106 }, { -0.986951808 ,  0.612598359 }, { -0.432051517 ,  -1.05961111 }, { 1.14395052 ,  -0.214460329 }, { -0.00239112335 ,  1.13772742 }, { -1.14737495 ,  -0.218120659 }, { 0.432183234 ,  -1.06527749 }, { 0.991420805 ,  0.607683203 }, { -0.79133266 ,  0.831649124 }, { -0.678757979 ,  -0.917260063 }, { 1.06004613 ,  -0.475487117 }, { 0.287285242 ,  1.11680057 }, { -1.17593925 ,  0.0814428093 }, { 0.129926602 ,  -1.12877461 }, { 1.09341523 ,  0.34482595 }, { -0.573180814 ,  0.981917813 }, { -0.898358065 ,  -0.74965372 }, { 0.914809618 ,  -0.747061466 }, { 0.588530719 ,  0.990189981 }, { -1.08156675 ,  0.359524623 }, { -0.125394422 ,  -1.10834685 }, { 1.16940152 ,  0.104059192 }, { -0.306185789 ,  1.13532604 }, { -1.08822245 ,  -0.468075854 }, { 0.648847732 ,  -0.925594192 }, { 0.769457703 ,  0.808053037 }, { -0.997035679 ,  0.57519381 }, { -0.418490111 ,  -1.09625742 }, { 1.17652163 ,  -0.237010705 }, { 0.0373607102 ,  1.13747246 }, { -1.1149648 ,  -0.196252884 }, { 0.445613025 ,  -1.02977978 }, { 0.981560315 ,  0.643287478 }, { -0.819838433 ,  0.853992186 }, { -0.713953535 ,  -0.916280225 }, { 1.03342919 ,  -0.495150243 }, { 0.282453286 ,  1.08856428 }, { -1.15980818 ,  0.0714982028 }, { 0.112536021 ,  -1.09780985 }, { 0.954217323 ,  0.268537449 }, { -0.363319742 ,  0.583672437 }},
                {{ -0.358586422 ,  -0.622928625 }, { 0.837317923 ,  -0.422249538 }, { 0.397823146 ,  0.980339659 }, { -1.05509622 ,  0.294263948 }, { -0.134689003 ,  -1.07598892 }, { 1.0658148 ,  0.0569116505 }, { -0.256894741 ,  1.02389479 }, { -0.95490452 ,  -0.448390881 }, { 0.624692111 ,  -0.852288099 }, { 0.724390519 ,  0.776113531 }, { -0.899326483 ,  0.570763019 }, { -0.397226759 ,  -0.983370391 }, { 1.0333945 ,  -0.202418923 }, { -0.00531449678 ,  1.0488779 }, { -1.04030814 ,  -0.21167773 }, { 0.399908236 ,  -0.997130174 }, { 0.913315779 ,  0.560264942 }, { -0.702771908 ,  0.776595312 }, { -0.60368932 ,  -0.836562452 }, { 0.965455075 ,  -0.41898972 }, { 0.249738127 ,  1.05989751 }, { -1.09302619 ,  0.0911411739 }, { 0.0840100848 ,  -1.04848094 }, { 0.961107373 ,  0.298338848 }, { -0.536832019 ,  0.871874127 }, { -0.807077331 ,  -0.741947728 }, { 0.866136322 ,  -0.730415652 }, { 0.588801704 ,  0.906502509 }, { -0.925472054 ,  0.354603182 }, { -0.0756042895 ,  -0.976967351 }, { 1.06565352 ,  0.164211098 }, { -0.313337609 ,  1.11494576 }, { -1.05355897 ,  -0.40150955 }, { 0.514180612 ,  -0.867847673 }, { 0.639741237 ,  0.700414323 }, { -0.927453045 ,  0.459405362 }, { -0.357721015 ,  -1.09179742 }, { 1.12700936 ,  -0.269508456 }, { 0.108849742 ,  1.04666991 }, { -0.946622823 ,  -0.149430046 }, { 0.440207287 ,  -0.89466141 }, { 0.887932912 ,  0.664300612 }, { -0.780919423 ,  0.844130475 }, { -0.701490118 ,  -0.827824137 }, { 0.887758312 ,  -0.465074684 }, { 0.21727744 ,  0.991026846 }, { -1.09934634 ,  0.0395963562 }, { 0.0397336865 ,  -1.1151452 }, { 0.97494947 ,  0.0492973949 }, { -0.0222889489 ,  0.686078377 }},
                {{ -0.12492065 ,  -0.611702324 }, { 0.728928904 ,  -0.230907463 }, { 0.272477895 ,  0.773740329 }, { -0.76686109 ,  0.230990253 }, { -0.121256747 ,  -0.741007121 }, { 0.715042298 ,  0.0224913364 }, { -0.168680591 ,  0.685507034 }, { -0.639869981 ,  -0.302588747 }, { 0.42337782 ,  -0.571688221 }, { 0.485959609 ,  0.530299943 }, { -0.61513736 ,  0.388987912 }, { -0.278783332 ,  -0.66746621 }, { 0.688338233 ,  -0.146713885 }, { -0.00710559783 ,  0.692625733 }, { -0.695313286 ,  -0.162807437 }, { 0.290180956 ,  -0.689888272 }, { 0.64720485 ,  0.375870092 }, { -0.442047771 ,  0.541407469 }, { -0.38545715 ,  -0.529108571 }, { 0.651056201 ,  -0.233372992 }, { 0.136790069 ,  0.764972958 }, { -0.798587926 ,  0.0886874702 }, { -0.0176540878 ,  -0.719962871 }, { 0.585113167 ,  0.146427389 }, { -0.3893794 ,  0.499302032 }, { -0.5162319 ,  -0.601724078 }, { 0.670522606 ,  -0.569080644 }, { 0.519803492 ,  0.594541193 }, { -0.503752548 ,  0.294003946 }, { 0.0263311599 ,  -0.542328917 }, { 0.72072067 ,  0.260271152 }, { -0.295218515 ,  0.885825514 }, { -0.858426953 ,  -0.203554421 }, { 0.182482808 ,  -0.609942049 }, { 0.303761865 ,  0.363060693 }, { -0.674595531 ,  0.146750698 }, { -0.193257554 ,  -0.902296599 }, { 0.889459247 ,  -0.292982296 }, { 0.238507608 ,  0.684536098 }, { -0.491783215 ,  -0.0333596391 }, { 0.38201387 ,  -0.473340568 }, { 0.600635035 ,  0.598944575 }, { -0.601569799 ,  0.691738124 }, { -0.592013366 ,  -0.498152828 }, { 0.47354734 ,  -0.317380543 }, { 0.034511026 ,  0.613347684 }, { -0.83265063 ,  -0.0898446025 }, { 0.0208144136 ,  -0.957677701 }, { 0.874351794 ,  -0.140574808 }, { 0.260783808 ,  0.610750571 }},
                {{ 0.0156955358 ,  -0.513243506 }, { 0.564474995 ,  -0.123347707 }, { 0.204590873 ,  0.529071809 }, { -0.455213355 ,  0.193900826 }, { -0.109616606 ,  -0.395971346 }, { 0.371720291 ,  -0.000351589582 }, { -0.0943012149 ,  0.365113587 }, { -0.347333772 ,  -0.166529507 }, { 0.230775913 ,  -0.307463055 }, { 0.257952526 ,  0.296278862 }, { -0.351088339 ,  0.213847485 }, { -0.16976335 ,  -0.374266472 }, { 0.363743391 ,  -0.101678947 }, { -0.00371159318 ,  0.347774251 }, { -0.36030632 ,  -0.121676186 }, { 0.20012733 ,  -0.398511353 }, { 0.40959761 ,  0.210037682 }, { -0.188382876 ,  0.335234668 }, { -0.181504645 ,  -0.217369848 }, { 0.340992251 ,  -0.0382052273 }, { 0.00541843122 ,  0.497058632 }, { -0.551822261 ,  0.0828447993 }, { -0.140873812 ,  -0.429867526 }, { 0.216462431 ,  -0.0323324132 }, { -0.244377013 ,  0.105780167 }, { -0.213582539 ,  -0.504117582 }, { 0.532312183 ,  -0.433333064 }, { 0.506618257 ,  0.308824413 }, { -0.0641105631 ,  0.273089041 }, { 0.141164229 ,  -0.0755888201 }, { 0.382918047 ,  0.411078396 }, { -0.3215347 ,  0.71588304 }, { -0.737839894 ,  0.00267777252 }, { -0.195681127 ,  -0.381884654 }, { -0.061917243 ,  -0.00362771512 }, { -0.454492945 ,  -0.215274898 }, { -0.0199345851 ,  -0.789265235 }, { 0.715168199 ,  -0.362687453 }, { 0.426828961 ,  0.326206328 }, { 0.00064206968 ,  0.0959524676 }, { 0.371287293 ,  -0.0266427129 }, { 0.342894302 ,  0.599667955 }, { -0.453742044 ,  0.607233023 }, { -0.539116846 ,  -0.146398496 }, { 0.0165532164 ,  -0.173482777 }, { -0.193582988 ,  0.21229828 }, { -0.578070158 ,  -0.285085455 }, { 0.0704615541 ,  -0.819756639 }, { 0.762316426 ,  -0.248825401 }, { 0.438314806 ,  0.465575598 }},
                {{ 0.0722881957 ,  -0.408679736 }, { 0.420309969 ,  -0.0898964255 }, { 0.187398948 ,  0.331731938 }, { -0.216589948 ,  0.177924643 }, { -0.0917068774 ,  -0.147222712 }, { 0.142313913 ,  0.00306925762 }, { -0.0588066676 ,  0.165457783 }, { -0.169137603 ,  -0.0791674332 }, { 0.0996860347 ,  -0.140030475 }, { 0.104843243 ,  0.1419851 }, { -0.187397738 ,  0.094311395 }, { -0.10251957 ,  -0.196716895 }, { 0.158392834 ,  -0.0856487951 }, { 0.0089471079 ,  0.114586387 }, { -0.127533345 ,  -0.10146217 }, { 0.164239796 ,  -0.207404488 }, { 0.276988874 ,  0.120606817 }, { -0.0155205183 ,  0.231642456 }, { -0.0572366207 ,  0.0172701321 }, { 0.115549213 ,  0.117480157 }, { -0.122297431 ,  0.33984071 }, { -0.444123636 ,  0.0688066796 }, { -0.263070794 ,  -0.282126798 }, { -0.0399325772 ,  -0.207964867 }, { -0.13643036 ,  -0.215613714 }, { 0.0324751273 ,  -0.498118804 }, { 0.522935868 ,  -0.370889585 }, { 0.585007174 ,  0.145426135 }, { 0.287142965 ,  0.324584503 }, { 0.243377221 ,  0.319943496 }, { 0.141314857 ,  0.609754339 }, { -0.414068923 ,  0.68527948 }, { -0.768621574 ,  0.165647347 }, { -0.549740895 ,  -0.26422164 }, { -0.379580987 ,  -0.321163089 }, { -0.343728313 ,  -0.561352309 }, { 0.122378509 ,  -0.830355872 }, { 0.687020823 ,  -0.489297064 }, { 0.659837133 ,  0.068249147 }, { 0.425471003 ,  0.211035377 }, { 0.440043381 ,  0.34114076 }, { 0.200311982 ,  0.705810567 }, { -0.393589419 ,  0.652548651 }, { -0.586094195 ,  0.142981625 }, { -0.376439742 ,  -0.0755388708 }, { -0.415849674 ,  -0.0998766448 }, { -0.42730715 ,  -0.487596982 }, { 0.13373526 ,  -0.76516392 }, { 0.686283097 ,  -0.319418145 }, { 0.540028439 ,  0.314605053 }},
                {{ 0.0829908101 ,  -0.329767493 }, { 0.318204575 ,  -0.0925889866 }, { 0.191103964 ,  0.19616866 }, { -0.0599112333 ,  0.165921144 }, { -0.0631352193 ,  0.00239820874 }, { 0.0223044301 ,  0.0279520045 }, { -0.053197197 ,  0.0758225528 }, { -0.0918059813 ,  -0.0306600339 }, { 0.0194776575 ,  -0.056819857 }, { 0.0159149565 ,  0.0546987708 }, { -0.109368116 ,  0.0205633454 }, { -0.0680319393 ,  -0.120803529 }, { 0.0609396233 ,  -0.0933295646 }, { 0.0328996794 ,  -0.0171768168 }, { 0.0168674141 ,  -0.0930972218 }, { 0.172010243 ,  -0.0969646458 }, { 0.228393868 ,  0.101892098 }, { 0.077624725 ,  0.217075326 }, { -0.0111378324 ,  0.179148692 }, { -0.0413908509 ,  0.228290557 }, { -0.245414253 ,  0.266210396 }, { -0.448711579 ,  0.0368911539 }, { -0.370494308 ,  -0.262961655 }, { -0.183659016 ,  -0.377240383 }, { -0.049450611 ,  -0.462505888 }, { 0.232434375 ,  -0.555164922 }, { 0.618755775 ,  -0.3561971 }, { 0.728171724 ,  0.0980773215 }, { 0.543668506 ,  0.43871918 }, { 0.319977064 ,  0.643053153 }, { -0.0226489244 ,  0.833031541 }, { -0.559147441 ,  0.758570878 }, { -0.916849311 ,  0.280017429 }, { -0.865067838 ,  -0.243045682 }, { -0.640959392 ,  -0.585792556 }, { -0.32235036 ,  -0.876697694 }, { 0.232223946 ,  -0.988465133 }, { 0.771282264 ,  -0.654849716 }, { 0.913480414 ,  -0.102389092 }, { 0.776388589 ,  0.303235978 }, { 0.570957873 ,  0.6228269 }, { 0.161365347 ,  0.884543673 }, { -0.395982778 ,  0.795193404 }, { -0.697489224 ,  0.37086062 }, { -0.686137719 ,  -0.00941874065 }, { -0.613997277 ,  -0.303588956 }, { -0.382779974 ,  -0.655429367 }, { 0.163363864 ,  -0.780575573 }, { 0.636312168 ,  -0.392909131 }, { 0.599471833 ,  0.170894094 }},
                {{ 0.0765286452 ,  -0.27744491 }, { 0.251894226 ,  -0.105149743 }, { 0.196885885 ,  0.108967766 }, { 0.0357064638 ,  0.150306179 }, { -0.0280273173 ,  0.0823063672 }, { -0.0261207038 ,  0.0616140559 }, { -0.0607245491 ,  0.0534366252 }, { -0.0738372106 ,  -0.00240120552 }, { -0.0320780749 ,  -0.0231476784 }, { -0.0353535201 ,  0.00507746866 }, { -0.0797985602 ,  -0.028365779 }, { -0.0486245354 ,  -0.10549505 }, { 0.03215507 ,  -0.11251406 }, { 0.0669526243 ,  -0.083205541 }, { 0.108931304 ,  -0.0837428961 }, { 0.200687068 ,  -0.0263004942 }, { 0.220023704 ,  0.129851474 }, { 0.111732535 ,  0.254408774 }, { -0.0222030224 ,  0.290550348 }, { -0.163939274 ,  0.299349591 }, { -0.364037347 ,  0.226286212 }, { -0.509278719 ,  -0.0189543624 }, { -0.452408079 ,  -0.326081828 }, { -0.242391831 ,  -0.539095636 }, { 0.0392713218 ,  -0.652017086 }, { 0.410028885 ,  -0.630159669 }, { 0.770289668 ,  -0.35060618 }, { 0.893695434 ,  0.131788184 }, { 0.724191599 ,  0.591384491 }, { 0.364335669 ,  0.913472635 }, { -0.148866906 ,  1.05333843 }, { -0.731734419 ,  0.874817835 }, { -1.12103452 ,  0.353328102 }, { -1.1397794 ,  -0.280501884 }, { -0.854354164 ,  -0.809687103 }, { -0.348126736 ,  -1.15740249 }, { 0.317089775 ,  -1.19911049 }, { 0.906874872 ,  -0.833587259 }, { 1.16071225 ,  -0.222660627 }, { 1.068616 ,  0.369516946 }, { 0.732969749 ,  0.833923688 }, { 0.190179901 ,  1.0853133 }, { -0.417111755 ,  0.980032427 }, { -0.820424359 ,  0.559186724 }, { -0.919747035 ,  0.0527118064 }, { -0.785585837 ,  -0.410623207 }, { -0.416849059 ,  -0.769616348 }, { 0.141232811 ,  -0.830042462 }, { 0.586444926 ,  -0.481161237 }, { 0.63009063 ,  0.0296133781 }}
        };

        double[][][] out = new double[result.length][result[0].length][2];
        for (int i=0; i<out_cplx.length; i++) {
            for (int j=0; j<out_cplx[0].length; j++) {
                out[i][j][0] = out_cplx[i][j].getReal();
                out[i][j][1] = out_cplx[i][j].getImaginary();
            }
        }

        for (int i=0; i<result.length; i++) {
            for (int j=0; j<result[0].length; j++) {
                Assertions.assertArrayEquals(result[i][j], out[i][j], 0.001);
            }
        }

    }

}
